!function(r){"use strict";r.WS_Form.prototype.form_color=function(){return!!r('[data-type="color"] input',this.form_canvas_obj).length&&("off"!=r.WS_Form.settings_plugin.ui_color&&void(("on"==r.WS_Form.settings_plugin.ui_color||"native"==r.WS_Form.settings_plugin.ui_color&&!this.native_color)&&this.form_color_process()))},r.WS_Form.prototype.form_color_process=function(){var o=this;if("undefined"!=typeof Coloris){var a=r('[data-type="color"] input',this.form_canvas_obj),t={el:a.toArray()};Coloris(t),a.each(function(){if("on"==r.WS_Form.settings_plugin.ui_color||"native"==r.WS_Form.settings_plugin.ui_color&&!o.native_color){var a=o.get_field(r(this)),t=o.get_object_meta_value(a,"coloris_theme","default");["default","large","polaroid","pill"].includes(t)||(t="default");var _=o.get_object_meta_value(a,"coloris_theme_mode","light");["light","dark","auto"].includes(_)||(_="light");var s=o.get_object_meta_value(a,"coloris_format","hex");["hex","rgb","hsl","auto","mixed"].includes(s)||(s="light");var e="on"==o.get_object_meta_value(a,"coloris_format_toggle",""),l={alpha:"on"==o.get_object_meta_value(a,"coloris_alpha","on"),format:s,formatToggle:e,swatches:!1,theme:t,themeMode:_,rtl:!!ws_form_settings.rtl,wrap:!0};Coloris.setInstance("#"+r(this).attr("id"),l)}})}},r.WS_Form.prototype.color_var_parse=function(r,o){var a=o?document.querySelector('[data-wsf-style-id="'+o+'"]'):document.body;return getComputedStyle(a).getPropertyValue(r).trim()},r.WS_Form.prototype.color_parse=function(r,o){var a=r.match(/var\((--[\w-]+)\)/);return a&&(r=this.color_var_parse(a[1],o)),r.match(this.color_mix_regex())&&(r=this.color_mix_to_hex_color(r)),r},r.WS_Form.prototype.color_to_hsla_array=function(r){r=this.color_parse(r);return this.color_is_hex(r)||this.color_is_hex_alpha(r)?this.hex_color_to_hsla_array(r):this.color_is_rgb(r)||this.color_is_rgba(r)?this.rgba_color_to_hsla_array(r):this.color_is_hsl(r)||this.color_is_hsla(r)?this.hsla_color_to_hsla_array(r):{h:0,s:0,l:0,a:1}},r.WS_Form.prototype.color_to_rgba_array=function(r){for(;/var\((.*)\)/.exec(r);){r=getComputedStyle(document.body).getPropertyValue(r)}if(this.color_is_hex(r)||this.color_is_hex_alpha(r))return this.hex_color_to_rgba_array(r);if(this.color_is_rgb(r)||this.color_is_rgba(r)){var o=this.rgba_color_to_hsla_array(r);return this.hsla_array_to_rgba_array(o)}return this.color_is_hsl(r)||this.color_is_hsla(r)?this.hsla_color_to_rgba_array(r):{r:0,g:0,b:0,a:1}},r.WS_Form.prototype.color_to_color_alt=function(r){if("transparent"==r)return r;var o=/var\((.*)\)/.exec(r);if(o){var a=o[1].split(",");for(var t in a)if(a.hasOwnProperty(t)){var _=a[t].trim();-1!==_.indexOf("--wsf-")&&(-1===_.indexOf("-alt")?a[t]=_+"-alt":a[t]=_.replace("-alt",""))}return"var("+a.join(", ")+")"}if(this.color_is_hex(r)||this.color_is_hex_alpha(r)){var s=this.hex_color_to_hsla_array(r);return s=this.hsla_array_to_alt_hsla_array(s),this.hsla_array_to_hex_color(s)}if(this.color_is_rgb(r)||this.color_is_rgba(r)){s=this.rgba_color_to_hsla_array(r);return s=this.hsla_array_to_alt_hsla_array(s),this.hsla_array_to_rgba_color(s)}if(this.color_is_hsl(r)||this.color_is_hsla(r)){s=this.hsla_color_to_hsla_array(r);return s=this.hsla_array_to_alt_hsla_array(s),this.hsla_array_to_hsla_color(s)}return r},r.WS_Form.prototype.color_contrast_ratio=function(r,o){return this.rgba_array_contrast_ratio(this.color_to_rgba_array(r),this.color_to_rgba_array(o))},r.WS_Form.prototype.color_is_hex=function(r){return/^#([a-f0-9]{3}|[a-f0-9]{6})$/i.test(r)},r.WS_Form.prototype.color_is_hex_alpha=function(r){return/^#([a-f0-9]{8})$/i.test(r)},r.WS_Form.prototype.color_is_rgb=function(r){return/^rgb\(\s*([\d]{1,3})\s*,\s*([\d]{1,3})\s*,\s*([\d]{1,3})\s*\)$/i.test(r)},r.WS_Form.prototype.color_is_rgba=function(r){return/^rgba\(\s*([\d]{1,3})\s*,\s*([\d]{1,3})\s*,\s*([\d]{1,3})\s*,\s*(0|1|0?\.\d+)\s*\)$/i.test(r)},r.WS_Form.prototype.color_is_hsl=function(r){return/^hsl\(\s*([\d]{1,3})\s*,\s*([\d]{1,3})%\s*,\s*([\d]{1,3})%\s*\)$/i.test(r)},r.WS_Form.prototype.color_is_hsla=function(r){return/^hsla\(\s*([\d]{1,3})\s*,\s*([\d]{1,3})%\s*,\s*([\d]{1,3})%\s*,\s*(0|1|0?\.\d+)\s*\)$/i.test(r)},r.WS_Form.prototype.hsla_color_to_rgba_array=function(r){return this.hsla_array_to_rgba_array(this.hsla_color_to_hsla_array(r))},r.WS_Form.prototype.hex_color_to_hsla_array=function(r){var o,a,t=this.hex_color_to_rgba_array(r),_=t.r/255,s=t.g/255,e=t.b/255,l=t.a,i=Math.min(_,s,e),h=Math.max(_,s,e),n=(h+i)/2;if(h===i)o=a=0;else{var c=h-i;switch(a=n>.5?c/(2-h-i):c/(h+i),h){case _:o=(s-e)/c+(s<e?6:0);break;case s:o=(e-_)/c+2;break;case e:o=(_-s)/c+4}o/=6}return{h:Math.round(360*o),s:Math.round(100*a),l:Math.round(100*n),a:l}},r.WS_Form.prototype.hex_color_to_rgba_array=function(r,o=!1){r||(r="#000000"),!1===o&&(o=1);var a=(8===(r=this.hex_color_strip_hash(r)).length?[r.substr(0,2),r.substr(2,2),r.substr(4,2),r.substr(6,2)]:6===r.length?[r.substr(0,2),r.substr(2,2),r.substr(4,2)]:3===r.length?[r[0]+r[0],r[1]+r[1],r[2]+r[2]]:["00","00","00"]).map(function(r){return parseInt(r,16)});return void 0!==a[3]&&(o=a[3]/255),{r:a[0],g:a[1],b:a[2],a:o}},r.WS_Form.prototype.hex_color_to_rgba_color=function(r,o=!1){return this.rgba_array_to_rgba_color(this.hex_color_to_rgba_array(r,o))},r.WS_Form.prototype.hex_color_strip_hash=function(r){return r.replace(/^#/,"").trim()},r.WS_Form.prototype.hsla_array_to_hsla_color=function(r){var o=void 0!==r.h?r.h:0,a=void 0!==r.s?r.s+"%":"0%",t=void 0!==r.l?r.l+"%":"0%",_=void 0!==r.a?r.a:1;return 1===_?`hsl(${o}, ${a}, ${t})`:`hsla(${o}, ${a}, ${t}, ${_})`},r.WS_Form.prototype.hsla_array_to_rgba_color=function(r){return this.rgba_array_to_rgba_color(this.hsla_array_to_rgba_array(r))},r.WS_Form.prototype.hsla_array_to_rgba_array=function(r){var o,a,t,_=r.h%360/360,s=r.s/100,e=r.l/100,l=void 0!==r.a?r.a:1;if(0===s)o=a=t=255*e;else{var i=e<.5?e*(1+s):e+s-e*s,h=2*e-i,n=function(r,o,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+6*(o-r)*a:a<.5?o:a<2/3?r+(o-r)*(2/3-a)*6:r};o=255*n(h,i,_+1/3),a=255*n(h,i,_),t=255*n(h,i,_-1/3)}return{r:Math.floor(o),g:Math.floor(a),b:Math.floor(t),a:l}},r.WS_Form.prototype.hsla_array_to_hsla_color=function(r){var o=void 0!==r.h?r.h:0,a=void 0!==r.s?r.s:0,t=void 0!==r.l?r.l:0,_=void 0!==r.a?r.a:1;return a+="%",t+="%",1===_?`hsl(${o}, ${a}, ${t})`:`hsla(${o}, ${a}, ${t}, ${_})`},r.WS_Form.prototype.hsla_array_to_hex_color=function(r){if(0===r.a)return"#000000";var o=this.hsla_array_to_rgba_array(r);return this.rgba_array_to_hex_color(o)},r.WS_Form.prototype.hsla_array_to_alt_hsla_array=function(r){var o=r.l;return o<0&&(o=0),o>100&&(o=100),r.l=100-o,r},r.WS_Form.prototype.hsla_color_to_hsla_array=function(r){var o=/^hsla?\(\s*([\d]{1,3})\s*,\s*([\d]{1,3})%\s*,\s*([\d]{1,3})%\s*(?:,\s*(0|1|0?\.\d+))?\s*\)$/i.exec(r);if(o){var a=o[4]?parseFloat(o[4]):1;return{h:parseInt(o[1],10),s:parseInt(o[2],10),l:parseInt(o[3],10),a:Math.round(100*a)/100}}return{h:0,s:0,l:0,a:1}},r.WS_Form.prototype.rgba_array_blend_colors=function(r,o){var a=r.a/255;return{r:Math.round((1-a)*o.r+a*r.r),g:Math.round((1-a)*o.g+a*r.g),b:Math.round((1-a)*o.b+a*r.b)}},r.WS_Form.prototype.rgba_array_get_luminance=function(r){var o=[r.r,r.g,r.b].map(function(r){var o=r/255;return o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4)});return.2126*o[0]+.7152*o[1]+.0722*o[2]},r.WS_Form.prototype.rgba_array_contrast_ratio=function(r,o){var a=this.rgba_array_blend_colors(r,o),t=this.rgba_array_get_luminance(a),_=this.rgba_array_get_luminance(o);return(Math.max(t,_)+.05)/(Math.min(t,_)+.05)},r.WS_Form.prototype.rgba_array_to_oklab_array=function(r){var o=function(r){return(r/=255)<=.04045?r/12.92:((r+.055)/1.055)**2.4},a=o(r.r),t=o(r.g),_=o(r.b),s=.4122214708*a+.5363325363*t+.0514459929*_,e=.2119034982*a+.6806995451*t+.1073969566*_,l=.0883024619*a+.2817188376*t+.6299787005*_,i=Math.cbrt(s),h=Math.cbrt(e),n=Math.cbrt(l);return{l:.2104542553*i+.793617785*h-.0040720468*n,a:1.9779984951*i-2.428592205*h+.4505937099*n,b:.0259040371*i+.7827717662*h-.808675766*n,alpha:r.a}},r.WS_Form.prototype.rgba_array_to_rgba_color=function(r){return 1==r.a?`rgb(${r.r}, ${r.g}, ${r.b})`:`rgba(${r.r}, ${r.g}, ${r.b}, ${r.a})`},r.WS_Form.prototype.rgba_array_to_hex_color=function(r){var o=r.r,a=r.g,t=r.b,_=r.a,s=o.toString(16).padStart(2,"0"),e=a.toString(16).padStart(2,"0"),l=t.toString(16).padStart(2,"0");return 1==_?`#${s}${e}${l}`:`#${s}${e}${l}${Math.round(255*_).toString(16).padStart(2,"0")}`},r.WS_Form.prototype.rgba_color_to_hsla_array=function(r){var o=this.rgba_color_to_rgba_array(r);return this.rgba_array_to_hsla_array(o)},r.WS_Form.prototype.rgba_color_to_rgba_array=function(r){var o=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*([\d.]*)\)/);return o?{r:parseInt(o[1],10),g:parseInt(o[2],10),b:parseInt(o[3],10),a:""!==o[4]?parseFloat(o[4]):1}:{r:0,g:0,b:0,a:1}},r.WS_Form.prototype.rgba_array_to_hsla_array=function(r){var o=parseInt(r.r,10),a=parseInt(r.g,10),t=parseInt(r.b,10),_=""!==r.a?parseFloat(r.a):1;o/=255,a/=255,t/=255;var s,e,l=Math.max(o,a,t),i=Math.min(o,a,t),h=(l+i)/2;if(l===i)s=e=0;else{var n=l-i;switch(e=h>.5?n/(2-l-i):n/(l+i),l){case o:s=(a-t)/n+(a<t?6:0);break;case a:s=(t-o)/n+2;break;case t:s=(o-a)/n+4}s/=6}return{h:Math.round(360*s),s:Math.round(100*e),l:Math.round(100*h),a:_}},r.WS_Form.prototype.oklab_array_to_rgba_array=function(r){var o=(r.l+.3963377774*r.a+.2158037573*r.b)**3,a=(r.l-.1055613458*r.a-.0638541728*r.b)**3,t=(r.l-.0894841775*r.a-1.291485548*r.b)**3,_=4.0767416621*o-3.3077115913*a+.2309699292*t,s=-1.2684380046*o+2.6097574011*a-.3413193965*t,e=-.0041960863*o-.7034186147*a+1.707614701*t,l=function(r){return r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055};return{r:Math.max(0,Math.min(255,Math.round(255*l(_)))),g:Math.max(0,Math.min(255,Math.round(255*l(s)))),b:Math.max(0,Math.min(255,Math.round(255*l(e)))),a:r.alpha}},r.WS_Form.prototype.color_mix_regex=function(){return/color-mix\(in oklab, (#\w{3,6}|rgba?\(\s*\d+,\s*\d+,\s*\d+(?:,\s*[\d.]+)?\)), (#\w{3,6}|rgba?\(\s*\d+,\s*\d+,\s*\d+(?:,\s*[\d.]+)?\)) (\d+)%\)/},r.WS_Form.prototype.color_mix_to_hex_color=function(r){return this.rgba_array_to_hex_color(this.color_mix_to_rgba_array(r))},r.WS_Form.prototype.color_mix_to_rgba_array=function(r){var o=r.match(this.color_mix_regex());if(!o)return{r:0,g:0,b:0,a:1};var a=o[1],t=o[2],_=parseInt(o[3])/100,s=this.hex_color_to_rgba_array(a),e=this.hex_color_to_rgba_array(t),l=this.rgba_array_to_oklab_array(s),i=this.rgba_array_to_oklab_array(e),h=l.l*(1-_)+i.l*_,n=l.a*(1-_)+i.a*_,c=l.b*(1-_)+i.b*_,u=s.a*(1-_)+e.a*_;return this.oklab_array_to_rgba_array({l:h,a:n,b:c,alpha:u})},r.WS_Form.prototype.wcag_level_aaa_contrast_check=function(r,o,a){a||(a=!1);var t=this.color_contrast_ratio(r,o);return a?t>=7:t>=4.5},r.WS_Form.prototype.wcag_level_aa_contrast_check=function(r,o,a){a||(a=!1);var t=this.color_contrast_ratio(r,o);return a?t>=4.5:t>=3},r.WS_Form.prototype.color_alt_coloris_swatches=function(r){for(var o=this.color_to_hsla_array(this.color_to_color_alt(r)),a=[],t=10;t>=1;t--)a.push({h:o.h,s:o.s,l:Math.min(100,o.l+10*t),a:o.a});a.push(o);for(t=1;t<=10;t++)a.push({h:o.h,s:o.s,l:Math.max(0,o.l-10*t),a:o.a});var _=[];for(var s in a)if(a.hasOwnProperty(s)){var e=a[s];this.color_is_rgb(r)||this.color_is_rgba(r)?_.push(this.hsla_array_to_rgba_color(e)):this.color_is_hsl(r)||this.color_is_hsla(r)?_.push(this.hsla_array_to_hsla_color(e)):_.push(this.hsla_array_to_hex_color(e))}return _=_.filter((r,o,a)=>a.indexOf(r)===o)}}(jQuery);