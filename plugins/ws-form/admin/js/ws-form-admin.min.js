!function(t){"use strict";t.WS_Form.prototype.set_is_admin=function(){return!0},t.WS_Form.prototype.init=function(){this.set_globals(),this.form_build(),this.sidebar_reset(),this.window_resize_init(),this.root_css_variables_set(),this.keydown_events_init(),this.intro(),this.published_checksum=this.form.published_checksum,this.publish_render(this.form.checksum),this.history_push({form:this.form,history:{date:ws_form_settings.date,time:ws_form_settings.time}}),this.tooltips(),this.variable_helper_modal(),this.set_preview_url_styler()},t.WS_Form.prototype.init_partial=function(){this.root_css_variables_set()},t.WS_Form.prototype.root_css_variables_set=function(){if(t("#adminmenuwrap")){var e=t("#adminmenuwrap").width();t(":root").css("--wp-sidebar-width",e+"px")}},t.WS_Form.prototype.keydown_events_init=function(){t(document).on("keydown",function(e){var a=e.keyCode||e.which,i=void 0!==e.metaKey&&e.metaKey||void 0!==e.ctrlKey&&e.ctrlKey;if("object"==typeof t.WS_Form.this.keydown[a]){var s=t.WS_Form.this.keydown[a];(s.ctrl_key&&i||!s.ctrl_key)&&(e.preventDefault(),s.function())}})},t.WS_Form.prototype.window_resize_init=function(){t(window).on("resize",function(){("toolbox"==t("#wsf-sidebars").attr("data-current")||null==t("#wsf-sidebars").attr("data-current"))&&t("#wsf-sidebar-toolbox").hasClass("wsf-sidebar-closed")&&window.matchMedia("(min-width: "+t.WS_Form.this.mobile_min_width+")").matches&&t.WS_Form.this.sidebar_open("toolbox")})},t.WS_Form.prototype.set_globals=function(e,a){this.framework_id=void 0!==e?e:t.WS_Form.settings_plugin.framework,this.framework=t.WS_Form.frameworks.types[this.framework_id],this.framework_fields=this.framework.fields[void 0!==a?a:"admin"],this.mobile_min_width="851px"},t.WS_Form.prototype.intro=function(){if("function"==typeof introJs){t("body").addClass("wsf-intro");var e=this;t.WS_Form.this.api_call("helper/intro/","GET",!1,function(a){if(t.WS_Form.this.loader_off(),"object"==typeof a){var i=[],s=[],o=[];for(var r in a)if(a.hasOwnProperty(r)){var n=a[r],d={};void 0!==n.hint&&(d.hint=n.hint),void 0!==n.position&&(d.hintPosition=n.position),void 0!==n.element&&(d.element=t(n.element)[0]),void 0!==n.sidebar_open&&(s[r]=n.sidebar_open),void 0!==n.button_url&&(o[r]=n.button_url),i.push(d)}var _=introJs();_.setOptions({hints:i}),_.onhintclick(function(a,i,r){if(void 0!==s[r]){var n=s[r],d="sidebar_"+n+"_open";if("function"==typeof window[d]){var _=t("#wsf-sidebar-"+n),l=t(".wsf-sidebar-inner",_);window[d](t.WS_Form.this,l,t(this))}else t.WS_Form.this.sidebar_open(n)}if(void 0!==o[r]){var c=o[r];setTimeout(function(){t(".introjs-tooltiptext").append('&nbsp;<a href="'+e.esc_url(c)+'" class="introjs-button" role="button" target="_blank">'+e.language("intro_learn_more")+"</a>"),t(".introjs-tooltiptext").append('<div data-action="wsf-intro-skip" class="wsf-intro-skip">'+e.language("intro_skip")+"</div>"),t('[data-action="wsf-intro-skip"]',t(".introjs-tooltiptext")).on("click",function(){introJs().hideHints(),t("body").removeClass("wsf-intro")})},50)}}),_.oncomplete(function(){t(body).removeClass("wsf-intro")}),_.addHints()}})}},t.WS_Form.prototype.form_render=function(){t('[data-action="wsf-form-label"]').val(this.form.label),this.form_interface||(this.sidebars_render(),this.breakpoints(),t('[data-action="wsf-form-label"]').on("change",function(e){if(e.originalEvent){var a=t(this).val();""==a&&(a=t.WS_Form.this.get_label_default("form"),t(this).val(a)),t.WS_Form.this.form.label=a,t.WS_Form.this.form_put()}}),t('[data-action="wsf-form-label"]').on("keydown input",function(e){13===(e.keyCode||e.which)?(e.preventDefault(),t(this).trigger("blur")):t('#wsf-sidebar-form [name="label"]').val(t(this).val())}),t('[data-action="wsf-form-label"]').on("focus",function(e){t('[data-action="wsf-label-save"]').show()}),t('[data-action="wsf-form-label"]').on("blur",function(e){t('[data-action="wsf-label-save"]').hide()}),t('[data-action="wsf-publish"]').on("click",function(){t.WS_Form.this.form_publish()}),t.WS_Form.settings_plugin.helper_live_preview&&t('[data-action="wsf-preview"]').on("click",function(e){t.WS_Form.this.form_preview(e,t(this))}),t('[data-action="wsf-form-upload"]').on("click",function(){t.WS_Form.this.upload_obj=t.WS_Form.this.form_obj,t("#wsf-object-upload-file").val("").trigger("click")}),t('[data-action="wsf-form-download"]').on("click",function(){t.WS_Form.this.form_download()}),t('[data-action="wsf-undo"]').on("click",function(){t.WS_Form.this.undo()}),t('[data-action="wsf-redo"]').on("click",function(){t.WS_Form.this.redo()}),this.mouseup_mode=!1,t(document).on("mouseup",function(){switch(t.WS_Form.this.mouseup_mode){case"column_size":t.WS_Form.this.column_size_change_release();break;case"offset":t.WS_Form.this.offset_change_release()}}),t("#wsf-object-upload-file").on("change",function(){var e=t("#wsf-object-upload-file").prop("files");if(e.length>0){var a=t("> .wsf-object-upload-json-window",t.WS_Form.this.upload_obj);a.show(),t.WS_Form.this.object_upload_json(e,a,t.WS_Form.this.upload_obj,function(e){t.WS_Form.this.form_build()},function(){t("> .wsf-object-upload-json-window",t.WS_Form.this.upload_obj).hide()},!0)}}),this.form_interface=!0);var e='<li class="wsf-group-add wsf-ui-cancel" role="tab"><button'+this.tooltip(this.language("add_group"),"top-center")+' tabindex="-1">'+this.svg("group")+this.svg("plus")+"</button></li>";t(".wsf-group-tabs").append(e),t(".wsf-group-add button").on("click",function(){t.WS_Form.this.group_post(t(this))}),this.group_tabs_init(),this.undo_redo_update(),t(".wsf-group").each(function(){t.WS_Form.this.group_render(t(this))}),this.breakpoint_buttons(),this.init_ui(),this.form_obj.append('<div class="wsf-object-upload-json-window"><div class="wsf-object-upload-json-window-content"><h1>'+this.language("drop_zone_form")+'</h1><div class="wsf-uploads"></div></div></div>'),this.form_obj.on("dragenter",function(e){e.stopPropagation(),e.preventDefault(),t.WS_Form.this.drag_is_file(e)&&t(".wsf-object-upload-json-window",t(this)).show()}),t(".wsf-object-upload-json-window",this.form_obj).on("dragover",function(t){t.stopPropagation(),t.preventDefault()}),t(".wsf-object-upload-json-window",this.form_obj).on("drop",function(e){e.preventDefault();var a=e.originalEvent.dataTransfer.files;t.WS_Form.this.object_upload_json(a,t(this),null,function(e){t.WS_Form.this.form_build()},function(){t(".wsf-object-upload-json-window",t.WS_Form.this.form_obj).hide()},!0)}),t(".wsf-object-upload-json-window",this.form_obj).on("dragleave",function(e){t(".wsf-object-upload-json-window",t.WS_Form.this.form_obj).hide()}),this.field_check_multiple(),t(".wsf-loading-hidden").show(),t(".wsf-fields, .wsf-sections").on("mousedown touchstart",function(){var e=t(this).height();t(this).css("min-height",e+"px")}).on("mouseup touchend",function(){t(".wsf-fields, .wsf-sections").css("min-height","auto")})},t.WS_Form.prototype.form_put=function(e,a,i,s,o){void 0===e&&(e=!1),void 0===a&&(a=!0),void 0===i&&(i=!1);var r=t.extend(!0,{},this.form);e||delete r.groups,a&&t.WS_Form.this.form_build(),i&&(r.history_suppress="on"),this.api_call("form/"+this.form_id+(e?"/full":"")+"/put/","POST",{form:r},function(e){void 0!==o&&o(),s&&t.WS_Form.this.form_preview_update(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.form_publish=function(){this.loader_on(),this.object_save_changes(),this.sidebar_reset(),this.api_call("form/"+this.form_id+"/publish/","POST",!1,function(e){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.form_preview=function(e,a){e.preventDefault(),this.object_save_changes(),this.preview_window&&!this.preview_window.closed||(this.preview_window=window.open(a.attr("href"),"wsf-preview-"+this.form_id),t(window).on("beforeunload",function(){t.WS_Form.this.preview_window.close(),this.preview_window=void 0})),this.preview_window.focus()},t.WS_Form.prototype.form_preview_update=function(){try{void 0!==this.preview_window&&void 0!==this.preview_window.location&&void 0!==this.preview_window.location.reload&&t.WS_Form.settings_plugin.helper_live_preview&&this.preview_window.location.reload()}catch(t){this.preview_window=void 0}},t.WS_Form.prototype.object_upload_json=function(e,a,i,s,o,r){if(void 0===r&&(r=!1),0==e.length)return o(),!1;switch(i){case"style":var n="style",d=0;break;default:n=null===i?"form":t.WS_Form.this.get_object_type(i),d=null===i?t.WS_Form.this.form_id:i.attr("data-id")}if("form"===n&&r&&!confirm(t.WS_Form.this.language(n+"_import_confirm")))return a.hide(),void o();t("h1",a).hide();var _=new FormData;switch(n){case"style":break;default:_.append("id",this.form_id),_.append(n+"_id",d)}switch(_.append("file",e[0]),_.append(ws_form_settings.wsf_nonce_field_name,ws_form_settings.wsf_nonce),n){case"group":var l=void 0!==i.next().attr("data-id")?i.next().attr("data-id"):0;_.append("next_sibling_id",l);break;case"section":l=void 0!==i.next().attr("data-id")?i.next().attr("data-id"):0;_.append("next_sibling_id",l);var c=i.closest(".wsf-group").attr("data-id");_.append("group_id",c)}this.sidebar_reset();var f=new this.upload_status_bar(this,a);switch(f.populate(e[0].name,e[0].size),n){case"style":var h=ws_form_settings.url_ajax+"style/upload/json";break;default:h=ws_form_settings.url_ajax+n+"/"+d+"/upload/json"}var p=t.ajax({beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",ws_form_settings.x_wp_nonce)},xhr:function(){var e=t.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(t){var e=0,a=t.loaded||t.position,i=t.total;t.lengthComputable&&(e=Math.ceil(a/i*100)),f.set_progress(e)},!1),e},url:h,type:"POST",contentType:!1,processData:!1,cache:!1,data:_,success:function(e){if(f.set_progress(100),void 0!==e.form&&void 0!==e.form_full&&e.form_full){switch(t.WS_Form.this.form=e.form,n){case"form":0!=t.WS_Form.this.get_object_meta_value(t.WS_Form.this.form,"tab_index",0,!0)&&(t.WS_Form.this.set_object_meta_value(t.WS_Form.this.form,"tab_index",0),t.WS_Form.this.group_tab_index_save(0))}t.WS_Form.this.data_cache_build(),t.WS_Form.this.api_call_process_checksum(e),t.WS_Form.this.breakpoints()}void 0!==e.history&&t.WS_Form.this.history_push(e),"function"==typeof s&&s(e)},error:function(e){t.WS_Form.this.api_call_error_handler(e,h,o)}});f.set_abort(p)},t.WS_Form.prototype.form_download=function(){var e='<form id="wsf-form-downloader" action="'+this.esc_attr(ws_form_settings.url_ajax+"form/"+this.form_id+"/download/json")+'" method="post">';e+='<input type="hidden" name="form_id" value="'+this.esc_attr(this.form_id)+'" />',e+='<input type="hidden" name="_wpnonce" value="'+this.esc_attr(ws_form_settings.x_wp_nonce)+'" />',e+='<input type="hidden" name="'+this.esc_attr(ws_form_settings.wsf_nonce_field_name)+'" value="'+this.esc_attr(ws_form_settings.wsf_nonce)+'" />',e+="</form>";t("body").append(e);t("#wsf-form-downloader").trigger("submit"),t("#wsf-form-downloader").remove()},t.WS_Form.prototype.group_render=function(e){var a=e.attr("data-id"),i=(this.group_data_cache[a],t('.wsf-group-tab[data-id="'+this.esc_selector(a)+'"]')),s=this.group_data_cache[a],o=this.get_object_meta_value(s,"hidden",!1),r=0;o&&r++;for(var n=t(".wsf-group-label",i),d=0;d<1;d++)n.removeClass("wsf-group-icon-count-"+d);if(n.addClass("wsf-group-icon-count-"+r),o?t(".wsf-group-hidden",i).show():t(".wsf-group-hidden",i).hide(),!e.find(".wsf-group-header").length){"on"==t.WS_Form.settings_plugin.helper_columns&&e.addClass("wsf-column-helper");var _='<div class="wsf-group-header">';_+=this.settings_html("group",a,!0),_+="</div>",e.prepend(_),this.settings_events(e,"group");var l='<li class="wsf-section-blank"><div>'+this.language("blank_section")+"</div></li>";e.find(".wsf-sections").prepend(l);var c='<div class="wsf-section-add" data-group-id="'+this.esc_attr(a)+'"><button'+this.tooltip(this.language("add_section"),"left")+">"+this.svg("section")+this.svg("plus")+"</button></div>";c+='<div class="wsf-object-upload-json-window"><div class="wsf-object-upload-json-window-content"><div class="wsf-uploads"></div></div></div>',e.append(c),t('.wsf-section-add[data-group-id="'+this.esc_selector(a)+'"] button').on("click",function(){t.WS_Form.this.section_post(t(this))}),this.label_init(i),e.find(".wsf-section").each(function(){t.WS_Form.this.section_render(t(this),!1)})}},t.WS_Form.prototype.group_tabs_count=function(){var e=t(".wsf-group-tabs li.wsf-group-tab"),a=e.length;1===a?e.first().addClass("wsf-disabled"):e.first().removeClass("wsf-disabled"),t("#wsf-sidebars").attr("data-group-count",a)},t.WS_Form.prototype.group_tabs_init=function(e){if(void 0===e)e=this.get_object_meta_value(this.form,"tab_index",0,!0);else t.WS_Form.this.group_tab_index_save(e);t.widget("ui.tabs",t.ui.tabs,{options:{keyboard:!0},_tabKeydown:function(t){if(!this.options.keyboard)return!1;this._super("_tabKeydown")}}),t("#"+this.form_obj_id).hasClass("ui-tabs")&&t("#"+this.form_obj_id).tabs("destroy"),t("#"+this.form_obj_id).tabs({active:e,activate:function(e,a){t.WS_Form.this.loader_on(),t.WS_Form.this.group_tab_index_save(a.newTab.index())}}),this.group_tabs_count()},t.WS_Form.prototype.group_tab_index_save=function(t){this.set_object_meta_value(this.form,"tab_index",t),this.form_put(!1,!1,!0,!1)},t.WS_Form.prototype.group_post=function(e){this.loader_on();var a=e.index();this.set_object_meta_value(this.form,"tab_index",a),t.WS_Form.this.api_call("group/","POST",!1,function(e){var a=t.extend(!0,{},e.data),i=a.id,s=t.WS_Form.this.get_group_html(a);t("#wsf-form .wsf-groups").append(s);var o=t('.wsf-group[data-id="'+t.WS_Form.this.esc_selector(i)+'"]'),r=t.WS_Form.this.get_tab_html(a);t(".wsf-group-tabs li.wsf-group-add").before(r);var n=t('.wsf-group-tab[data-id="'+t.WS_Form.this.esc_selector(i)+'"]');t.WS_Form.this.group_tabs_init(n.index()),t.WS_Form.this.group_render(o),t("input",n).first().trigger("dblclick"),t.WS_Form.this.init_ui(),t.WS_Form.this.loader_off(),t.WS_Form.this.group_tabs_count()})},t.WS_Form.prototype.group_put_sort_index=function(e){var a=t(".wsf-group-tabs li.ui-tabs-active").index();this.set_object_meta_value(this.form,"tab_index",a);var i=void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0;if(this.next_sibling_id_old==i)return!1;this.loader_on();var s=e.attr("data-id"),o={next_sibling_id:i};this.api_call("group/"+s+"/sort-index/","POST",o,function(e){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.group_put_clone=function(e){this.loader_on();var a=e.attr("data-id"),i=t('.wsf-group-tab[data-id="'+this.esc_selector(a)+'"]'),s=i.index();this.set_object_meta_value(this.form,"tab_index",s+1);var o={next_sibling_id:void 0!==i.next().attr("data-id")?i.next().attr("data-id"):0},r=e;this.api_call("group/"+a+"/clone/","POST",o,function(e){var i=e.data.id,s=t.WS_Form.this.get_tab_html(e.data),o=t(s).insertAfter(t('.wsf-group-tab[data-id="'+t.WS_Form.this.esc_selector(a)+'"]')),n=t.WS_Form.this.get_group_html(e.data);t(n).insertAfter(r);var d=t('.wsf-group[data-id="'+t.WS_Form.this.esc_selector(i)+'"]');t.WS_Form.this.group_render(d),t.WS_Form.this.group_tabs_init(o.index()),t.WS_Form.this.object_blank_update(d),t("input",o).first().trigger("dblclick"),t.WS_Form.this.init_ui(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.section_render=function(e){var a=e.attr("data-id"),i=this.section_data_cache[a],s=this.get_object_meta_value(i,"hidden_section",!1),o=this.get_object_meta_value(i,"disabled_section",!1),r=this.get_object_meta_value(i,"section_repeatable",!1),n=0;s&&n++,o&&n++,r&&n++;for(var d=t(".wsf-section-label",e),_=0;_<4;_++)d.removeClass("wsf-section-icon-count-"+_);if(d.addClass("wsf-section-icon-count-"+n),s?t(".wsf-section-hidden",e).show():t(".wsf-section-hidden",e).hide(),o?t(".wsf-section-disabled",e).show():t(".wsf-section-disabled",e).hide(),r?t(".wsf-section-repeatable",e).show():t(".wsf-section-repeatable",e).hide(),"on"==t.WS_Form.settings_plugin.helper_columns&&e.addClass("wsf-column-helper"),0==e.find(".wsf-settings-section").length){var l=this.settings_html("section",a,!0);l+=this.column_size_change_html(),l+=this.offset_change_html(),l+='<div class="wsf-object-upload-json-window"><div class="wsf-object-upload-json-window-content"><div class="wsf-uploads"></div></div></div>',e.append(l),this.settings_events(e,"section");var c='<li class="wsf-field-blank"><div>'+this.language("blank_field")+"</div></li>";e.find(".wsf-fields").prepend(c),this.column_size_change_init(e),this.offset_change_init(e),this.label_init(e)}e.find("li.wsf-field-wrapper[data-id]").each(function(){t.WS_Form.this.field_render(t(this))})},t.WS_Form.prototype.section_post=function(e){this.loader_on();var a=e.closest(".wsf-group").attr("data-id"),i={group_id:a};t.WS_Form.this.api_call("section/","POST",i,function(e){var i=t.extend(!0,{},e.data),s=i.id,o=t.WS_Form.this.get_section_html(i);t('.wsf-sections[data-id="'+t.WS_Form.this.esc_selector(a)+'"]').append(o);var r=t('.wsf-section[data-id="'+t.WS_Form.this.esc_selector(s)+'"]');t.WS_Form.this.section_render(r),t("input",r).first().trigger("dblclick"),t.WS_Form.this.init_ui(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.template_section_post=function(e){this.loader_on();var a=e.attr("data-id"),i={group_id:e.closest(".wsf-group").attr("data-id"),next_sibling_id:void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0,template_id:a};t.WS_Form.this.api_call("section/template/","POST",i,function(e){e.form_full&&(t.WS_Form.this.form=e.form,t.WS_Form.this.data_cache_build(),t.WS_Form.this.api_call_process_checksum(e),t.WS_Form.this.form_build()),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.section_put_sort_index=function(e){var a=void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0,i=e.closest(".wsf-group").attr("data-id");if(this.next_sibling_id_old==a&&this.group_id_old==i)return!1;this.loader_on();var s=e.attr("data-id"),o={group_id:i,next_sibling_id:a};t.WS_Form.this.api_call("section/"+s+"/sort-index/","POST",o,function(e){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.section_put_clone=function(e){this.loader_on();var a=e.attr("data-id"),i={next_sibling_id:void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0},s=e;this.api_call("section/"+a+"/clone/","POST",i,function(e){var a=e.data.id,i=t.WS_Form.this.get_section_html(e.data);t(i).insertAfter(s);var o=t('.wsf-section[data-id="'+t.WS_Form.this.esc_selector(a)+'"]');t.WS_Form.this.section_render(o),t("input",o).first().trigger("dblclick"),t.WS_Form.this.object_blank_update(o),t.WS_Form.this.init_ui(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.field_render=function(e,a){if(void 0===a){var i=e.attr("data-id");a=this.field_data_cache[i]}else i=a.id;var s=this.column_class_array(a);e.hasClass("wsf-editing")&&s.push("wsf-editing"),e.hasClass("wsf-saving")&&s.push("wsf-saving");var o="wsf-field-wrapper"+(s.length?" "+s.join(" "):"");e.attr("class",o);var r=a.type,n=t.WS_Form.field_type_cache[r],d=a.label;if(void 0!==n)var _=n.label,l=n.icon,c=(n.mask_field_label,void 0!==n.mask_preview),f=void 0===n.multiple||n.multiple,h=void 0!==n.admin_hide_id&&n.admin_hide_id,p=void 0!==n.mask_wrappers_drop&&n.mask_wrappers_drop;else _=this.language("error_field_type_unknown"),l=this.svg("default"),c=!1,f=!1,h=!1,p=!1;t.WS_Form.settings_plugin.helper_field_id&&!h&&e.attr("title","#field("+i+")");var u=this.get_object_meta_value(a,"required",!1),m=this.get_object_meta_value(a,"hidden",!1),v=this.get_object_meta_value(a,"disabled",!1),g=this.get_object_meta_value(a,"readonly",!1),b=this.get_object_meta_value(a,"data_source_last_api_error",""),w=this.field_setting_error(a);w.has_required_setting&&e.attr("data-required-setting","");var y=[];u&&y.push('<span class="wsf-required" title="'+this.language("required")+'"></span>'),m&&y.push('<span title="'+this.language("hidden")+'">'+this.svg("hidden")+"</span>"),v&&y.push('<span title="'+this.language("disabled")+'">'+this.svg("disabled")+"</span>"),g&&y.push('<span title="'+this.language("readonly")+'">'+this.svg("readonly")+"</span>"),!1!==w.field_setting_error&&y.push('<span class="wsf-required-setting" title="'+this.language("required_setting")+'">'+this.svg("warning")+"</span>"),""!==b&&(void 0===this.form_obj.attr("data-data-source-error")&&(this.data_source_error(a,b),this.form_obj.attr("data-data-source-error","")),y.push('<span class="wsf-data-source-error" title="'+this.language("data_grid_data_source_error")+'">'+this.svg("warning")+"</span>"));var S=y.length,W='<div class="wsf-field-inner">';if(W+='<div class="wsf-field-label'+(S>0?" wsf-field-icon-count-"+S:"")+'">'+l,W+=y.join(""),W+='<input type="text" value="'+this.esc_attr(d)+'" data-label="'+this.esc_attr(i)+'" readonly maxlength="1024" aria-label="'+this.language("field_label_aria",n.label)+'""></div>',h||(W+='<div class="wsf-field-type">'+this.esc_html(_),t.WS_Form.settings_plugin.helper_field_id&&(W+='<span class="wsf-field-id">'+this.language("id")+": "+this.esc_html(i)+"</span>"),W+="</div>"),c){var F={text_editor:this.get_object_meta_value(a,"text_editor","",!0),html_editor:this.get_object_meta_value(a,"html_editor","",!0)},k=this.mask_parse(n.mask_preview,F);this.wpautop_parse_variable(a,n)&&(k=this.wpautop(k));var j=document.createElement("div");j.innerHTML=k,W+='<div class="wsf-field-preview">'+(k=j.innerHTML)+"</div>"}W+="</div>","recaptcha"==r&&"invisible"==this.get_object_meta_value(a,"recaptcha_recaptcha_type","default")&&(p=!0),"hcaptcha"==r&&"invisible"==this.get_object_meta_value(a,"hcaptcha_type","default")&&(p=!0),W+=this.settings_html("field",i,f,p),p||(W+=this.column_size_change_html(),W+=this.offset_change_html()),e.html(W),this.settings_events(e,"field"),this.label_init(e),p||(this.column_size_change_init(e),this.offset_change_init(e))},t.WS_Form.prototype.fields_setting_error=function(){t("[data-required-setting]",this.form_obj).each(function(){t.WS_Form.this.field_render(t(this))})},t.WS_Form.prototype.field_setting_error=function(e){var a=[];if(void 0===e.meta)return!1;if(void 0===t.WS_Form.meta_keys_required_setting[e.type]&&void 0!==t.WS_Form.field_type_cache[e.type]){var i=t.WS_Form.field_type_cache[e.type],s=this.field_type_meta_keys(i,"required_setting","required_setting_global_meta_key");t.WS_Form.meta_keys_required_setting[e.type]=s}var o=t.WS_Form.meta_keys_required_setting[e.type].length>0;if(o)for(var r in t.WS_Form.meta_keys_required_setting[e.type])if(t.WS_Form.meta_keys_required_setting[e.type].hasOwnProperty(r)){var n=t.WS_Form.meta_keys_required_setting[e.type][r];if(void 0!==e.meta[n]&&""!=e.meta[n]||a.push(n),void 0!==t.WS_Form.meta_keys[n]){var d=t.WS_Form.meta_keys[n];if(void 0!==d.type&&"select"==d.type){if(void 0===d.options)continue;if("fields"==d.options){var _=e.meta[n];void 0===this.field_data_cache[_]&&a.push(n)}if("sections"==d.options){var l=e.meta[n];void 0===this.section_data_cache[l]&&a.push(n)}}}}return{has_required_setting:o,field_setting_error:a.length>0&&a}},t.WS_Form.prototype.object_blank_update=function(e){void 0===e&&(e=t(".wsf-group")),t(".wsf-sections",e).each(function(){var e=t(".wsf-section:not(.ui-sortable-helper)",t(this)).length,a=t(".wsf-section.ui-sortable-helper",t(this)).length,i=t(".wsf-section-placeholder",t(this)).length,s=t(".wsf-section-blank:visible",t(this)).length,o=e+i;t.WS_Form.this.dragged_section&&0==e&&1==a&&1==i&&0==s&&(o=0);var r=t(".wsf-section-blank",t(this));0==o?r.show():r.hide()}),t(".wsf-fields",e).each(function(){var e=t("li.wsf-field-wrapper:not(.ui-sortable-helper)",t(this)).length,a=t("li.wsf-field-wrapper.ui-sortable-helper",t(this)).length,i=t(".wsf-field-placeholder",t(this)).length,s=t(".wsf-field-blank:visible",t(this)).length,o=e+i;t.WS_Form.this.dragged_field&&0==e&&1==a&&1==i&&0==s&&(o=0);var r=t(".wsf-field-blank",t(this));0==o?r.show():r.hide()})},t.WS_Form.prototype.field_post=function(e){this.loader_on(),t("li.wsf-field-wrapper[data-id] input:not([readonly])").trigger("blur");var a=e.parent().attr("data-id"),i=e.attr("data-type"),s=e.attr("data-width-factor"),o=void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0,r={section_id:a,type:i,next_sibling_id:o};s&&(r.width_factor=s);var n=e;t.WS_Form.this.api_call("field/","POST",r,function(i){n.attr("data-id",i.data.id),t.WS_Form.this.field_data_cache[i.data.id]=t.extend(!0,{},i.data),t.WS_Form.this.field_render(n),t("input",e).first().trigger("dblclick"),t.WS_Form.this.object_blank_update(t('.wsf-section[data-id="'+t.WS_Form.this.esc_selector(a)+'"]')),t.WS_Form.this.field_check_multiple(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.field_type_click_section_id_set=function(){var t=this.get_object_meta_value(this.form,"tab_index",0,!0);if(t||(t=0),void 0===this.form.groups)return!1;if(void 0===this.form.groups[t])return!1;var e=this.form.groups[t];if(void 0===e.sections)return!1;var a=!1,i=!1;for(var s in e.sections)if(e.sections.hasOwnProperty(s)){var o=e.sections[s];if(!1===a&&(a=o.id),void 0===o.fields)return!1;if(0==o.fields.length){a=o.id;break}for(var r in o.fields)if(o.fields.hasOwnProperty(r)){var n=o.fields[r];(!1===i||i<n.date_updated)&&(i=n.date_updated,a=o.id)}}return a},t.WS_Form.prototype.field_check_multiple=function(){var e=[];for(var a in t.WS_Form.field_type_cache)t.WS_Form.field_type_cache.hasOwnProperty(a)&&(e[a]=!1);for(var i in this.field_data_cache)if(this.field_data_cache.hasOwnProperty(i)&&void 0!==this.field_data_cache[i]){var s=this.field_data_cache[i];if(void 0!==s.type){a=s.type;var o=t.WS_Form.field_type_cache[a];if(void 0!==o.multiple)o.multiple||(e[a]=!0)}}for(var a in t.WS_Form.field_type_cache)if(t.WS_Form.field_type_cache.hasOwnProperty(a)){var r=t('#wsf-form-field-selector [data-type="'+this.esc_selector(a)+'"]');e[a]?r.addClass("wsf-field-disabled"):r.removeClass("wsf-field-disabled")}},t.WS_Form.prototype.field_put_sort_index=function(e){if(e.length&&e.attr("data-id")){var a=void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0,i=e.closest(".wsf-section").attr("data-id");if(this.next_sibling_id_old==a&&this.section_id_old==i)return!1;this.loader_on();var s=e.attr("data-id"),o={next_sibling_id:a,section_id:i};t.WS_Form.this.api_call("field/"+s+"/sort-index/","POST",o,function(e){t.WS_Form.this.loader_off()})}},t.WS_Form.prototype.field_put_clone=function(e){this.loader_on();var a=e.attr("data-id"),i={next_sibling_id:void 0!==e.next().attr("data-id")?e.next().attr("data-id"):0},s=e;this.api_call("field/"+a+"/clone/","POST",i,function(e){var a=e.data.id,i=t.WS_Form.this.get_field_html(e.data);t(i).insertAfter(s);var o=t('li.wsf-field-wrapper[data-id="'+t.WS_Form.this.esc_selector(a)+'"]');o.hide(),t.WS_Form.this.field_render(o),o.show(),t("input",o).first().trigger("dblclick"),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.label_init=function(e){var a=e.find("input").first();e.attr("data-id");switch(t.WS_Form.this.get_object_type(e)){case"group":this.input_auto_size(a,"wsf-group-tab-input-dummy")}a.on("keydown input",function(e){var a=t(this).closest("[data-id]"),i=a.attr("data-id"),s=t.WS_Form.this.get_object_type(a);if(13===(e.keyCode||e.which))e.preventDefault(),t(this).trigger("blur");else{var o=t(this).val();t.WS_Form.this.label_update(s,i,o)}}),a.on("blur",function(){var e=t(this).closest("[data-id]"),a=e.attr("data-id"),i=t.WS_Form.this.get_object_type(e);t.WS_Form.this.label_save(t(this),i,a),t.WS_Form.this.label_dblclick_enable(t(this))}),a.on("focus",function(){t(this).prop("readonly",!1).trigger("select"),t.WS_Form.this.label_old=t(this).val(),t(this).off("dblclick")}),this.label_dblclick_enable(a)},t.WS_Form.prototype.label_dblclick_enable=function(e){e.on("dblclick",function(){t(this).prop("readonly",!1).trigger("select"),t.WS_Form.this.label_old=t(this).val(),t(this).off("dblclick")})},t.WS_Form.prototype.label_update=function(e,a,i){switch(e){case"group":t.WS_Form.this.group_data_cache[a].label=i;break;case"section":t.WS_Form.this.section_data_cache[a].label=i;break;case"field":t.WS_Form.this.field_data_cache[a].label=i}var s=t("#wsf-sidebar-"+e+'[data-id="'+this.esc_selector(a)+'"] [name="label"]');s.length&&(""==i.trim()&&(i=this.get_label_default(e)),s.val(i))},t.WS_Form.prototype.label_save=function(e,a,i){document.getSelection().removeAllRanges(),e.prop("readonly",!0);var s=e.val();if((s=s.trim())==this.label_old)return!0;""==s&&(s=this.get_label_default(a),e.val(s).trigger("change")),this.label_update(a,i,s),t.WS_Form.this.loader_on();var o={};switch(o.form_id=this.form_id,a){case"group":o[a]=t.WS_Form.this.group_data_cache[i];break;case"section":o[a]=t.WS_Form.this.section_data_cache[i];break;case"field":o[a]=t.WS_Form.this.field_data_cache[i]}this.api_call(a+"/"+i+"/put/","POST",o,function(e){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.get_object_type=function(t){return t.hasClass("wsf-form")?"form":t.hasClass("wsf-form-style")?"style":t.hasClass("wsf-group-tab")?"group":t.hasClass("wsf-group")?"group":t.hasClass("wsf-section")?"section":t.hasClass("wsf-field-wrapper")?"field":!!t.hasClass("wsf-data-grid-group-tab")&&"data-grid-group-tab"},t.WS_Form.prototype.get_label_default=function(t){var e="";switch(t){case"form":e=this.language("default_label_form");break;case"group":e=this.language("default_label_group");break;case"section":e=this.language("default_label_section");break;case"field":e=this.language("default_label_field")}return e},t.WS_Form.prototype.object_edit=function(e,a){var i=this.get_object_type(e),s=e.attr("data-id"),o=t("#wsf-sidebar-"+i);if(e.hasClass("wsf-editing")){switch(i){case"group":t('.wsf-group-tab[data-id="'+this.esc_selector(s)+'"]').removeClass("wsf-editing")}return e.removeClass("wsf-editing"),this.object_save(e),this.sidebars_sanitize(),this.sidebar_reset(),!1}switch(this.object_save_changes(a),this.sidebars_sanitize(),e.addClass("wsf-editing"),i){case"group":t('.wsf-group-tab[data-id="'+this.esc_selector(s)+'"]').addClass("wsf-editing");t('.wsf-group-tab[data-id="'+this.esc_selector(s)+'"] a').trigger("click")}var r=this.get_object_data(i,s),n=this.get_object_meta(i,s);a||(this.object_data_scratch=t.extend(!0,{},r)),o.hasClass("ui-tabs")&&o.tabs("destroy"),o.attr("data-object",i).attr("data-id",s);var d="",_="",l="",c=[];if(void 0!==n.fieldsets){this.sidebar_cache_clear(o);var f=[{class:"wsf-button-primary",action:"wsf-sidebar-save-close",label:this.language("save_and_close")},{class:"wsf-button-primary",action:"wsf-sidebar-save",label:this.language("save")},{class:"",action:"wsf-sidebar-cancel",label:this.language("cancel")}];switch(i){case"group":case"section":case"field":f.push({class:"",action:"wsf-sidebar-clone",right:!0,label:this.language("clone")}),f.push({class:"wsf-button-danger",action:"wsf-sidebar-delete",label:this.language("delete")})}var h=this.sidebar_html(i,s,this.object_data_scratch,n,!1,!0,!0,!0,f);d=h.html_tabs,_=h.html,l=h.html_buttons,c=h.inits}this.sidebar_title_init(i,s,n,o),o.append(d),o.append('<div class="wsf-sidebar-inner">'+_+"</div>");var p=t(".wsf-sidebar-inner",o);o.append(l),this.sidebar_inits(c,o,p,this.object_data_scratch),this.sidebar_label_init(n,e,i,o,p),this.sidebar_buttons_init(e,o),this.sidebar_change_event_init(e,i,p),this.sidebar_open(i)},t.WS_Form.prototype.sidebars_sanitize=function(){t(".wsf-sidebar:not(#wsf-sidebar-support) [data-meta-key]").removeAttr("id data-meta-key data-meta-key-type")},t.WS_Form.prototype.object_save_changes=function(e){if(void 0===e&&(e=!1),this.sidebar_lock_count)return!1;switch(t("[data-action-sidebar].wsf-editing").first().attr("data-action-sidebar")){case"form":t.WS_Form.this.object_save(t("#wsf-form"));break;case"action":t.WS_Form.this.sidebar_action_save();break;default:var a=t(".wsf-editing",t("#wsf-form"));a.length&&!e&&(t(".wsf-sidebar.wsf-sidebar-open :focus").trigger("blur"),this.object_save(a),a.removeClass("wsf-editing"))}},t.WS_Form.prototype.object_button_save=function(t,e){void 0===e&&(e=!1),this.object_save(t);this.get_object_type(t),t.attr("data-id");e&&(this.object_cancel(t),this.sidebar_reset())},t.WS_Form.prototype.object_button_cancel=function(t){this.object_cancel(t),this.sidebar_reset()},t.WS_Form.prototype.object_button_clone=function(t){switch(this.get_object_type(t)){case"group":wsf_group_clone(this,t);break;case"section":wsf_section_clone(this,t);break;case"field":wsf_field_clone(this,t)}},t.WS_Form.prototype.object_button_delete=function(t){switch(this.object_cancel(t),this.sidebar_reset(),this.get_object_type(t)){case"group":wsf_group_delete(this,t);break;case"section":wsf_section_delete(this,t);break;case"field":wsf_field_delete(this,t)}},t.WS_Form.prototype.saving_notification=function(e){t("#wsf-sidebars .wsf-sidebar").addClass("wsf-saving");var a=!1;if(e){e.addClass("wsf-saving");var i=this.get_object_type(e),s=e.attr("data-id");switch(i){case"group":a=t('.wsf-group-tab[data-id="'+this.esc_selector(s)+'"]')}}a&&a.addClass("wsf-saving"),setTimeout(function(){t("#wsf-sidebars .wsf-sidebar").removeClass("wsf-saving"),e&&e.removeClass("wsf-saving"),a&&a.removeClass("wsf-saving")},500)},t.WS_Form.prototype.object_save=function(e,a){void 0===a&&(a=!0);var i=this.get_object_type(e),s=e.attr("data-id"),o=t("#wsf-sidebar-"+i),r=t(".wsf-sidebar-inner",o);if(a)switch(i){case"form":var n=JSON.stringify(this.form);break;case"group":n=JSON.stringify(this.group_data_cache[s]);break;case"section":n=JSON.stringify(this.section_data_cache[s]);break;case"field":n=JSON.stringify(this.field_data_cache[s])}for(var d in this.object_meta_cache)if(this.object_meta_cache.hasOwnProperty(d)){var _=this.object_meta_cache[d].meta_key,l=this.object_data_update_by_meta_key(i,this.object_data_scratch,_);if("data_source_id"===_&&l){_=t('[data-meta-key="data_source_id"]',r).closest(".wsf-data-grid").attr("data-meta-key");t.WS_Form.this.data_grid_clear_rows(_)}}switch(i){case"field":var c=this.field_data_cache[s],f=t.WS_Form.field_type_cache[c.type],h=f.label_default;break;default:h=this.get_label_default(i)}var p=t('[name="label"]',r).val();if(void 0!==p&&(this.object_data_scratch.label=""==p?h:p),a){var u=!1;switch(i){case"form":this.form.label=this.object_data_scratch.label,this.form.meta=this.object_data_scratch.meta,this.set_preview_url_styler();break;case"group":this.group_data_cache[s].label=this.object_data_scratch.label,this.group_data_cache[s].meta=this.object_data_scratch.meta;break;case"section":var m=this.get_object_meta_value(this.section_data_cache[s],"section_repeatable",!1),v=this.get_object_meta_value(this.object_data_scratch,"section_repeatable",!1);u=!m&&v,this.breakpoint_optimize(this.object_data_scratch),this.section_data_cache[s].label=this.object_data_scratch.label,this.section_data_cache[s].meta=this.object_data_scratch.meta;break;case"field":switch(this.breakpoint_optimize(this.object_data_scratch),void 0!==this.object_data_scratch.type&&this.object_data_scratch.type){case"checkbox":case"radio":this.orientation_breakpoint_optimize(this.object_data_scratch)}this.field_data_cache[s].label=this.object_data_scratch.label,this.field_data_cache[s].meta=this.object_data_scratch.meta}if(JSON.stringify(this.object_data_scratch)!==n){this.loader_on();var g={form_id:this.form_id};g[i]=this.object_data_scratch,t.WS_Form.this.saving_notification(e),this.api_call(i+"/"+s+"/put/","POST",g,function(a){switch(i){case"field":void 0!==f.mask_preview&&f.mask_preview&&t.WS_Form.this.field_render(e,t.WS_Form.this.field_data_cache[s]);break;case"section":u&&t.WS_Form.this.sidebar_fields_toggle_init(e,i,r)}t.WS_Form.this.loader_off()})}}},t.WS_Form.prototype.object_cancel=function(e){var a=this.get_object_type(e),i=e.attr("data-id");switch(a){case"form":t('[data-action="wsf-form-label"]').val(t.WS_Form.this.form.label),t('[data-action="wsf-form-settings"]').removeClass("wsf-editing");break;case"group":this.group_render(e);var s=this.get_object_data(a,i);t('.wsf-group-tab[data-id="'+this.esc_selector(i)+'"] a input').val(s.label).trigger("change"),t('.wsf-group-tab[data-id="'+this.esc_selector(i)+'"]').removeClass("wsf-editing");break;case"section":s=this.get_object_data(a,i);t('.wsf-section[data-id="'+this.esc_selector(i)+'"] .wsf-section-label input').val(s.label),t.WS_Form.this.section_render(e);break;case"field":this.field_render(e)}if(!1!==this.object_data_scratch){s=!1;switch(a){case"section":s=this.section_data_cache[i];break;case"field":s=this.field_data_cache[i]}!1!==s&&(this.column_classes_render(e,this.object_data_scratch,!1),this.column_classes_render(e,s))}e.removeClass("wsf-editing"),this.object_data_scratch=!1,t(".wsf-breakpoint-sizes.wsf-breakpoint-sizes-initialized").remove(),t.WS_Form.this.keydown=[]},t.WS_Form.prototype.object_delete=function(e){this.loader_on(),e.hide();var a=this.get_object_type(e),i=e.attr("data-id");switch(a){case"group":e.remove();var s=t('.wsf-group-tab[data-id="'+this.esc_selector(i)+'"]'),o=s.index();s.remove(),this.group_tabs_count(),--o<0&&(o=0),t(".wsf-group-tabs li.wsf-group-tab:eq("+o+") a").trigger("click"),this.set_object_meta_value(this.form,"tab_index",o),delete this.group_data_cache[i];break;case"section":e.remove(),t.WS_Form.this.object_blank_update(),delete this.section_data_cache[i];break;case"field":e.remove(),t.WS_Form.this.object_blank_update(),delete this.field_data_cache[i]}this.api_call(a+"/"+i+"/delete/","POST",!1,function(e){t.WS_Form.this.field_check_multiple(),t.WS_Form.this.fields_setting_error(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.object_download=function(e){var a=this.get_object_type(e),i=e.attr("data-id"),s='<form id="wsf-object-downloader" action="'+this.esc_attr(ws_form_settings.url_ajax+a+"/"+i)+'/download/json" method="post">';s+='<input type="hidden" name="id" value="'+this.esc_attr(this.form_id)+'" />',s+='<input type="hidden" name="_wpnonce" value="'+this.esc_attr(ws_form_settings.x_wp_nonce)+'" />',s+='<input type="hidden" name="'+this.esc_attr(ws_form_settings.wsf_nonce_field_name)+'" value="'+this.esc_attr(ws_form_settings.wsf_nonce)+'" />',s+="</form>";t("body").append(s);t("#wsf-object-downloader").trigger("submit"),t("#wsf-object-downloader").remove(),this.sidebar_reset()},t.WS_Form.prototype.object_template_add=function(e){var a=this.get_object_type(e),i=e.attr("data-id");t.WS_Form.this.api_call(a+"/"+i+"/template/add/","POST",!1,function(e){t.WS_Form.this.sidebar_open("toolbox"),t('[data-wsf-tab-key="section-selector"]',t("#wsf-sidebar-toolbox")).trigger("click"),t.WS_Form.this.template_api_response(e),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.template_download=function(e){var a='<form id="wsf-template-downloader" action="'+this.esc_attr(ws_form_settings.url_ajax+"template/download/json")+'" method="post">';a+='<input type="hidden" name="template_id" value="'+this.esc_attr(e)+'" />',a+='<input type="hidden" name="_wpnonce" value="'+this.esc_attr(ws_form_settings.x_wp_nonce)+'" />',a+='<input type="hidden" name="'+this.esc_attr(ws_form_settings.wsf_nonce_field_name)+'" value="'+this.esc_attr(ws_form_settings.wsf_nonce)+'" />',a+="</form>";t("body").append(a);t("#wsf-template-downloader").trigger("submit"),t("#wsf-template-downloader").remove()},t.WS_Form.prototype.object_upload=function(e){this.upload_obj=e,t("#wsf-object-upload-file").val("").trigger("click")},t.WS_Form.prototype.object_data_update_by_meta_key=function(e,a,i){var s=t.WS_Form.meta_keys[i].type;void 0!==t.WS_Form.meta_keys[i].key&&(i=t.WS_Form.meta_keys[i].key);var o=t("#wsf-sidebar-"+e+' [data-meta-key="'+this.esc_selector(i)+'"]');if(!o.length)return!1;var r=this.get_meta_value_by_obj(o,s);return!1!==r&&this.set_object_meta_value(a,i,r),r},t.WS_Form.prototype.get_meta_value_by_obj=function(e,a){var i=!1;switch(a){case"data_grid":break;case"checkbox":i=e.is(":checked")?e.val():"";break;case"repeater":var s=this.sidebar_repeater_get(e),o=e.attr("data-meta-key");for(var r in i=[],s.meta_keys)if(s.meta_keys.hasOwnProperty(r)){var n=s.meta_keys[r];if(void 0!==t.WS_Form.meta_keys[n]){void 0!==t.WS_Form.meta_keys[n].key&&(n=t.WS_Form.meta_keys[n].key);var d=0;t('[name="'+this.esc_selector(o+"_"+n)+'[]"]').each(function(){void 0===i[d]&&(i[d]={});var e=t.WS_Form.this.get_meta_value_by_obj(t(this),t(this).attr("data-meta-key-type"));!1!==e&&(i[d][n]=e),d++})}}break;default:i=e.val()}return null==i&&(i=""),i},t.WS_Form.prototype.sidebar_html=function(e,a,i,s,o,r,n,d,_,l,c,f){if(void 0===s.fieldsets)return"";void 0===o&&(o=!1),void 0===r&&(r=!0),void 0===n&&(n=!0),void 0===d&&(d=!0),void 0===_&&(_=!0),void 0===l&&(l=1),void 0===c&&(c=[]),void 0===f&&(f="datetime-local");var h=!1!==o;h&&(r=!1,n=!1,d=!1,_=!1);var p=s.fieldsets,u=0,m="";if(1==l&&!h){for(var v in p)if(p.hasOwnProperty(v)){var g=p[v];m+='<li><a href="'+this.esc_url("#wsf-"+e+"-"+v)+'" data-wsf-tab-key="'+this.esc_attr(v)+'">'+this.esc_html(g.label)+"</a></li>",u++}m='<ul class="wsf-sidebar-tabs wsf-sidebar-tabs-'+u+'">'+m+"</ul>\n\n",u>1?c.push("tabs"):m=""}var b="",w=0;for(var v in p)if(p.hasOwnProperty(v)){g=p[v];1!=l||h||(b+=this.comment_html(this.language("group")+" - "+g.label),b+='<div id="wsf-'+this.esc_attr(e+"-"+v)+'"'+(u>1?' class="wsf-sidebar-tabs-panel"':"")+">");var y=["wsf-fieldset"];if(void 0!==g.class&&(y=y.concat(g.class)),b+=r?'<fieldset class="'+this.esc_attr(y.join(" "))+'">':"",l>1&&g.label&&(b+="<legend>"+g.label+"</legend>"),0==w&&1==l&&d&&(b+='<div class="wsf-field-wrapper"><label class="wsf-label" id="wsf-'+this.esc_attr(e)+'-label-label" for="wsf-'+this.esc_attr(e)+'-label">Label</label><input name="label" id="wsf-'+this.esc_attr(e)+'-label" class="wsf-field" type="text" value="'+this.esc_attr(i.label)+'" maxlength="1024" aria-labelledby="wsf-'+this.esc_attr(e)+'-label-label" /></div>',c.push("label")),void 0!==g.meta_keys)for(var v in g.meta_keys)if(g.meta_keys.hasOwnProperty(v)){var S="",W={},F=g.meta_keys[v];if(void 0!==t.WS_Form.meta_keys[F]){var k=t.WS_Form.meta_keys[F];if(void 0!==k.key&&(F=k.key),void 0===k.option_check||!t.WS_Form.settings_plugin[k.option_check]){if(void 0!==k.condition)for(var j in k.condition)if(k.condition.hasOwnProperty(j)){var x=k.condition[j];this.sidebar_conditions.push({logic:x.logic,meta_key:x.meta_key,meta_value:x.meta_value,show:F,logic_previous:void 0!==x.logic_previous?x.logic_previous:"&&",type:void 0!==x.type?x.type:"sidebar_meta_key"}),c.push("conditions")}var O=void 0!==k.required&&k.required,C=k.label,P=k.type,z=void 0!==k.fallback&&k.fallback,q=!1===z?void 0!==k.default?k.default:"":z,T=this.get_object_meta_value(i,F,q,!0);if("input_type_datetime"==F&&(f=T),void 0!==k.help&&(t.WS_Form.settings_plugin.helper_field_help||void 0!==k.help_force&&k.help_force)&&!h)var I='<div class="wsf-helper">'+k.help+"</div>";else I="";var E=h||void 0===C?"":'<label class="wsf-label"'+("repeater"!=P?' for="wsf_'+this.esc_attr(F)+'"':"")+">"+C+(O?' <span class="wsf-required"></span>':"")+"</label>",D=void 0!==k.class_field?" "+k.class_field:"",A=" "+(h?' name="'+this.esc_attr(o+"_"+F)+'[]"':'id="wsf_'+this.esc_attr(F)+'"')+' class="wsf-field'+this.esc_attr(D)+(h?" wsf-field-small":"")+'" data-meta-key="'+this.esc_attr(F)+'" data-meta-key-type="'+this.esc_attr(P)+'"',M=[];if(void 0!==k.required_setting&&k.required_setting){var L=!0;if(void 0!==k.required_setting_global_meta_key&&k.required_setting_global_meta_key){var N=k.required_setting_global_meta_key;void 0!==t.WS_Form.settings_plugin[N]&&""!=t.WS_Form.settings_plugin[N]&&(k.placeholder=this.language("sidebar_placeholder_global_setting"),L=!1)}L&&(M.push('<li class="wsf-required-setting">'+this.svg("warning")+"</li>"),A+=" data-required-setting",c.push("required-setting"))}if(void 0!==k.compatibility_url&&t.WS_Form.settings_plugin.helper_compatibility&&!h&&M.push('<li><a class="wsf-compatibility" href="'+this.esc_url(k.compatibility_url)+'" target="_blank"'+this.tooltip(this.language("attribute_compatibility"),"top-right")+' tabindex="-1">'+this.svg("markup")+"</a></li>"),"field"===e&&void 0!==k.calc){var R=i.type,J=void 0!==(zt=t.WS_Form.field_type_cache[R]).calc_in&&zt.calc_in,U=void 0!==k.calc_for_type&&k.calc_for_type;!J||!1!==U&&U!==P||M.push('<li><a href="https://wsform.com/knowledgebase/calculated-fields/"'+this.tooltip(this.language("calc"),"top-right")+' target="_blank">'+this.svg("calc")+"</a></li>")}if("object"==typeof k.select_list&&(M.push('<li><div data-action="wsf-select-list" data-option-meta-key="'+this.esc_attr(F)+'"'+this.tooltip(this.language("select_list"),"top-right")+">"+this.svg("menu")+"</div></li>"),c.push("select-list")),(void 0!==k.variable_helper&&k.variable_helper||void 0!==k.select_list&&!0===k.select_list)&&(M.push('<li><div data-action="wsf-variable-helper" data-option-meta-key="'+this.esc_attr(F)+'"'+this.tooltip(this.language("variable_helper"),"top-right")+">"+this.svg("hash")+"</div></li>"),c.push("variable-helper")),void 0===k.auto_map||h||(M.push('<li><div data-action="wsf-auto-map" data-option-meta-key="'+this.esc_attr(F)+'" data-object="'+this.esc_attr(e)+'" data-object-id="'+this.esc_attr(a)+'"'+this.tooltip(this.language("auto_map"),"top-right")+">"+this.svg("exchange")+"</div></li>"),c.push("auto-map")),void 0!==k.reload){var H=k.reload,X="";void 0!==H.action_id&&(X+=' data-action-id="'+this.esc_attr(H.action_id)+'"'),void 0!==H.action_id_meta_key&&(X+=' data-action-id-meta-key="'+this.esc_attr(H.action_id_meta_key)+'"'),void 0!==H.list_id_meta_key&&(X+=' data-list-id-meta-key="'+this.esc_attr(H.list_id_meta_key)+'"'),void 0!==H.list_sub_id_meta_key&&(X+=' data-list-sub-id-meta-key="'+this.esc_attr(H.list_sub_id_meta_key)+'"'),X+=' data-method="'+this.esc_attr(H.method)+'"',h&&(X+=' data-repeater-meta-key="'+this.esc_attr(o)+'"'),M.push('<li><span data-action="wsf-api-reload"'+X+' data-meta-key-for="'+this.esc_attr(F)+'"'+this.tooltip(this.language("action_api_reload"),"top-right")+">"+this.svg("reload")+"</span></li>"),c.push("options-action-reload")}var G="";if(M.length>0&&(G='<ul class="wsf-meta-key-options">'+M.join("")+"</ul>"),void 0!==k.options_default){var K=!1,B=k.options_default,V=t.WS_Form.meta_keys[B],Y=(q=void 0!==V.default&&V.default,this.get_object_meta_value(this.form,B,q));if(Y)switch((B=t.WS_Form.meta_keys[B]).type){case"select":if(void 0!==B.options){var Z=B.options;for(var Q in Z){if(Z.hasOwnProperty(Q))if("function"!=typeof Z[Q])Z[Q].value==Y&&(K=Z[Q].text)}}break;default:K=Y}S+='<option value="default"'+(mt="default"==T?" selected":"")+">"+this.language("default")+(!1!==K?" ("+K+")":"")+"</option>\n"}if(void 0!==k.options){M=k.options;var $=!1;switch(void 0!==k.options_framework_filter&&void 0!==this.framework[k.options_framework_filter]&&($=this.framework[k.options_framework_filter]),M){case"sections":if(void 0!==this.meta_key_options_cache.sections){M=t.extend(!0,[],this.meta_key_options_cache.sections);break}M=[];var tt=void 0!==k.section_filter_attribute&&k.section_filter_attribute;for(var et in this.section_data_cache)if(this.section_data_cache.hasOwnProperty(et)){var at=this.section_data_cache[et];switch(tt){case"section_repeatable":if(!this.get_object_meta_value(at,"section_repeatable",!1))continue}var it=at.label;M.push({value:at.id,text:it+" ("+this.language("id")+": "+at.id+")",type:at.type})}M.sort(function(t,e){return t.text<e.text?-1:t.text>e.text?1:0}),this.meta_key_options_cache.sections=t.extend(!0,[],M);break;case"fields":var st=void 0===k.fields_filter_mappable||k.fields_filter_mappable,ot="fields"+(st?"_mappable":"");if(void 0!==this.meta_key_options_cache[ot]){M=t.extend(!0,[],this.meta_key_options_cache[ot]);break}M=this.options_fields(st);this.meta_key_options_cache[ot]=t.extend(!0,[],M);break;case"data_source":if(void 0!==this.meta_key_options_cache.data_source){M=t.extend(!0,[],this.meta_key_options_cache.data_source);break}M=this.options_data_sources();this.meta_key_options_cache.data_source=t.extend(!0,[],M);break;case"action_api_populate":M=[];break;default:M=t.extend(!0,[],M)}void 0!==k.options_blank&&M.unshift({value:"",text:k.options_blank,disabled_never:!0});var rt=void 0!==k.fields_filter_type&&k.fields_filter_type,nt=void 0!==k.fields_filter_type_exclude&&k.fields_filter_type_exclude,dt=void 0!==k.fields_filter_attribute&&k.fields_filter_attribute,_t=void 0!==k.fields_filter_include_self&&k.fields_filter_include_self,lt=!1;for(var ct in M)if(M.hasOwnProperty(ct)&&"function"!=typeof M[ct]){var ft=M[ct];if(!1!==rt&&void 0!==ft.type){if(-1===rt.indexOf(ft.type))continue;if(!_t&&ft.value==a)continue}if(!1!==nt&&void 0!==ft.type){if(-1!==nt.indexOf(ft.type))continue;if(!_t&&ft.value==a)continue}if(!1!==dt&&void 0!==ft.type&&void 0!==t.WS_Form.field_type_cache[ft.type]){var ht=t.WS_Form.field_type_cache[ft.type];if(!dt.find(function(t){return void 0!==ht[t]&&ht[t]}))continue}var pt=ft.value;if(!1===$||-1!=$.indexOf(pt)){var ut=ft.text;null===T&&(T="");var mt=("object"==typeof T?-1!==T.indexOf(pt):T==pt)?" selected":"",vt=void 0!==ft.disabled&&ft.disabled?" disabled":"",gt=void 0!==ft.disabled_always&&ft.disabled_always?" data-disabled-always":"",bt=void 0!==ft.disabled_never&&ft.disabled_never?" data-disabled-never":"",wt=void 0!==ft.optgroup&&ft.optgroup;wt!==lt&&(!1!==lt&&(S+="</optgroup>"),S+='<optgroup label="'+this.esc_attr(wt)+'">',lt=wt),S+='<option value="'+this.esc_attr(pt)+'"'+mt+vt+gt+bt+">"+this.esc_html(ut)+"</option>\n",W[this.esc_html(pt)]=this.esc_html(ut)}}!1!==lt&&(S+="</optgroup>")}if("select_ajax"==P&&(P="select",k.select2=!0),void 0!==k.select2&&k.select2){A+=" data-wsf-select2";var yt=void 0!==k.select_ajax_method_search&&k.select_ajax_method_search,St=void 0!==k.select_ajax_method_cache&&k.select_ajax_method_cache,Wt=void 0!==k.select_ajax_placeholder&&k.select_ajax_placeholder;if(yt?(A+=' data-select-ajax-method-search="'+this.esc_attr(yt)+'"',A+=St?' data-select-ajax-method-cache="'+this.esc_attr(St)+'"':"",A+=Wt?' data-select-ajax-placeholder="'+this.esc_attr(Wt)+'"':"",T&&(A+=' data-select-ajax-id="'+this.esc_attr(T)+'"'),c.push("select2-ajax")):c.push("select2"),A+=void 0!==k.select2_tags&&k.select2_tags?' data-tags="true"':"",!St&&"object"==typeof T)for(var Ft in T)if(T.hasOwnProperty(Ft)&&"function"!=typeof T[Ft]){var kt=T[Ft];void 0===W[kt]&&(S+='<option value="'+this.esc_attr(kt)+'" selected>'+this.esc_html(kt)+"</option>\n",W[kt]=kt)}}if("select_number"==P){var jt=void 0!==k.minimum?k.minimum:1,xt=void 0!==k.maximum?k.maximum:100;"framework_column_count"==xt&&(xt=t.WS_Form.settings_plugin.framework_column_count-1);for(pt=jt;pt<=xt;pt++){mt=T==pt?" selected":"";S+='<option value="'+this.esc_attr(pt)+'"'+mt+">"+this.esc_html(pt)+"</option>\n"}P="select"}if(void 0!==k.mask_placeholder){var Ot=k.mask_placeholder;if("invalid_feedback"===F){R=i.type;Ot=void 0!==(zt=t.WS_Form.field_type_cache[R]).invalid_feedback?zt.invalid_feedback:Ot}A+=' data-placeholder="'+this.esc_attr(Ot)+'"',c.push("placeholders")}if(void 0!==k.placeholder&&(A+=' placeholder="'+this.esc_attr(k.placeholder)+'"'),void 0!==k.multiple&&(A+=" multiple"),void 0!==k.rows&&(A+=' rows="'+this.esc_attr(k.rows)+'"'),void 0!==k.data_change&&(A+=' data-change-event="'+this.esc_attr(k.data_change.event)+'"',A+=' data-change-action="'+this.esc_attr(k.data_change.action)+'"'),void 0!==k.fields_toggle&&(A+=" data-fields-toggle"),void 0!==k.min&&(A+=' min="'+parseFloat(k.min)+'"'),void 0!==k.max&&(A+=' max="'+parseFloat(k.max)+'"'),void 0!==k.step&&(A+=' step="'+parseFloat(k.step)+'"'),void 0===k.options_action_id&&void 0===k.options_action_id_meta_key||void 0===k.options_action_api_populate||(void 0!==k.options_action_id&&(A+=' data-options-action-id="'+this.esc_attr(k.options_action_id)+'"'),void 0!==k.options_action_id_meta_key&&(A+=' data-options-action-id-meta-key="'+this.esc_attr(k.options_action_id_meta_key)+'"'),void 0!==k.options_list_id_meta_key&&(A+=' data-options-list-id-meta-key="'+this.esc_attr(k.options_list_id_meta_key)+'"'),void 0!==k.options_list_sub_id_meta_key&&(A+=' data-options-list-sub-id-meta-key="'+this.esc_attr(k.options_list_sub_id_meta_key)+'"'),A+=' data-options-action-api-populate="'+this.esc_attr(k.options_action_api_populate)+'"',A+=' data-object="'+this.esc_attr(e)+'"',A+=' data-object-id="'+this.esc_attr(a)+'"',h&&(A+=' data-repeater-meta-key="'+this.esc_attr(o)+'"'),c.push("options-action")),O&&(A+=" required"),void 0!==k.attributes)for(var Ct in k.attributes)if(k.attributes.hasOwnProperty(Ct)){var Pt=k.attributes[Ct];A+=" "+Ct+'="'+this.esc_attr(Pt)+'"'}if(void 0!==k.column_toggle_meta_key&&void 0!==k.column_toggle_column_id&&(A+=' data-column-toggle-meta-key="'+this.esc_attr(k.column_toggle_meta_key)+'"',A+=' data-column-toggle-column-id="'+this.esc_attr(k.column_toggle_column_id)+'"',c.push("column-toggle")),h||this.object_meta_cache.push({meta_key:F,meta_key_type:P,meta_value:T}),void 0!==k.show_if_groups_group){R=i.type;var zt,qt=void 0!==(zt=t.WS_Form.field_type_cache[R]).data_source&&zt.data_source;if(void 0!==qt.id&&void 0!==t.WS_Form.meta_keys[qt.id]){var Tt=t.WS_Form.meta_keys[qt.id];(void 0!==Tt.groups_group&&Tt.groups_group)!==k.show_if_groups_group&&(P="hidden",T="")}}switch(P){case"checkbox":var It=G+'<input type="checkbox"'+A+("on"==T?" checked":"")+" />"+E+I;break;case"select":case"regex_filter":case"data_grid_field":It=G+E+"<select"+A+">"+S+"</select>"+I;break;case"text_editor":It=G+E+'<textarea data-text-editor="true"'+(A+=void 0!==k.css?' data-helper-css="'+this.esc_attr(k.css)+'"':"")+">"+this.esc_html(T,!0)+"</textarea>"+I;c.push("text-editor");break;case"html_editor":It=G+E+'<textarea data-html-editor="true"'+(A+=void 0!==k.mode?' data-html-editor-mode="'+this.esc_attr(k.mode)+'"':"")+">"+this.esc_html(T,!0)+"</textarea>"+I;c.push("html-editor");break;case"textarea":It=G+E+"<textarea"+A+">"+this.esc_html(T,!0)+"</textarea>"+I;break;case"number":It=G+E+'<input type="number"'+A+' value="'+this.esc_attr(T)+'" />'+I;c.push("number");break;case"range":It=G+E+'<input type="range"'+(A+=void 0!==k.range_value_mask?' data-range-value-mask="'+this.esc_attr(k.range_value_mask)+'"':"")+' value="'+this.esc_attr(T)+'" /><small id="wsf_'+this.esc_attr(F)+'_range_value"></small>'+I;c.push("range");break;case"password":It=G+E+'<input type="password"'+A+' value="'+this.esc_attr(T)+'" autocomplete="new-password" />'+I;break;case"email":It=G+E+'<input type="email"'+A+' value="'+this.esc_attr(T)+'" />'+I;break;case"tel":It=G+E+'<input type="tel"'+A+' value="'+this.esc_attr(T)+'" />'+I;break;case"url":It=G+E+'<input type="url"'+A+' value="'+this.esc_attr(T)+'" />'+I;break;case"datetime":It=G+E+'<input type="'+this.esc_attr(f)+'"'+A+' value="'+this.esc_attr(T)+'" />'+I;c.push("datetime");break;case"color":It=G+E+'<input type="color"'+A+' value="'+this.esc_attr(T)+'" />'+I;break;case"breakpoint_sizes":It='<div class="wsf-breakpoint-sizes" data-object="'+this.esc_attr(e)+'" data-id="'+this.esc_attr(a)+'" data-meta-key="'+this.esc_attr(F)+'"></div>';c.push("breakpoint-sizes");break;case"orientation_breakpoint_sizes":It='<div class="wsf-orientation-breakpoint-sizes" data-object="'+this.esc_attr(e)+'" data-id="'+this.esc_attr(a)+'" data-meta-key="'+this.esc_attr(F)+'"></div>';c.push("orientation-breakpoint-sizes");break;case"data_grid":It='<fieldset class="wsf-fieldset wsf-data-grid" data-object="'+this.esc_attr(e)+'" data-id="'+this.esc_attr(a)+'" data-meta-key="'+this.esc_attr(F)+'"></fieldset>';c.push("data-grid");break;case"field_select":It='<div class="wsf-field-selector"></div>';c.push("field-select");break;case"section_select":It='<div class="wsf-section-selector"></div>';c.push("section-select");break;case"form_history":It="";c.push("form-history");break;case"knowledgebase":It="";break;case"contact":It="";c.push("contact");break;case"repeater":It=G+E+'<div id="wsf_'+this.esc_attr(F)+'" class="wsf-repeater" data-object="'+this.esc_attr(e)+'" data-id="'+this.esc_attr(a)+'" data-meta-key="'+this.esc_attr(F)+'" data-meta-key-type="'+this.esc_attr(P)+'"></div>'+I;c.push("repeater");break;case"button":It='<button class="wsf-button wsf-button-full'+D+'" id="wsf_'+this.esc_attr(F)+'" data-object="'+this.esc_attr(e)+'" data-id="'+this.esc_attr(a)+'" data-meta-key="'+this.esc_attr(F)+'" data-meta-key-type="'+this.esc_attr(P)+'">'+this.esc_html(C)+"</button>";break;case"image":It=G+E+'<div class="wsf-field-inline"><input type="text"'+A+' value="'+this.esc_attr(T)+'" />';It+='<button class="wsf-button wsf-button-primary" data-for="wsf_'+this.esc_attr(F)+'">'+this.language("sidebar_button_image")+"</button></div>"+I,c.push("image");break;case"media":if(""!==T){try{var Et=JSON.parse(T)}catch(t){Et={id:0,filename:""}}var Dt=(Et.filename,Et.filename)}else Dt="";It=G+E+'<div class="wsf-field-inline"><input type="text" class="wsf-field wsf-field-small" value="'+this.esc_attr(Dt)+'" readonly /><input type="hidden"'+A+' value="'+this.esc_attr(T)+'" />';It+='<button class="wsf-button wsf-button-small" data-for="wsf_'+F+'">'+this.language("sidebar_button_media")+"</button></div>"+I,c.push("media");break;case"html":It='<div class="wsf-sidebar-html"'+A+">"+(void 0!==k.html?k.html:"")+"</div>";break;case"hidden":It='<input type="hidden"'+A+' value="'+this.esc_attr(T)+'" />';break;default:It=G+E+'<input type="text"'+A+' value="'+this.esc_attr(T)+'" />'+I}var At=void 0!==k.indent?" wsf-field-indent":"",Mt=void 0===k.field_wrapper||k.field_wrapper;if(n&&Mt)b+='<div class="wsf-field-wrapper'+(void 0!==k.class_wrapper?" "+k.class_wrapper:"")+At+'">'+It+"</div>\n";else b+=It+"\n"}}else this.error("error_meta_key",F)}if(void 0!==g.fieldsets){var Lt=this.sidebar_html(e,a,i,g,h,r,n,d,_,l+1,c,f);b+=Lt.html,c=c.concat(Lt.inits)}b+=r?"</fieldset>":"",1!=l||h||(b+="</div>",b+=this.comment_html(this.language("group")+" - "+g.label,!0)),w++}return{html_tabs:m,html:b,html_buttons:!1!==_?this.sidebar_buttons_html(_):"",inits:c}},t.WS_Form.prototype.options_fields=function(e){var a=[];for(var i in this.form.groups)if(this.form.groups.hasOwnProperty(i)){var s=this.form.groups[i];a.push({value:"group-"+s.id,text:s.label+" ("+this.language("id")+": "+s.id+")",type:"group",disabled:!0,disabled_always:!0});var o=s.sections;for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];a.push({value:"section-"+n.id,text:"- "+n.label+" ("+this.language("id")+": "+n.id+")",type:"section",disabled:!0,disabled_always:!0});var d=n.fields;for(var _ in d)if(d.hasOwnProperty(_)){var l=d[_],c=t.WS_Form.field_type_cache[l.type];if(e)if(!(c.mappable,c.mappable))continue;a.push({value:l.id,text:"-- "+l.label+" ("+this.language("id")+": "+l.id+")",type:l.type})}}}return a},t.WS_Form.prototype.options_data_sources=function(){var e=[];for(var a in t.WS_Form.data_sources)if(t.WS_Form.data_sources.hasOwnProperty(a)){var i=t.WS_Form.data_sources[a];void 0!==i.label&&e.push({value:a,text:i.label})}return e},t.WS_Form.prototype.sidebar_cache_clear=function(t){this.object_meta_cache=[],this.sidebar_conditions=[],t.removeAttr("data-sidebar-conditions-init"),this.meta_key_options_cache=[]},t.WS_Form.prototype.sidebar_buttons_html=function(t){if(void 0!==t&&!0!==t||(t=[{class:"wsf-button-primary",action:"wsf-sidebar-save-close",label:this.language("save_and_close")},{class:"wsf-button-primary",action:"wsf-sidebar-save",label:this.language("save")},{class:"",action:"wsf-sidebar-cancel",label:this.language("cancel")}]),!1===t)return"";var e='<div class="wsf-sidebar-footer">';for(var a in e+='<ul class="wsf-list-inline">',t)if(t.hasOwnProperty(a)){var i=t[a];void 0===i.class&&(i.class=""),void 0!==i.action&&void 0!==i.label&&(void 0===i.disabled&&(i.disabled=!1),void 0===i.right&&(i.right=!1),e+="<li"+(i.right?' class="wsf-button-right"':"")+'><button class="wsf-button wsf-button-small'+(""!=i.class?" "+this.esc_attr(i.class):"")+'" data-action="'+this.esc_attr(i.action)+'"'+(void 0!==i.id?' data-id="'+this.esc_attr(i.id)+'"':"")+(i.disabled?" disabled":"")+">"+i.label+"</button></li>")}return e+="</ul>",e+="</div>"},t.WS_Form.prototype.sidebar_inits=function(e,a,i,s){if("object"!=typeof e&&(e=[]),e.length){void 0===i&&(i=a),void 0===s&&(s=[]);var o="basic"==t.WS_Form.settings_plugin.mode;-1!=e.indexOf("tabs")&&this.sidebar_tabs_init(a,i),-1!=e.indexOf("text-editor")&&this.sidebar_tinymce_init(i),-1!=e.indexOf("html-editor")&&this.sidebar_html_editor_init(i),-1!=e.indexOf("repeater")&&this.sidebar_repeater_init(i),-1!=e.indexOf("data-grid")&&this.sidebar_data_grids_init(a),-1!=e.indexOf("field-select")&&this.sidebar_field_select_init(a),-1!=e.indexOf("section-select")&&this.sidebar_section_select_init(a),-1!=e.indexOf("form-history")&&this.sidebar_form_history_init(),-1!=e.indexOf("breakpoint-sizes")&&this.sidebar_breakpoint_sizes(a),-1!=e.indexOf("orientation-breakpoint-sizes")&&this.sidebar_orientation_breakpoint_sizes(a),-1!=e.indexOf("select2")&&this.sidebar_select2(a),-1!=e.indexOf("select2-ajax")&&this.sidebar_select2_ajax(a),-1!=e.indexOf("range")&&this.sidebar_range_init(i),-1!=e.indexOf("number")&&o&&this.sidebar_number_init(i),-1!=e.indexOf("placeholders")&&this.sidebar_placeholders_init(a),-1!=e.indexOf("select-list")&&this.sidebar_select_list(a),-1!=e.indexOf("variable-helper")&&this.sidebar_variable_helper(a),-1!=e.indexOf("knowledgebase")&&this.sidebar_knowledgebase(a,i),-1!=e.indexOf("required-setting")&&this.sidebar_required_setting(s,a,i),-1!=e.indexOf("image")&&this.sidebar_image(i),-1!=e.indexOf("media")&&this.sidebar_media(i),-1!=e.indexOf("column-toggle")&&this.sidebar_column_toggle(i),-1!=e.indexOf("options-action")?(-1!=e.indexOf("conditions")&&this.sidebar_conditions_init(a),this.sidebar_option_action_init(i,function(){-1!=e.indexOf("options-action-reload")&&t.WS_Form.this.sidebar_api_reload_init(i),-1!=e.indexOf("repeater")&&t.WS_Form.this.sidebar_repeater_init(i),t.WS_Form.this.sidebar_condition_process(a,a,!0)})):-1!=e.indexOf("conditions")&&t.WS_Form.this.sidebar_conditions_init(a)}},t.WS_Form.prototype.sidebar_title_init=function(e,a,i,s){switch(e){case"form":var o=this.language("sidebar_title_"+e),r=this.svg(e),n="",d=this.get_plugin_website_url("/knowledgebase/form-settings/","sidebar"),_='<a class="wsf-kb-url" href="'+this.esc_url(d)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"bottom-center")+' tabindex="-1">'+this.svg("question-circle")+"</a>",l=t.WS_Form.settings_plugin.helper_field_id?'<code data-action="wsf-clipboard"'+this.tooltip(this.language("clipboard"),"left")+">["+ws_form_settings.shortcode+' id="'+this.form_id+'"]</code>':"";break;case"group":o=this.language("sidebar_title_"+e),r=this.svg(e),n="",d=this.get_plugin_website_url("/knowledgebase/tabs/","sidebar"),_='<a class="wsf-kb-url" href="'+this.esc_url(d)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"bottom-center")+' tabindex="-1">'+this.svg("question-circle")+"</a>",l=t.WS_Form.settings_plugin.helper_field_id?"<code>"+this.language("id")+": "+a+"</code>":"";break;case"section":o=this.language("sidebar_title_"+e),r=this.svg(e),n="",d=this.get_plugin_website_url("/knowledgebase/sections/","sidebar"),_='<a class="wsf-kb-url" href="'+this.esc_url(d)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"bottom-center")+' tabindex="-1">'+this.svg("question-circle")+"</a>",l=t.WS_Form.settings_plugin.helper_field_id?"<code>"+this.language("id")+": "+a+"</code>":"";break;case"field":o=i.label,r=void 0!==i.icon?i.icon:"";if(void 0!==i.kb_url)d=this.get_plugin_website_url(i.kb_url,"sidebar"),_='<a class="wsf-kb-url" href="'+this.esc_url(d)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"bottom-center")+' tabindex="-1">'+this.svg("question-circle")+"</a>";if(void 0!==i.compatibility_url&&t.WS_Form.settings_plugin.helper_compatibility)n='<a class="wsf-compatibility" href="'+this.esc_url(i.compatibility_url)+'" target="_blank"'+this.tooltip(this.language("field_compatibility"),"bottom-center")+' tabindex="-1">'+this.svg("markup-circle")+"</a>";l=void 0!==i.admin_hide_id&&i.admin_hide_id?"":t.WS_Form.settings_plugin.helper_field_id?'<code data-action="wsf-clipboard"'+this.tooltip(this.language("clipboard"),"left")+">#field("+this.esc_html(a)+")</code>":"";break;default:o=this.language("sidebar_title_"+e),r=this.svg(e),n="",l=""}s.html(this.sidebar_title(r,o,n,_,l,!0)),this.sidebar_expand_contract_init(),this.clipboard(s)},t.WS_Form.prototype.sidebar_label_init=function(e,a,i,s,o){t('[name="label"]',o).on("input",function(){if(!1===t.WS_Form.this.object_data_scratch)return!1;var o=t(this).val();switch(o=o.trim(),i){case"field":var r=e.label_default;break;default:r=t.WS_Form.this.get_label_default(i)}switch(t.WS_Form.this.object_data_scratch.label=""==o?r:o,i){case"form":t('[data-action="wsf-form-label"]').val(t.WS_Form.this.object_data_scratch.label);break;case"group":var n=a.attr("data-id");t('.wsf-group-tab[data-id="'+t.WS_Form.this.esc_selector(n)+'"] a input').val(t.WS_Form.this.object_data_scratch.label).trigger("change");break;case"section":var d=a.attr("data-id");t('.wsf-section[data-id="'+t.WS_Form.this.esc_selector(d)+'"] .wsf-section-label input').val(t.WS_Form.this.object_data_scratch.label),t.WS_Form.this.sidebar_placeholders_init(s);break;case"field":t.WS_Form.this.field_render(a,t.WS_Form.this.object_data_scratch),t.WS_Form.this.sidebar_placeholders_init(s)}})},t.WS_Form.prototype.sidebar_change_event_init=function(e,a,i){t("[data-change-event]",i).each(function(){var i=t(this).attr("data-change-event");t(this).on(i,function(){var i=t(this).attr("data-change-action"),s=e.attr("data-id"),o=t(this).attr("data-meta-key");switch(t.WS_Form.this.object_data_update_by_meta_key(a,t.WS_Form.this.object_data_scratch,o),o){case"recaptcha_recaptcha_type":case"hcaptcha_type":"invisible"==t(this).val()&&(t.WS_Form.this.column_classes_render(e,t.WS_Form.this.object_data_scratch,!1),t.WS_Form.this.breakpoint_reset_process(t.WS_Form.this.object_data_scratch),t.WS_Form.this.column_classes_render(e,t.WS_Form.this.object_data_scratch))}switch(a){case"group":var r=t.extend(!0,{},t.WS_Form.this.group_data_cache[s]);t.WS_Form.this.group_data_cache[s]=t.WS_Form.this.object_data_scratch,t.WS_Form.this.group_render(e),e.addClass("wsf-editing"),t.WS_Form.this.group_data_cache[s]=r;break;case"section":r=t.extend(!0,{},t.WS_Form.this.section_data_cache[s]);t.WS_Form.this.section_data_cache[s]=t.WS_Form.this.object_data_scratch,t.WS_Form.this.section_render(e),e.addClass("wsf-editing"),t.WS_Form.this.section_data_cache[s]=r;break;case"field":r=t.extend(!0,{},t.WS_Form.this.field_data_cache[s]);t.WS_Form.this.field_data_cache[s]=t.WS_Form.this.object_data_scratch,t.WS_Form.this.field_render(e),e.addClass("wsf-editing"),t.WS_Form.this.field_data_cache[s]=r}"reload"==i&&(t.WS_Form.this.object_save(e,!1),e.removeClass("wsf-editing"),t.WS_Form.this.object_edit(e,!0))})})},t.WS_Form.prototype.sidebar_image=function(e){var a,i;t('input[data-meta-key-type="image"]',e).each(function(){i=t(this).closest(".wsf-field-inline"),t("button",i).on("click",function(){i=t(this).closest(".wsf-field-inline"),a?a.open():((a=wp.media.frames.file_frame=wp.media({title:"Select image",button:{text:"Use this image"},multiple:!1})).on("select",function(){var e=a.state().get("selection").first().toJSON();t("input",i).val(e.url)}),a.open())})})},t.WS_Form.prototype.sidebar_media=function(e){var a,i;t('input[data-meta-key-type="media"]',e).each(function(){t(this).attr("id");i=t(this).closest(".wsf-field-inline"),t("button",i).on("click",function(){i=t(this).closest(".wsf-field-inline"),a?a.open():((a=wp.media.frames.file_frame=wp.media({title:"Select media",button:{text:"Use this media"},multiple:!1})).on("select",function(){var e=a.state().get("selection").first().toJSON(),s=JSON.stringify({id:e.id,filename:e.filename});t('input[type="hidden"]',i).val(s),t('input[type="text"]',i).val(e.filename)}),a.open())})})},t.WS_Form.prototype.sidebar_column_toggle=function(e){e.hasClass("wsf-sidebar")||(e=e.closest(".wsf-sidebar"));var a=this;t("input[data-column-toggle-meta-key]",e).each(function(){a.sidebar_column_toggle_process(t(this),e),t(this).attr("data-column-toggle-meta-key-init")||t(this).on("change",function(){a.sidebar_column_toggle_process(t(this),e)}).attr("data-column-toggle-meta-key-init","")})},t.WS_Form.prototype.sidebar_column_toggle_process=function(e,a){var i=e.attr("data-column-toggle-meta-key"),s=t('[data-meta-key="'+this.esc_selector(i)+'"]',a),o=e.attr("data-column-toggle-column-id"),r=t('[data-id="'+this.esc_selector(o)+'"]',s);e.is(":checked")?r.css({display:"table-cell"}):r.hide()},t.WS_Form.prototype.sidebar_required_setting=function(e,a){t("[data-required-setting]",a).on("change keyup input",function(){t.WS_Form.this.sidebar_required_setting_process(e,a)}),t.WS_Form.this.sidebar_required_setting_process(e,a)},t.WS_Form.prototype.sidebar_required_setting_process=function(e,a,i){t("[data-required-setting]",i).each(function(){var e=t(".wsf-required-setting",t(this).closest(".wsf-field-wrapper"));""==t(this).val()?(t(this).addClass("wsf-error"),e.show()):(t(this).removeClass("wsf-error"),e.hide())})},t.WS_Form.prototype.sidebar_knowledgebase=function(e,a){var i=t("#wsf-form-knowledgebase .wsf-fieldset",a);if(i.attr("data-loaded"))return!0;var s="l="+encodeURIComponent(ws_form_settings.locale_user)+"&e="+encodeURIComponent(ws_form_settings.edition)+"&v="+encodeURIComponent(ws_form_settings.version),o='<div class="wsf-field-wrapper">';o+='<label class="wsf-label" for="wsf-kb-search-keyword">'+this.language("knowledgebase_search_label")+"</label>",o+='<div class="wsf-field-inline">',o+='<input type="text" id="wsf-kb-search-keyword" class="wsf-field" value="" placeholder="'+this.language("knowledgebase_search_placeholder")+'" />',o+='<button class="wsf-button wsf-button-primary" data-action="wsf-kb-search">'+this.language("knowledgebase_search_button")+"</button>",o+="</div>",o+="</div>",o+='<div class="wsf-field-wrapper">',o+='<p><a href="https://wsform.com/knowledgebase/" target="_blank">'+this.language("knowledgebase_view_all")+"</a></p>",o+="</div>",o+='<div class="wsf-field-wrapper">',o+='<div id="wsf-kb-content"></div>',o+="</div>",o+='<link rel="stylesheet" href="https://cdn.wsform.com/plugin-support/css/icons.css?'+s+'">',i.html(o),t.get("https://wsform.com/plugin-support/knowledgebase_content.php?"+s,function(e){t("#wsf-kb-content").html(e),i.attr("data-loaded","true")}),t('[data-action="wsf-kb-search"]').on("click",function(){t.WS_Form.this.sidebar_knowledgebase_search()}),t("#wsf-kb-search-keyword").on("keydown",function(e){13===(e.keyCode||e.which)&&t.WS_Form.this.sidebar_knowledgebase_search()});var r='<form id="wsf-contact-form">'+(r=t("#wsf-form-contact").html())+"</form>";t("#wsf-form-contact").html(r),t.getScript("https://wsform.com/plugin-support/js/support_search.js",function(){new t.WS_Form_Support_Search({obj_input:t("#wsf_contact_inquiry"),obj_output:t("#wsf_contact_support_search_results"),results_class:"notice notice-info",results_url_suffix:"?utm_source=ws_form&utm_medium=sidebar&utm_campaign=support_search"})}),t("#wsf-contact-form").on("submit",function(t){return window.open("https://wordpress.org/support/plugin/ws-form/"),!1})},t.WS_Form.prototype.sidebar_knowledgebase_search=function(){var e=t("#wsf-kb-search-keyword").val();""!=e&&(e=e.trim(),t.get("https://wsform.com/plugin-support/knowledgebase_search.php?l="+encodeURIComponent(ws_form_settings.locale_user)+"&e="+encodeURIComponent(ws_form_settings.edition)+"&v="+encodeURIComponent(ws_form_settings.version)+"&k="+encodeURIComponent(e),function(e){t("#wsf-kb-content").html(e)}))},t.WS_Form.prototype.sidebar_conversational_preview=function(e,a){t.WS_Form.settings_plugin.helper_live_preview&&t('[data-action="wsf-conversational-preview"]',a).on("click",function(e){t.WS_Form.this.form_preview(e,t(this))})},t.WS_Form.prototype.sidebar_auto_map=function(e){t('[data-action="wsf-auto-map"]',e).on("click",function(){var a=t(this);a.addClass("wsf-api-method-calling");var i=t(this).attr("data-option-meta-key"),s=t(this).attr("data-object"),o=t(this).attr("data-object-id");if(void 0===t.WS_Form.meta_keys[i])return!1;if(void 0===(m=t.WS_Form.meta_keys[i]).type)return!1;if("repeater"!==m.type)return!1;if(void 0===m.meta_keys)return!1;var r=m.meta_keys;if(2!==r.length)return!1;var n=!1,d=!1,_=!1,l=!1,c=!1,f=!1,h=!1,p="list_fields_fetch";for(var u in r)if(r.hasOwnProperty(u)){var m,v=r[u];if(void 0===t.WS_Form.meta_keys[v])return!1;if(void 0===(m=t.WS_Form.meta_keys[v]).type)return!1;if("select"!=m.type)return!1;if(void 0===m.options)return!1;switch(m.options){case"fields":d=void 0!==m.key?m.key:v,n=u;break;case"action_api_populate":l=u,_=v,f=m.options_list_id_meta_key,h=m.options_list_sub_id_meta_key,c=void 0!==m.options_action_id_meta_key?t('[data-meta-key="'+t.WS_Form.this.esc_selector(m.options_action_id_meta_key)+'"]').val():m.options_action_id,p=void 0!==m.options_action_api_populate?m.options_action_api_populate:"list_fields_fetch"}}if(!1===n)return!1;if(!1===l)return!1;var g=t('[data-meta-key="'+t.WS_Form.this.esc_selector(f)+'"]').val(),b=t('[data-meta-key="'+t.WS_Form.this.esc_selector(h)+'"]').val(),w=t.WS_Form.this.action_api_method_path(c,p,g,b);t.WS_Form.this.options_action_cache_clear(w),t.WS_Form.this.sidebar_lock();var y=[];t.WS_Form.this.api_call(w,"GET",!1,function(r){if(void 0===r.data)return!1;for(var n in r.data)if(r.data.hasOwnProperty(n)){var l=r.data[n];y.push({id:l.id,label:l.label})}if(0==y.length)return t.WS_Form.error("error_auto_map_api_fields"),!1;var c=[];for(var f in y)if(y.hasOwnProperty(f)){var h=y[f],p=h.label,u=!1,m=0;for(var v in t.WS_Form.this.field_data_cache)if(t.WS_Form.this.field_data_cache.hasOwnProperty(v)){var g=t.WS_Form.this.field_data_cache[v].label,b=t.WS_Form.this.score(String(g),String(p));(b+=t.WS_Form.this.score(String(p),String(g)))>m&&(m=b,u=v)}if(m>0){var w={};w[d]=u,w[_]=h.id,c.push(w)}}if(c.length>0){t.WS_Form.this.get_object_data(s,o,!0).meta[i]=c;var S=e.closest(".wsf-sidebar-inner");S.length||(S=t(".wsf-sidebar-inner",e)),t.WS_Form.this.sidebar_inits(["options-action","repeater"],S)}a.removeClass("wsf-api-method-calling"),t.WS_Form.this.sidebar_unlock()},function(){t.WS_Form.this.sidebar_unlock()},!0)})},t.WS_Form.prototype.sidebar_variable_helper=function(e){t("#wsf-sidebars").on("click",'[data-action="wsf-variable-helper"]',function(){t.WS_Form.this.variable_helper_modal_open(!!t(this).attr("data-option-meta-key")&&t('[data-meta-key="'+t(this).attr("data-option-meta-key")+'"]',t(this).closest(".wsf-field-wrapper")))})},t.WS_Form.prototype.sidebar_select_list=function(e){t('[data-action="wsf-select-list"]').on("click",function(){var e=t(this).attr("data-option-meta-key"),a=t(this).closest(".wsf-field-wrapper"),i=t(this).hasClass("wsf-select-list-open");if(t(".wsf-select-list",t("#wsf-sidebars")).remove(),t(".wsf-select-list-open").removeClass("wsf-select-list-open").attr("autocomplete",!1),!i){t(this).addClass("wsf-select-list-open").attr("autocomplete","off");var s=void 0!==t.WS_Form.meta_keys[e].select_list_heading&&t.WS_Form.meta_keys[e].select_list_heading;t.WS_Form.this.sidebar_select_list_process(a,t.WS_Form.meta_keys[e].select_list,e,s)}})},t.WS_Form.prototype.get_select_options_field=function(e){void 0!==e&&(e=!1);var a=[];for(var i in t.WS_Form.this.form.groups)if(t.WS_Form.this.form.groups.hasOwnProperty(i)){var s=t.WS_Form.this.form.groups[i];for(var o in s.sections)if(s.sections.hasOwnProperty(o)){var r=s.sections[o];for(var n in r.fields)if(r.fields.hasOwnProperty(n)){var d=r.fields[n],_=t.WS_Form.field_type_cache[d.type],l=(_.value_out,_.value_out),c=!e||(_.calc_out,_.calc_out);l&&c&&a.push({text:d.label+" ("+this.language("id")+": "+d.id+")",value:"#field("+d.id+")",group:t.WS_Form.this.language("field")})}}}return a},t.WS_Form.prototype.sidebar_select_list_process=function(e,a,i,s){var o=this;void 0===s&&(s=!1);var r='<div class="wsf-select-list"><table>';!1!==s&&(r+="<thead><tr><th>"+s+"</th></tr></thead>"),r+="<tbody>";var n=!1;for(var d in a)if(a.hasOwnProperty(d)){var _=a[d];if(void 0!==_.group_id){var l=_.group_id;l!==n&&(r+="<tr><th>"+_.group_label+"</th></tr>",n=l)}r+='<tr data-action="wsf-list-item-insert" data-action-html="'+t.WS_Form.this.esc_attr(_.value)+'"><td>'+t.WS_Form.this.esc_html(_.text)+"</td></tr>"}r+="</tbody></table></div>";var c=t('[data-meta-key="'+this.esc_selector(i)+'"]').closest(".wsf-field-wrapper"),f=t(".wsf-helper",c);f.length?t(r).insertBefore(f):t(r).insertAfter(t('[data-meta-key="'+this.esc_selector(i)+'"]')),t.WS_Form.this.loader_off(),t('[data-action="wsf-list-item-insert"]').on("click",function(e){var a=t(this).attr("data-action-html");t.WS_Form.this.input_insert_text(t('[data-meta-key="'+o.esc_selector(i)+'"]'),a)})},t.WS_Form.prototype.sidebar_api_reload_init=function(e){this.api_reload_init(e,function(e,a,i){var s=e.closest(".wsf-sidebar-inner");t.WS_Form.this.sidebar_inits(["options-action","repeater"],s),t.WS_Form.this.sidebar_unlock()},null,!0)},t.WS_Form.prototype.sidebar_option_action_init=function(e,a){this.options_action_objects=t("[data-options-action-api-populate]",e).toArray(),this.sidebar_option_action_process(a)},t.WS_Form.prototype.sidebar_option_action_process=function(e){if(0==this.options_action_objects.length)return e(),!0;var a=t(this.options_action_objects.shift()),i=a.attr("data-options-action-id");if(null==i){var s=a.attr("data-options-action-id-meta-key");null!=s&&(i=t('[data-meta-key="'+this.esc_selector(s)+'"]',t("#wsf-sidebars")).val())}var o=a.attr("data-options-action-api-populate"),r=a.attr("data-options-list-id-meta-key"),n=null!=r&&t('[data-meta-key="'+this.esc_selector(r)+'"]',t("#wsf-sidebars")).val(),d=a.attr("data-options-list-sub-id-meta-key"),_=null!=d&&t('[data-meta-key="'+this.esc_selector(d)+'"]',t("#wsf-sidebars")).val();if(null!=d&&!_)return this.sidebar_option_action_process(e);var l=t.WS_Form.this.action_api_method_path(i,o,n,_);if(!1===l)return this.sidebar_option_action_process(e);var c=a.attr("data-object"),f=a.attr("data-object-id"),h=t.WS_Form.this.get_object_data(c,f,!0),p=a.attr("data-meta-key");if(!1===(void 0!==t.WS_Form.meta_keys[p]&&t.WS_Form.meta_keys[p]))return this.sidebar_option_action_process(e);var u=a.attr("data-repeater-meta-key");if(void 0===u)var m=t.WS_Form.this.get_object_meta_value(h,p,[],!0);else{var v=a.closest("tr").index(),g=t.WS_Form.this.get_object_meta_value(h,u,[],!0),b=void 0!==g[v]?g[v]:[];m=void 0!==b[p]?b[p]:""}if(void 0!==this.options_action_cache[l]){var w=this.options_action_cache[l];return this.sidebar_option_action_process_render(a,w,m,e)}t.WS_Form.this.sidebar_lock(),t.WS_Form.this.api_call(l,"GET",!1,function(i){var s=[];if(void 0!==i.data){var o=i.data;for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];if(null!==n){var d=n.label;void 0!==n.required&&n.required&&(d+=" *"),void 0!==n.no_map&&n.no_map||s.push({value:n.id,text:d})}}}t.WS_Form.this.options_action_cache[l]=s;var _=t.WS_Form.this.sidebar_option_action_process_render(a,s,m,e);return t.WS_Form.this.sidebar_unlock(),_},function(){var a=t.WS_Form.this.sidebar_option_action_process(e);return t.WS_Form.this.sidebar_unlock(),a},!0)},t.WS_Form.prototype.sidebar_lock=function(){if(0===this.sidebar_lock_count){this.loader_on();var e=t("#wsf-sidebars .wsf-sidebar-open");e.addClass("wsf-sidebar-locked"),t("select[data-options-action-id-meta-key], select[data-options-action-id], .wsf-sidebar-footer button",e).prop("disabled",!0).attr("data-lock-disabled","")}this.sidebar_lock_count++},t.WS_Form.prototype.sidebar_unlock=function(){if(this.sidebar_lock_count--,this.sidebar_lock_count<0&&(this.sidebar_lock_count=0),0===this.sidebar_lock_count){this.loader_off();var e=t("#wsf-sidebars .wsf-sidebar-open");e.removeClass("wsf-sidebar-locked"),t("[data-lock-disabled]",e).prop("disabled",!1).removeAttr("data-lock-disabled")}},t.WS_Form.prototype.sidebar_option_action_process_render=function(e,a,i,s){!1===i&&(i="");var o="",r=e.attr("data-meta-key");if(void 0===t.WS_Form.meta_keys[r])return this.sidebar_option_action_process(s);var n=t.WS_Form.meta_keys[r];for(var d in void 0!==n.options_blank&&(o+='<option value="">'+this.esc_html(n.options_blank)+"</option>"),a)if(a.hasOwnProperty(d)&&"function"!=typeof a[d]){var _=a[d];o+='<option value="'+this.esc_attr(_.value)+'"'+(i.toString()===_.value.toString()?" selected":"")+">"+this.esc_html(_.text)+"</option>"}return e.html(o),this.sidebar_option_action_process(s)},t.WS_Form.prototype.sidebar_repeater_init=function(e){t(".wsf-repeater",e).each(function(){t.WS_Form.this.sidebar_repeater_render(t(this))})},t.WS_Form.prototype.sidebar_repeater_render=function(e){var a=this.sidebar_repeater_get(e),i=this.sidebar_repeater_html(a);if(e.html(i.html),this.sidebar_inits(i.inits,e),!1!==a.meta_keys_unique)for(var s in a.meta_keys_unique)if(a.meta_keys_unique.hasOwnProperty(s)){var o=a.meta_keys_unique[s],r=t.WS_Form.meta_keys[o];void 0!==r.key&&(o=r.key),this.sidebar_repeater_options_unique(o,e),t('select[data-meta-key="'+this.esc_selector(o)+'"]',e).on("change",function(){t.WS_Form.this.sidebar_repeater_options_unique(o,e)})}t('[data-action="wsf-repeater-row-add"] div',e).on("click",function(){var e=t(this).closest(".wsf-repeater"),a=e.attr("data-object"),i=e.attr("data-id"),s=t.WS_Form.this.get_object_data(a,i,!0),o=e.attr("data-meta-key");t.WS_Form.this.object_data_update_by_meta_key(a,s,o);var r=t.WS_Form.this.sidebar_repeater_get(e),n=t.WS_Form.this.sidebar_repeater_row_new(r.meta_keys);r.data.push(n),t.WS_Form.this.set_object_meta_value(r.object_data,r.meta_key,r.data),t.WS_Form.this.sidebar_repeater_render(e)}),t('[data-action="wsf-repeater-row-delete"]',e).on("click",function(){var e=t(this).closest(".wsf-repeater"),a=e.attr("data-object"),i=e.attr("data-id"),s=t.WS_Form.this.get_object_data(a,i,!0),o=e.attr("data-meta-key"),r=(t.WS_Form.this.sidebar_repeater_get(e),t(this).closest("tr"));r.index();r.remove(),t.WS_Form.this.object_data_update_by_meta_key(a,s,o),t.WS_Form.this.sidebar_repeater_render(e)}),t("table.wsf-repeater-table",e).sortable({items:"tbody tr",containment:"parent",cursor:"move",tolerance:"pointer",handle:'[data-action="wsf-repeater-row-sort"]',axis:"y",cancel:".wsf-ui-cancel, input[type=text]:not([readonly])",start:function(a,i){t("table.wsf-repeater-table",e).sortable("refreshPositions"),t.WS_Form.repeater_index_dragged_from=i.helper.index()},stop:function(e,a){var i=t.WS_Form.repeater_index_dragged_from,s=a.item.index(),o=a.item.closest("[data-meta-key]").attr("data-meta-key");if(o&&void 0!==t.WS_Form.this.object_data_scratch.meta[o]){var r=t.WS_Form.this.object_data_scratch.meta[o];"object"==typeof r&&r.splice(s,0,r.splice(i,1)[0])}}})},t.WS_Form.prototype.sidebar_repeater_options_unique=function(e,a){var i=this,s=[];for(var o in t('select[data-meta-key="'+this.esc_selector(e)+'"]',a).each(function(){var e=t(this).val();""!=e&&s.push(e),t("option:not([data-disabled-always])",t(this)).prop("disabled",!1)}),s)s.hasOwnProperty(o)&&"string"==typeof s[o]&&(s[o]=this.replace_all(s[o],"\\","\\\\"));t('select[data-meta-key="'+this.esc_selector(e)+'"]',a).each(function(){var e=t.extend(!0,[],s),a=t(this).val();"string"==typeof a&&(a=t.WS_Form.this.replace_all(a,"\\","\\\\"));var o=e.indexOf(a);for(var r in o>-1&&e.splice(o,1),e)e.hasOwnProperty(r)&&t('option[value="'+i.esc_selector(e[r])+'"]:not([data-disabled-never])',t(this)).prop("disabled",!0)})},t.WS_Form.prototype.sidebar_repeater_row_new=function(e){var a={};for(var i in e)if(e.hasOwnProperty(i)){var s=e[i];if(void 0===t.WS_Form.meta_keys[s])return!1;var o=void 0!==t.WS_Form.meta_keys[s].default?t.WS_Form.meta_keys[s].default:"";void 0!==t.WS_Form.meta_keys[s].key&&(s=t.WS_Form.meta_keys[s].key),a[s]=o}return a},t.WS_Form.prototype.sidebar_repeater_get=function(e){var a=e.attr("data-meta-key");if(void 0===t.WS_Form.meta_keys[a])return!1;var i=t.WS_Form.meta_keys[a];if("object"!=typeof i.meta_keys)return!1;var s=i.meta_keys,o=void 0!==i.columns&&i.columns,r=void 0!==i.meta_keys_unique&&i.meta_keys_unique,n=e.attr("data-object"),d=e.attr("data-id"),_=t.WS_Form.this.get_object_data(n,d,!0),l=t.WS_Form.this.get_object_meta_value(_,a,[],!0);return"object"!=typeof l&&(l=[]),{object:n,object_id:d,meta_key:a,meta_keys:s,meta_keys_unique:r,object_data:_,data:l,columns:o}},t.WS_Form.prototype.sidebar_repeater_html=function(e){var a=[],i='<table class="wsf-repeater-table"><thead><tr>';for(var s in i+="<th data-icon></th>",e.meta_keys)if(e.meta_keys.hasOwnProperty(s)){var o=e.meta_keys[s];if(void 0===t.WS_Form.meta_keys[o])return!1;var r=t.WS_Form.meta_keys[o],n=void 0!==r.column_id?' data-id="'+this.esc_attr(r.column_id)+'"':"";e.columns&&e.columns[s]?i+="<th"+n+">"+this.esc_html(e.columns[s])+"</th>":i+="<th"+n+">"+this.esc_html(r.label)+"</th>"}for(var d in i+="<th data-icon></th>",i+="</tr></thead><tbody>",e.data)if(e.data.hasOwnProperty(d)){var _=e.data[d],l=this.sidebar_repeater_row_html(e,_,e.meta_key);i+=l.html,a=a.concat(l.inits)}return i+="</tbody></table>",i+='<div data-action="wsf-repeater-row-add"><div'+this.tooltip(this.language("repeater_row_add"),"left")+">"+this.svg("plus-circle")+"</div></div>",a.push("column-toggle"),{html:i,inits:a}},t.WS_Form.prototype.sidebar_repeater_row_html=function(e,a,i){var s=[],o="<tr>";o+='<td data-icon><div data-action="wsf-repeater-row-sort"'+this.tooltip(this.language("repeater_row_sort"),"top-left")+">"+this.svg("sort")+"</div></td>";var r=[];for(var n in r.meta=a,e.meta_keys)if(e.meta_keys.hasOwnProperty(n)){var d=e.meta_keys[n],_=t.WS_Form.meta_keys[d],l=void 0!==_.column_id?' data-id="'+this.esc_attr(_.column_id)+'"':"",c={fieldsets:{}};c.fieldsets[e.object_id]={meta_keys:[d]};var f=this.sidebar_html(e.object,e.object_id,r,c,i);o+="<td"+l+">"+f.html+"</td>",s=s.concat(f.inits)}return o+='<td data-icon><div data-action="wsf-repeater-row-delete"'+this.tooltip(this.language("repeater_row_delete"),"top-right")+">"+this.svg("delete-circle")+"</div></td>",{html:o+="</tr>",inits:s}},t.WS_Form.prototype.sidebar_range_init=function(e){t('input[type="range"]',e).each(function(){t(this).on("input",function(){t.WS_Form.this.sidebar_range_update(e,t(this))}),t.WS_Form.this.sidebar_range_update(e,t(this))})},t.WS_Form.prototype.sidebar_range_update=function(e,a){var i=a.val(),s=a.attr("data-meta-key"),o=void 0!==a.attr("data-range-value-mask")?a.attr("data-range-value-mask"):"#value",r={value:i,value_plural:1==i?"":"s"},n=this.mask_parse(o,r);t("#wsf_"+s+"_range_value",e).html(n)},t.WS_Form.prototype.sidebar_number_init=function(e){var a=t('input[type="number"][data-meta-key="default_value"]',e).first();if(!a.length)return!1;t('[data-meta-key="min"],[data-meta-key="max"],[data-meta-key="step"]',e).on("change",function(){t.WS_Form.this.sidebar_default_value_attributes(e,a,"number")}),t.WS_Form.this.sidebar_default_value_attributes(e,a,"number")},t.WS_Form.prototype.sidebar_default_value_attributes=function(e,a,i){var s=a.val(),o=t('[data-meta-key="min"]',e).first(),r=t('[data-meta-key="max"]',e).first(),n=t('[data-meta-key="step"]',e).first();switch(i){case"range":var d=this.get_number(o.val(),0),_=this.get_number(r.val(),100),l=this.get_number(n.val(),1);""!=r.val()&&d>_&&(d=_,o.val(d)),0==d?a.removeAttr("min"):a.attr("min",d),100==_?a.removeAttr("max"):a.attr("max",_),1==l?a.removeAttr("step"):a.attr("step",l),a.val(s>_?_:s<d?d:s);break;case"number":d=""!=o.val()&&this.get_number(o.val()),_=""!=o.val()&&this.get_number(r.val()),l=""!=o.val()&&this.get_number(n.val());!1!==d&&!1!==_&&d>_&&(d=_,o.val(d)),!1===d?a.removeAttr("min"):a.attr("min",d),!1===_?a.removeAttr("max"):a.attr("max",_),!1===l?a.removeAttr("step"):a.attr("step",l),!1!==_&&s>_&&a.val(_),!1!==d&&s<d&&a.val(d)}},t.WS_Form.prototype.sidebar_tabs_init=function(e,a){e.tabs({activate:function(){a.scrollTop(0),t.WS_Form.this.sidebar_tinymce_init(a),t.WS_Form.this.sidebar_html_editor_init(a)}})},t.WS_Form.prototype.sidebar_field_select_init=function(){var e=[];for(var a in t.WS_Form.field_types)if(t.WS_Form.field_types.hasOwnProperty(a)){var i=t.WS_Form.field_types[a],s=i.label.toLowerCase(),o=i.types;if(0!=o.length)for(var r in o)if(o.hasOwnProperty(r)){var n=o[r],d=n.label.toLowerCase();void 0!==n.keyword&&(d+=" "+n.keyword.toLowerCase()),d+=" "+s,e.push({keyword:d,type:r})}}var _='<fieldset class="wsf-fieldset"><div class="wsf-field-wrapper""><input id="wsf-field-selector-search" class="wsf-field" type="search" placeholder="'+this.language("field_search")+'" /></div></fieldset>';_+='<div class="wsf-field-selector">'+this.sidebar_field_select_html()+"</div>",_+='<div class="wsf-sidebar-upgrade">'+this.language("field_selector_upgrade","",!1)+"</div>",t("#wsf-form-field-selector").html(_),t("#wsf-field-selector-search").on("input change paste",function(){var a=t(this).val(),i=(a=a.toLowerCase().trim()).split(" "),s=[];for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];for(var n in r=r.trim(),e)if(e.hasOwnProperty(n)){var d=e[n],_=0,l=d.keyword.indexOf(r);0===l&&(_+=2),l>0&&(_+=1),_>0&&(void 0===s[d.type]?s[d.type]=_:s[d.type]+=_)}}s=Object.fromEntries(Object.entries(s).sort(([,t],[,e])=>e-t));for(var c in t("#wsf-form-field-selector li.wsf-field-selector-group").hide(),t("#wsf-form-field-selector li.wsf-field-wrapper[data-type]").hide().attr("data-hidden",""),s)s.hasOwnProperty(c)&&t('#wsf-form-field-selector li.wsf-field-wrapper[data-type="'+t.WS_Form.this.esc_selector(c)+'"]').show().removeAttr("data-hidden");t("#wsf-form-field-selector li.wsf-field-selector-group").each(function(){t("li.wsf-field-wrapper:not([data-hidden])",t(this)).length&&t(this).show()})}),t(".wsf-field-selector-group > ul > li:not(.wsf-pro-required)").draggable({connectToSortable:".wsf-fields",helper:"clone",zIndex:100001,cancel:".wsf-field-disabled, .wsf-pro-required",appendTo:"#wsf-field-draggable ul",distance:3,start:function(e,a){a.helper.width(t(this).width());var i=t(".wsf-field-type",a.helper).html();t(".wsf-field-label",a.helper).append('<input type="text" value="'+t.WS_Form.this.esc_attr(i)+'" readonly aria-label="'+t.WS_Form.this.esc_attr(t.WS_Form.this.language("field_label"))+'">'),t.WS_Form.this.dragged_field=t(a.helper),t.WS_Form.this.sidebar_reset_mobile()},drag:function(){t.WS_Form.this.field_type_click_drag_check=!0},stop:function(){t.WS_Form.this.dragged_field_in_section||(t.WS_Form.this.dragged_field=null)}}).disableSelection(),t(".wsf-field-selector-group > ul > li:not(.wsf-pro-required)").on("mousedown",function(){t.WS_Form.this.field_type_click_drag_check=!1}),t(".wsf-field-selector-group > ul > li:not(.wsf-pro-required)").on("mouseup",function(){if(!(t(this).hasClass("wsf-field-disabled")||!1!==t.WS_Form.this.field_type_click_drag_check||t("body").hasClass("wsf-column-size-change-body")||t("body").hasClass("wsf-offset-change-body")||t.WS_Form.this.dragging)){var e=t(this).attr("data-type"),a=t.WS_Form.field_type_cache[e];void 0===a.multiple||a.multiple||t(this).addClass("wsf-field-disabled");var i=t.WS_Form.this.field_type_click_section_id_set();if(!1===i)return;var s='<li class="wsf-field-wrapper" data-type="'+t.WS_Form.this.esc_attr(e)+'">'+t(this).html()+"</li>";t("#wsf-fields-"+t.WS_Form.this.esc_selector(i)).append(s);var o=t("#wsf-fields-"+t.WS_Form.this.esc_selector(i)+" li").last(),r=t(".wsf-field-type",t(this)).html();t(".wsf-field-label",o).append('<input type="text" value="'+t.WS_Form.this.esc_attr(r)+'" readonly aria-label="'+t.WS_Form.this.esc_attr(t.WS_Form.this.language("field_label"))+">"),t.WS_Form.this.field_post(o),t.WS_Form.this.init_ui()}}),t('[data-action="wsf-sidebar-cancel"]',t("#wsf-sidebar-toolbox")).on("click",function(){t.WS_Form.this.sidebar_reset()})},t.WS_Form.prototype.sidebar_field_select_html=function(){var e="<ul>";for(var a in t.WS_Form.field_types){var i=t.WS_Form.field_types[a],s=i.label,o=i.types;if(0!=o.length){var r="";for(var n in o){var d=o[n],_=d.pro_required;if(!_)if(void 0!==d.kb_url){var l=this.get_plugin_website_url(d.kb_url,"field_select");r+='<li class="wsf-field-wrapper'+(_?" wsf-pro-required":"")+'" data-type="'+this.esc_attr(n)+'">'+(_?'<a href="'+this.esc_url(l)+'" target="_blank">':"")+'<div class="wsf-field-inner"><div class="wsf-field-label">'+d.icon+'</div><div class="wsf-field-type">'+d.label+"</div></div>"+(_?"</a>":"")+"</li>"}else r+='<li class="wsf-field-wrapper'+(_?" wsf-pro-required":"")+'" data-type="'+this.esc_attr(n)+'"><div class="wsf-field-inner"><div class="wsf-field-label">'+d.icon+'</div><div class="wsf-field-type">'+d.label+"</div></div></li>"}""!=r&&(e+='<li class="wsf-field-selector-group wsf-fields-group-'+a+'"><h3>'+s+"</h3><ul>"+r+"</ul></li>")}}return e+="</ul>"},t.WS_Form.prototype.sidebar_section_select_init=function(){var e=[];for(var a in t.WS_Form.templates_section)if(t.WS_Form.templates_section.hasOwnProperty(a)){var i=t.WS_Form.templates_section[a];if("string"==typeof i.label){var s=i.label.toLowerCase();if("object"==typeof i.templates){var o=i.templates;if(0!=o.length)for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];if(void 0!==n.id){var d=n.id;if("string"==typeof n.label){var _=n.label.toLowerCase();void 0!==n.keyword&&(_+=" "+n.keyword.toLowerCase()),_+=" "+s,e.push({keyword:_,id:d})}}}}}}var l='<fieldset class="wsf-fieldset"><div class="wsf-field-wrapper""><input id="wsf-section-selector-search" class="wsf-field" type="search" placeholder="'+this.language("section_search")+'" /></div></fieldset>';l+='<div class="wsf-section-selector">'+this.sidebar_section_select_html()+"</div>";var c=t("#wsf-form-section-selector");l+='<div class="wsf-sidebar-upgrade">'+this.language("section_selector_upgrade","",!1)+"</div>",c.html(l),t(".wsf-section-selector-group",c).each(function(){var e=t(this);t(this).on("dragenter",function(a){a.stopPropagation(),a.preventDefault(),t.WS_Form.this.drag_is_file(a)&&t(".wsf-section-selector-upload-json-window",e).show()}),t(".wsf-section-selector-upload-json-window",t(this)).on("dragover",function(t){t.stopPropagation(),t.preventDefault()}),t(".wsf-section-selector-upload-json-window",t(this)).on("drop",function(a){a.preventDefault();var i=a.originalEvent.dataTransfer.files;t.WS_Form.this.section_upload_json(i,t(this),function(e){t.WS_Form.this.template_api_response(e)},function(){t(".wsf-section-selector-upload-json-window",e).hide()})}),t(".wsf-section-selector-upload-json-window",t(this)).on("dragleave",function(a){t(".wsf-section-selector-upload-json-window",e).hide()}),t('[data-action="wsf-section-upload"]',t(this)).on("click",function(a){t('input[id="wsf-section-upload-file"]',e).trigger("click")}),t('input[id="wsf-section-upload-file"]',t(this)).on("change",function(){var a=t('input[id="wsf-section-upload-file"]').prop("files");if(a.length>0){var i=t(".wsf-section-selector-upload-json-window",e);i.show(),t.WS_Form.this.section_upload_json(a,i,function(e){t.WS_Form.this.template_api_response(e)},function(){t(".wsf-section-selector-upload-json-window",e).hide()})}})}),t('[data-action="wsf-section-download"]',c).on("mouseup",function(e){e.preventDefault(),e.stopPropagation();var a=t(this).closest(".wsf-section").attr("data-id");t.WS_Form.this.template_download(a)}),t('[data-action="wsf-section-delete"]',c).on("mouseup",function(e){e.preventDefault(),e.stopPropagation();var a=t(this).closest(".wsf-section"),i=a.attr("data-id"),s=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_section_template_delete"),s,a,function(){var e={type:"section",template_id:i};t.WS_Form.this.api_call("template/delete/","POST",e,function(e){t.WS_Form.this.template_api_response(e),t.WS_Form.this.loader_off()})})}),t("#wsf-section-selector-search",c).on("input change paste",function(){var a=t(this).val(),i=(a=a.toLowerCase().trim()).split(" "),s=[];for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];r=r.trim(),e.find(function(t){var e=0,a=t.keyword.indexOf(r);0===a&&(e+=2),a>0&&(e+=1),e>0&&(void 0===s[t.id]?s[t.id]=e:s[t.id]+=e)})}s.sort(function(t,e){return t==e?0:t<e?-1:1});var n=t("#wsf-form-section-selector");for(var d in t("li.wsf-section-selector-group",n).hide(),t("li.wsf-section[data-id], li.wsf-section-blank",n).hide().attr("data-hidden",""),s)s.hasOwnProperty(d)&&t('li.wsf-section[data-id="'+t.WS_Form.this.esc_selector(d)+'"]',n).show().removeAttr("data-hidden");t("li.wsf-section[data-hidden]",n).length||t("li.wsf-section-blank",n).show().removeAttr("data-hidden"),t(".wsf-section-selector-group",n).each(function(){t("li.wsf-section:not([data-hidden]),li.wsf-section-blank:not([data-hidden])",t(this)).length&&t(this).show()})}),t(".wsf-section-selector-group > ul.wsf-section-selector-group-sections > li:not(.wsf-pro-required,.wsf-section-blank)").draggable({connectToSortable:".wsf-sections",helper:"clone",zIndex:100001,cancel:".wsf-section-disabled, .wsf-pro-required, [data-action]",appendTo:"#wsf-section-draggable ul",distance:3,start:function(e,a){a.helper.width(t(this).width()),t.WS_Form.this.dragged_section=t(a.helper),t.WS_Form.this.sidebar_reset_mobile()},drag:function(){t.WS_Form.this.section_id_click_drag_check=!0},stop:function(){t.WS_Form.this.dragged_section_in_group||(t.WS_Form.this.dragged_section=null)}}).disableSelection(),t(".wsf-section-selector-group > ul.wsf-section-selector-group-sections > li:not(.wsf-pro-required,.wsf-section-blank)").on("mousedown",function(){t.WS_Form.this.section_type_click_drag_check=!1}),t(".wsf-section-selector-group > ul.wsf-section-selector-group-sections > li:not(.wsf-pro-required,.wsf-section-blank)").on("mouseup",function(){if(!(t(this).hasClass("wsf-section-disabled")||!1!==t.WS_Form.this.section_type_click_drag_check||t("body").hasClass("wsf-column-size-change-body")||t("body").hasClass("wsf-offset-change-body")||t.WS_Form.this.dragging)){var e=t(".wsf-section-inner",t(this)).height(),a=t(".wsf-template-title tspan",t(this)).html(),i=t(this).attr("data-id"),s=t(".wsf-group-tabs li.ui-tabs-active").attr("data-id"),o=t('.wsf-groups .wsf-group[data-id="'+t.WS_Form.this.esc_selector(s)+'"]',t.WS_Form.this.form_obj),r='<li class="wsf-section" data-id="'+t.WS_Form.this.esc_attr(i)+'"><div class="wsf-section-inner" style="height:'+t.WS_Form.this.esc_attr(e)+'px"><div class="wsf-section-label"><input type="text" value="'+t.WS_Form.this.esc_attr(a)+'" readonly></div><div class="wsf-section-type">'+t.WS_Form.this.language("section")+"</div></div></li>";t("ul.wsf-sections",o).append(r);var n=t("ul.wsf-sections li",o).last();t.WS_Form.this.template_section_post(n),t.WS_Form.this.init_ui()}})},t.WS_Form.prototype.sidebar_section_select_html=function(){var e="<ul>";for(var a in t.WS_Form.templates_section)if(t.WS_Form.templates_section.hasOwnProperty(a)){var i=t.WS_Form.templates_section[a],s=i.id,o=i.label,r=void 0!==i.upload&&i.upload,n=void 0!==i.download&&i.download,d=void 0!==i.delete&&i.delete,_=i.templates;if("wsfuser"==s||0!=_.length){var l="";for(var c in _)if(_.hasOwnProperty(c)){var f=_[c],h=f.id,p=f.label,u=f.pro_required;u||(l+='<li class="wsf-section'+(u?" wsf-pro-required":"")+'" data-id="'+this.esc_attr(h)+'" aria-label="'+this.esc_attr(p)+'"><div class="wsf-section-inner">'+f.svg+"</div>",n&&(l+='<div data-action="wsf-section-download"'+this.tooltip(this.language("section_download"),"top-right")+">"+this.svg("download")+"</div>"),d&&(l+='<div data-action="wsf-section-delete"'+this.tooltip(this.language("section_delete"),"top-right")+">"+this.svg("delete")+"</div>"),l+="</li>")}if(""==l&&"wsfuser"==s&&(l='<li class="wsf-section-blank"><div>'+this.language("section_selector_drop_zone",!1,!1)+"</div></li>"),""!=l){e+='<li class="wsf-section-selector-group">';var m=[];r&&m.push('<li><div data-action="wsf-section-upload"'+this.tooltip(this.language("section_selector_import"),"top-right")+">"+this.svg("upload")+'</div><input type="file" class="wsf-section-upload" id="wsf-section-upload-file" accept=".json"/></li>'),m.length&&(e+='<ul class="wsf-section-selector-group-options">'+m.join("")+"</ul>"),e+="<h3>"+o+'</h3><ul class="wsf-section-selector-group-sections">'+l+"</ul>","wsfuser"==s&&(e+='<div class="wsf-section-selector-upload-json-window"><div class="wsf-section-selector-upload-json-window-content"><h1>'+this.language("drop_zone_section")+'</h1><div class="wsf-uploads"></div></div></div>'),e+="</li>"}}}return e+="</ul>"},t.WS_Form.prototype.section_upload_json=function(e,a,i,s,o){if(t("h1",a).hide(),0==e.length)return s(),!1;var r=new FormData;r.append("file",e[0]),r.append(ws_form_settings.wsf_nonce_field_name,ws_form_settings.wsf_nonce);var n=new this.upload_status_bar(this,a);n.populate(e[0].name,e[0].size),this.section_upload_ajax(r,n,a,i,s)},t.WS_Form.prototype.section_upload_ajax=function(e,a,i,s,o){var r=ws_form_settings.url_ajax+"template/upload/json",n=t.ajax({beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",ws_form_settings.x_wp_nonce)},xhr:function(){var e=t.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(t){var e=0,i=t.loaded||t.position,s=t.total;t.lengthComputable&&(e=Math.ceil(i/s*100)),a.set_progress(e)},!1),e},url:r,type:"POST",contentType:!1,processData:!1,cache:!1,data:e,success:function(t){a.set_progress(100),"function"==typeof s&&s(t)},error:function(e){t.WS_Form.this.api_call_error_handler(e,r,o)}});a.set_abort(n)},t.WS_Form.prototype.sidebar_form_history_init=function(){var e='<div class="wsf-form-history"><h3>'+this.language("sidebar_title_history")+"</h3><ul></ul></div>";t("#wsf-form-form-history").html(e),this.touch_device||t(".wsf-form-history ul").on("mouseleave",function(){var e=t.WS_Form.this.history_index;t.WS_Form.this.history_pull(e),t.WS_Form.this.sidebar_form_history_classes()})},t.WS_Form.prototype.sidebar_tinymce_init=function(e){return"undefined"!=typeof wp&&(void 0!==wp.editor&&(void 0!==wp.editor.remove&&(void 0!==wp.editor.initialize&&void t('[data-text-editor="true"]:visible',e).each(function(){var e=t(this).attr("id"),a={tinymce:{wpautop:!0,plugins:"charmap colorpicker compat3x directionality fullscreen hr image lists media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wptextpattern wpview",toolbar1:"formatselect bold italic | bullist numlist | blockquote | alignleft aligncenter alignright | link unlink | spellchecker | fullscreen | wp_adv",toolbar2:"strikethrough hr forecolor pastetext removeformat charmap outdent indent undo redo",height:"200px",init_instance_callback:function(e){e.on("keyup input change",function(a){t("#"+e.id).val(wp.editor.getContent(e.id)).trigger("keyup").trigger("input")})}},quicktags:!0,mediaButtons:!0},i=t(this).attr("data-helper-css");i&&(a.tinymce.content_css=ws_form_settings.url_ajax+"helper/"+i+"/"),wp.editor.remove(e),wp.editor.initialize(e,a)}))))},t.WS_Form.prototype.sidebar_buttons_init=function(e,a){t('button[data-action="wsf-sidebar-save"]',a).on("click",function(){t.WS_Form.this.object_button_save(e,!1)}),t('button[data-action="wsf-sidebar-save-close"]',a).on("click",function(){t.WS_Form.this.object_button_save(e,!0)}),t('button[data-action="wsf-sidebar-cancel"]',a).on("click",function(){t.WS_Form.this.object_button_cancel(e)}),t('button[data-action="wsf-sidebar-clone"]',a).on("click",function(){t.WS_Form.this.object_button_clone(e)}),t('button[data-action="wsf-sidebar-delete"]',a).on("click",function(){t.WS_Form.this.object_button_delete(e)}),t.WS_Form.this.keydown[27]={function:function(){t.WS_Form.this.object_button_cancel(e)},ctrl_key:!1},t.WS_Form.this.keydown[83]={function:function(){t.WS_Form.this.object_button_save(e,!0)},ctrl_key:!0}},t.WS_Form.prototype.sidebar_conditions_init=function(e){if(0===this.sidebar_conditions.length)return!0;var a=this,i=[];if(void 0===e.attr("data-sidebar-conditions-init")){for(var s in e.hasClass("wsf-sidebar")||(e=e.closest(".wsf-sidebar")),this.sidebar_conditions)if(this.sidebar_conditions.hasOwnProperty(s)){var o=this.sidebar_conditions[s];if("sidebar_meta_key"===o.type){var r=o.meta_key,n='[data-meta-key="'+this.esc_selector(r)+'"]';0!=t(n,e).length&&void 0===i[r]&&(i[r]=!0,e.on("input change",n,function(){a.sidebar_condition_process(e,t(this),!1)}))}}e.attr("data-sidebar-conditions-init",""),this.sidebar_conditions_events_added=!0}this.sidebar_condition_process(e,e,!0)},t.WS_Form.prototype.sidebar_condition_process=function(e,a,i){if(0==this.sidebar_conditions.length)return!0;"form_populate_action_id"==a.attr("data-meta-key")&&t('[data-meta-key="form_populate_list_id"]',e).val("");var s=[];for(var o in this.sidebar_conditions)if(this.sidebar_conditions.hasOwnProperty(o)){var r=this.sidebar_conditions[o],n=r.type,d=r.logic,_=r.meta_key,l=r.meta_value,c=r.logic_previous;if("sidebar_meta_key"===n){var f=t('[data-meta-key="'+this.esc_selector(_)+'"]',e);if(!f.length)continue}var h=(v=t.WS_Form.meta_keys[_]).type,p=r.show;if(t('[data-meta-key="'+this.esc_selector(p)+'"]',e).length){var u=!0,m="";switch(h){case"checkbox":switch(n){case"object_meta_value_form":m=this.get_object_meta_value(this.form,_,!1);break;case"sidebar_meta_key":m=f.is(":checked")}switch(d){case"==":u=m;break;case"!=":u=!m}break;default:switch(n){case"object_meta_value_form":m=this.get_object_meta_value(this.form,_,!1);break;case"sidebar_meta_key":m=f.val()}var v;if(null===m&&(m=""),"default"===m)void 0!==(v=t.WS_Form.meta_keys[_]).options_default&&(m=this.get_object_meta_value(this.form,v.options_default,""));switch(d){case"==":u=m==l;break;case"!=":u=m!=l;break;case"contains":u=-1!==m.indexOf(l);break;case"contains_not":u=-1===m.indexOf(l)}}if(void 0===s[p])s[p]=u;else switch(c){case"||":s[p]=s[p]||u;break;default:s[p]=s[p]&&u}}}for(p in s){var g=s[p],b=t('[data-meta-key="'+this.esc_selector(p)+'"]',e).closest(".wsf-field-wrapper");g?b.show().removeClass("wsf-field-hidden"):b.hide().addClass("wsf-field-hidden"),this.sidebar_fieldset_toggle(b)}if(!i){var w=!1,y=a.closest(".wsf-data-grid");if(y.length)switch(y.attr("data-meta-key")){case"conditional":t.WS_Form.this.conditional_save(),w=!0;break;case"action":t.WS_Form.this.action_save(),w=!0}if(!w){var S=a.closest("[data-object]"),W=S.attr("data-object"),F=S.attr("data-id"),k=t.WS_Form.this.get_object_data(W,F,!0);for(var j in t.WS_Form.this.object_meta_cache)if(t.WS_Form.this.object_meta_cache.hasOwnProperty(j)){var x=t.WS_Form.this.object_meta_cache[j].meta_key;t.WS_Form.this.object_data_update_by_meta_key(W,k,x)}}t.WS_Form.this.sidebar_inits(["options-action","repeater","text-editor","html-editor"],e)}},t.WS_Form.prototype.sidebar_fieldset_toggle=function(e){var a=e.closest(".wsf-fieldset");t(".wsf-field-wrapper",a).length==t(".wsf-field-hidden",a).length?a.hide():a.show()},t.WS_Form.prototype.sidebar_placeholders_init=function(e){t("[data-placeholder]",e).each(function(){var a=t(this).attr("data-placeholder");"#invalid_feedback_mask"==a&&(a=t.WS_Form.this.get_form_invalid_feedback_mask());var i=t('[name="label"]',e),s=i.length?i.val():"",o=t.WS_Form.this.get_invalid_feedback_mask_parsed(a,s);t(this).attr("placeholder",t.WS_Form.this.esc_attr(o))})},t.WS_Form.prototype.breakpoints=function(){var e=t("#wsf-breakpoints"),a=this.framework.breakpoints,i=t.WS_Form.frameworks.icons,s=this.get_object_meta_value(this.form,"breakpoint");t.WS_Form.breakpoints=[];var o=!1,r=0,n=0,d=0,_=1;for(var l in a)if(a.hasOwnProperty(l)){if(d++,l!=s||o){var c=Math.abs(l-s);(0==r||c<r)&&(r=c,n=l)}else o=!0,_=d;t.WS_Form.breakpoints.push(l)}o||(s=n,this.set_object_meta_value(this.form,"breakpoint",s),t.WS_Form.this.form_put(!1,!1,!0,!1));var f=a[s].id;t("#"+this.form_obj_id).attr("data-breakpoint",f),e.html('<div id="wsf-slider"></div>'),e.append('<ul class="wsf-breakpoint-actions"><li><button class="wsf-button wsf-button-full wsf-button-small" data-action="wsf-reset">'+this.svg("undo")+" "+this.language("breakpoint_reset")+"</button></li></ul>");var h=t("#wsf-slider"),p=0;for(var l in a)if(a.hasOwnProperty(l)){s=a[l];if(void 0===i[l])var u="";else u=i[l];var m=[];void 0!==s.name&&m.push(s.name),void 0!==s.min_width?m.push(">= "+s.min_width+"px"):m.push("> 0 px"),void 0!==s.max_width&&m.push("<= "+s.max_width+"px");var v=m.join("\n"),g="top-"+(0===p?"left":"center");h.append("<label"+this.tooltip(v,g)+' style="'+(ws_form_settings.rtl?"right":"left")+":"+p/(d-1)*100+'%;">'+u+"</label>"),p++}t("#wsf-slider").slider({range:"max",min:1,max:d,value:ws_form_settings.rtl?d-(_-1):_,start:function(){"off"!=t.WS_Form.settings_plugin.helper_columns&&t(".wsf-group:visible").addClass("wsf-column-helper"),t.WS_Form.this.dragging=!0},stop:function(){"on"!=t.WS_Form.settings_plugin.helper_columns&&t(".wsf-group:visible").removeClass("wsf-column-helper"),t.WS_Form.this.form_put(!1,!1,!0,!1),t.WS_Form.this.dragging=!1},slide:function(e,a){var i=t.WS_Form.breakpoints[ws_form_settings.rtl?d-a.value:a.value-1];t.WS_Form.this.breakpoint_set(i)}}),t('#wsf-breakpoints [data-action="wsf-reset"]').on("click",function(){var e=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("reset"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_breakpoint_reset"),e,t(this),function(){t.WS_Form.this.breakpoint_reset()})})},t.WS_Form.prototype.breakpoint_optimize=function(e){var a=t.WS_Form.frameworks.types[t.WS_Form.settings_plugin.framework].breakpoints,i=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),s=0,o=0;for(var r in a)if(a.hasOwnProperty(r)){var n=a[r];if(0==o){var d;s=void 0!==n.column_size_default?"column_count"==n.column_size_default?i:n.column_size_default:s}var _="breakpoint_size_"+r,l="breakpoint_offset_"+r,c=this.get_object_meta_value(e,_,"",!1);""!=c&&((c=parseInt(c,10))==s&&(e.meta[_]=""),s=c);var f=this.get_object_meta_value(e,l,"",!1);""!=f&&((f=parseInt(f,10))==d&&(e.meta[l]=""),d=f),o++}},t.WS_Form.prototype.breakpoint_reset=function(){t.WS_Form.settings_plugin.framework,t(t(".wsf-group-tab.ui-tabs-active a").attr("href"));for(var e in this.section_data_cache)if(this.section_data_cache.hasOwnProperty(e)){var a=this.section_data_cache[e];t.WS_Form.this.breakpoint_reset_process(a)}for(var e in this.field_data_cache)if(this.field_data_cache.hasOwnProperty(e)){a=this.field_data_cache[e];t.WS_Form.this.breakpoint_reset_process(a)}t.WS_Form.this.form_build(),t.WS_Form.this.loader_on(),t.WS_Form.this.api_call("form/"+t.WS_Form.this.form_id+"/full/put/","POST",{form:t.WS_Form.this.form,history_method:"put_reset"},function(e){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.breakpoint_set=function(e){var a=t.WS_Form.settings_plugin.framework,i=t.WS_Form.frameworks.types[a].breakpoints[e].id;t.WS_Form.this.set_object_meta_value(t.WS_Form.this.form,"breakpoint",e),t("#"+t.WS_Form.this.form_obj_id).attr("data-breakpoint",i)},t.WS_Form.prototype.breakpoint_buttons=function(){var e=!1;t(t(".wsf-group-tab.ui-tabs-active a").attr("href"));for(var a in this.section_data_cache)if(this.section_data_cache.hasOwnProperty(a)){var i=this.section_data_cache[a];e=e||t.WS_Form.this.breakpoint_can_reset(i,!0)}for(var a in this.field_data_cache)if(this.field_data_cache.hasOwnProperty(a)){i=this.field_data_cache[a];e=e||t.WS_Form.this.breakpoint_can_reset(i,!0)}t('#wsf-breakpoints [data-action="wsf-reset"]').attr("disabled",!e)},t.WS_Form.prototype.sidebar_breakpoint_sizes=function(e){t(".wsf-breakpoint-sizes:not(.wsf-breakpoint-sizes-initialized)",e).each(function(e,a){t.WS_Form.this.sidebar_breakpoint_sizes_init(t(this),a)})},t.WS_Form.prototype.sidebar_breakpoint_sizes_init=function(e,a){var i=this;a.render=function(){var s=e.attr("data-object"),o=e.attr("data-id"),r=e.attr("data-meta-key");switch(s){case"section":var n=t('.wsf-section[data-id="'+i.esc_selector(o)+'"]');break;case"field":n=t('.wsf-field-wrapper[data-id="'+i.esc_selector(o)+'"]')}var d=t.WS_Form.this.get_object_data(s,o,!0);!1===d&&t.WS_Form.this.error("error_object_data"),!1===t.WS_Form.this.get_object_meta_value(d,r,!1)&&t.WS_Form.this.error("error_object_meta_value"),e.html(t.WS_Form.this.sidebar_breakpoint_sizes_html(n,r,d)),t('select[data-action="wsf-column"]',e).on("change",function(){var e=t(this).attr("data-id"),i=t(this).val(),s="breakpoint_size_"+e;n.length?(t.WS_Form.this.column_classes_render(n,d,!1),t.WS_Form.this.set_object_meta_value(d,s,i),t.WS_Form.this.column_classes_render(n,d)):t.WS_Form.this.error("error_object"),a.render()}),t('select[data-action="wsf-offset"]',e).on("change",function(){var e=t(this).attr("data-id"),i=t(this).val(),s="breakpoint_offset_"+e;n.length?(t.WS_Form.this.column_classes_render(n,d,!1),t.WS_Form.this.set_object_meta_value(d,s,i),t.WS_Form.this.column_classes_render(n,d)):t.WS_Form.this.error("error_object"),a.render()}),t('[data-action="wsf-reset"]',e).on("click",function(){var e=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("reset"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_breakpoint_reset"),e,t(this),function(){t.WS_Form.this.column_classes_render(n,d,!1),t.WS_Form.this.breakpoint_reset_process(d),t.WS_Form.this.column_classes_render(n,d),a.render()})});var _=t.WS_Form.this.breakpoint_can_reset(d,!0);t('[data-action="wsf-reset"]',e).attr("disabled",!_),e.addClass("wsf-breakpoint-sizes-initialized")},a.render()},t.WS_Form.prototype.sidebar_breakpoint_sizes_html=function(e,a,i){var s="",o=t.WS_Form.settings_plugin.framework,r=t.WS_Form.frameworks.types[o],n=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),d=r.breakpoints,_=t.WS_Form.frameworks.icons,l=!1,c=!1,f=0;for(var h in d)if(d.hasOwnProperty(h)){var p=d[h],u=p.name;if(0==f)l=void 0!==p.column_size_default?"column_count"==p.column_size_default?n:p.column_size_default:l,c=0;var m="breakpoint_size_"+h,v=this.get_object_meta_value(i,m,"",!1);if(""!=v)var g=v=parseInt(v,10);else g=l;var b="breakpoint_offset_"+h,w=this.get_object_meta_value(i,b,"",!1);if(""!=w)w=parseInt(w,10);else;var y=n-w,S=n-g;if(s+="<div>",void 0===_[h])var W="";else W=_[h];s+='<label class="wsf-label">'+W+this.esc_html(u)+"</label>",s+='<div class="wsf-breakpoint-width-offset">',s+="<div>",s+='<label class="wsf-label" for="'+this.esc_attr(m)+'">'+this.language("breakpoint_offset_column_width")+"</label>",s+='<select class="wsf-field wsf-column-size-select" id="'+this.esc_attr(m)+'" data-id="'+this.esc_attr(h)+'" data-action="wsf-column">',s+='<option value=""'+(""==v?" selected":"")+">";var F="("+this.language(1==l?"breakpoint_option_column_default_singular":"breakpoint_option_column_default_plural",l)+")";ws_form_settings.rtl&&!1!==l&&(s+=F+" "),s+=0==f?this.language("breakpoint_option_default"):this.language("breakpoint_option_inherit"),ws_form_settings.rtl||!1===l||(s+=" "+F),s+="</option>";for(var k=1;k<=y;k++)s+='<option value="'+this.esc_attr(k)+'"'+(v===k?" selected":"")+">"+this.language(1==k?"breakpoint_option_column_singular":"breakpoint_option_column_plural",k)+"</option>";s+="</select>",s+="</div>",s+="<div>",s+='<label class="wsf-label" for="'+this.esc_attr(b)+'">'+this.language("breakpoint_offset_column_offset")+"</label>",s+='<select class="wsf-field wsf-offset-select" id="'+this.esc_attr(b)+'" data-id="'+this.esc_attr(h)+'" data-action="wsf-offset">',s+='<option value=""'+(""===w?" selected":"")+">";var j="("+this.language(1==c?"breakpoint_option_offset_default_singular":"breakpoint_option_offset_default_plural",c)+")";ws_form_settings.rtl&&(s+=j+" "),s+=0==f?this.language("breakpoint_option_default"):this.language("breakpoint_option_inherit"),ws_form_settings.rtl||(s+=" "+j),s+="</option>";for(k=0;k<=S;k++)s+='<option value="'+this.esc_attr(k)+'"'+(w===k?" selected":"")+">"+this.language(1==k?"breakpoint_option_offset_singular":"breakpoint_option_offset_plural",k)+"</option>";s+="</select>",s+="</div>",s+="</div>",s+="</div>",""!==v&&(l=v),""!==w&&(c=w),f++}return s+='<ul class="wsf-list-inline">',s+='<li><button class="wsf-button wsf-button-small" data-action="wsf-reset">'+this.svg("undo")+" "+this.language("breakpoint_reset")+"</button></li>",s+="</ul>"},t.WS_Form.prototype.breakpoint_can_reset=function(e){var a=!1,i=t.WS_Form.frameworks.types[t.WS_Form.settings_plugin.framework].breakpoints,s=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),o=0,r=0;for(var n in i)if(i.hasOwnProperty(n)){var d=i[n];if(0==r)o=void 0!==d.column_size_default?"column_count"==d.column_size_default?s:d.column_size_default:o;var _="breakpoint_size_"+n,l="breakpoint_offset_"+n,c=this.get_object_meta_value(e,_,"",!1);""!=c&&((c=parseInt(c,10))!=s&&(a=!0),o=c);var f=this.get_object_meta_value(e,l,"",!1);""!=f&&(0!=(f=parseInt(f,10))&&(a=!0),f),r++}return a},t.WS_Form.prototype.breakpoint_reset_process=function(e){var a=t.WS_Form.frameworks.types[t.WS_Form.settings_plugin.framework].breakpoints;for(var i in a)a.hasOwnProperty(i)&&(e.meta["breakpoint_size_"+i]="",e.meta["breakpoint_offset_"+i]="")},t.WS_Form.prototype.sidebar_orientation_breakpoint_sizes=function(e){t(".wsf-orientation-breakpoint-sizes:not(.wsf-orientation-breakpoint-sizes-initialized)",e).each(function(e,a){t.WS_Form.this.sidebar_orientation_breakpoint_sizes_init(t(this),a)})},t.WS_Form.prototype.sidebar_orientation_breakpoint_sizes_init=function(e,a){a.render=function(){var i=e.attr("data-object"),s=e.attr("data-id"),o=e.attr("data-meta-key"),r=t('.wsf-field-wrapper[data-id="'+t.WS_Form.this.esc_selector(s)+'"]'),n=t.WS_Form.this.get_object_data(i,s,!0);!1===n&&t.WS_Form.this.error("error_object_data"),!1===t.WS_Form.this.get_object_meta_value(n,o,!1)&&t.WS_Form.this.error("error_object_meta_value"),e.html(t.WS_Form.this.sidebar_orientation_breakpoint_sizes_html(r,o,n)),t('select[data-action="wsf-column"]',e).on("change",function(){var e=t(this).attr("data-id"),i=t(this).val(),s="orientation_breakpoint_size_"+e;r.length?t.WS_Form.this.set_object_meta_value(n,s,i):t.WS_Form.this.error("error_object"),a.render()}),t('[data-action="wsf-reset"]',e).on("click",function(){var e=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("reset"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_orientation_breakpoint_reset"),e,t(this),function(){t.WS_Form.this.orientation_breakpoint_reset_process(n),a.render()})});var d=t.WS_Form.this.orientation_breakpoint_can_reset(n,!0);t('[data-action="wsf-reset"]',e).attr("disabled",!d),e.addClass("wsf-orientation-breakpoint-sizes-initialized")},a.render()},t.WS_Form.prototype.sidebar_orientation_breakpoint_sizes_html=function(e,a,i){var s="",o=t.WS_Form.settings_plugin.framework,r=t.WS_Form.frameworks.types[o],n=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),d=r.breakpoints,_=t.WS_Form.frameworks.icons,l=!1,c=0;for(var f in d)if(d.hasOwnProperty(f)){var h=d[f],p=h.name;if(0==c)l=void 0!==h.column_size_default?"column_count"==h.column_size_default?n:h.column_size_default:l;var u="orientation_breakpoint_size_"+f,m=this.get_object_meta_value(i,u,"",!1);if(""!=m)m=parseInt(m,10);else;if(s+="<div>",void 0===_[f])var v="";else v=_[f];s+='<label class="wsf-label">'+v+this.language("orientation_breakpoint_label_width",this.esc_html(p))+"</label>",s+='<select class="wsf-field wsf-column-size-select" id="'+this.esc_attr(u)+'" data-id="'+this.esc_attr(f)+'" data-action="wsf-column">',s+='<option value=""'+(""==m?" selected":"")+">"+(0==c?this.language("orientation_breakpoint_option_default"):this.language("orientation_breakpoint_option_inherit")),!1!==l&&(s+=" ("+this.orientation_column_width_description(l,n)+")"),s+="</option>";for(var g=1;g<=n;g++)if(!(g>n/2&&g<n)){var b=this.orientation_column_width_description(g,n);!1!==b&&(s+='<option value="'+this.esc_attr(g)+'"'+(m===g?" selected":"")+">"+b+"</option>")}s+="</select>",s+="</div>",""!==m&&(l=m),c++}return s+='<ul class="wsf-list-inline">',s+='<li><button class="wsf-button wsf-button-small" data-action="wsf-reset">'+this.svg("undo")+" "+this.language("breakpoint_reset")+"</button></li>",s+="</ul>"},t.WS_Form.prototype.orientation_column_width_description=function(t,e){if(e%t!=0)return!1;var a=this.language(1==t?"orientation_breakpoint_option_column_singular":"orientation_breakpoint_option_column_plural",t);switch(t/e){case 1:a+=this.language("orientation_breakpoint_width_full");break;case.5:a+=this.language("orientation_breakpoint_width","&frac12;",!1);break;case 1/3:a+=this.language("orientation_breakpoint_width","&frac13;",!1);break;case 2/3:a+=this.language("orientation_breakpoint_width","&frac23;",!1);break;case.25:a+=this.language("orientation_breakpoint_width","&frac14;",!1);break;case.75:a+=this.language("orientation_breakpoint_width","&frac34;",!1);break;case.2:a+=this.language("orientation_breakpoint_width","&frac15;",!1);break;case.4:a+=this.language("orientation_breakpoint_width","&frac25;",!1);break;case.6:a+=this.language("orientation_breakpoint_width","&frac35;",!1);break;case.8:a+=this.language("orientation_breakpoint_width","&frac45;",!1);break;case 1/6:a+=this.language("orientation_breakpoint_width","&frac16;",!1);break;case 5/6:a+=this.language("orientation_breakpoint_width","&frac56;",!1)}return a},t.WS_Form.prototype.orientation_breakpoint_optimize=function(e){var a=t.WS_Form.frameworks.types[t.WS_Form.settings_plugin.framework].breakpoints,i=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),s=0,o=0;for(var r in a)if(a.hasOwnProperty(r)){var n=a[r];if(0==o)s=void 0!==n.column_size_default?"column_count"==n.column_size_default?i:n.column_size_default:s;var d="orientation_breakpoint_size_"+r,_=this.get_object_meta_value(e,d,"",!1);""!=_&&((_=parseInt(_,10))==s&&(e.meta[d]=""),s=_),o++}},t.WS_Form.prototype.orientation_breakpoint_can_reset=function(e){var a=!1,i=t.WS_Form.frameworks.types[t.WS_Form.settings_plugin.framework].breakpoints,s=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),o=0,r=0;for(var n in i)if(i.hasOwnProperty(n)){var d=i[n];if(0==r)o=void 0!==d.column_size_default?"column_count"==d.column_size_default?s:d.column_size_default:o;var _="orientation_breakpoint_size_"+n,l=this.get_object_meta_value(e,_,"",!1);""!=l&&((l=parseInt(l,10))!=s&&(a=!0),o=l),r++}return a},t.WS_Form.prototype.orientation_breakpoint_reset_process=function(e){var a=t.WS_Form.frameworks.types[t.WS_Form.settings_plugin.framework].breakpoints;for(var i in a)a.hasOwnProperty(i)&&(e.meta["orientation_breakpoint_size_"+i]="")},t.WS_Form.prototype.sidebar_select2=function(e){var a=ws_form_settings.locale_user.substring(0,2);t("select[data-wsf-select2]:not([data-select-ajax-method-search])",e).each(function(){var e={allowClear:!0,placeholder:void 0!==t(this).attr("placeholder")?t(this).attr("placeholder"):"",language:a,selectionCssClass:"wsf-select2-selection",dropdownCssClass:"wsf-select2-dropdown",dropdownParent:t(this).parent()};t(this).select2(e),t(this).on("select2:open",function(e){t(".select2-search__field",t(this).parent()).get(0).focus()})})},t.WS_Form.prototype.sidebar_select2_ajax=function(e){var a=this,i=e.closest(".wsf-sidebar[data-id]").attr("data-id"),s=[],o=[];for(var r in t("select[data-wsf-select2][data-select-ajax-method-search]",e).each(function(){var e=t(this).attr("data-meta-key");void 0===s[e]&&(s[e]=t(this).attr("data-select-ajax-method-cache"));var a=t(this).attr("data-select-ajax-id");a&&(o=o.concat(a.split(",")))}),s)if(s.hasOwnProperty(r)){var n=s[r],d=r+"_"+i;if(n)if(void 0===a.select_ajax_cache[d]){var _={form_id:a.form_id,meta_key:r,ids:o};t.WS_Form.this.api_call("select2/"+n,"POST",_,function(t){a.loader_off(),a.select_ajax_cache[d]=t,a.sidebar_select2_ajax_process(e,r,d)})}else a.sidebar_select2_ajax_process(e,r,d);else a.select_ajax_cache[d]=[],a.sidebar_select2_ajax_process(e,r,d)}},t.WS_Form.prototype.sidebar_select2_ajax_process=function(e,a,i){var s=this,o=ws_form_settings.locale_user.substring(0,2);t('select[data-wsf-select2][data-meta-key="'+this.esc_selector(a)+'"]',e).each(function(){var e=t(this).attr("data-select-ajax-method-search"),a=t(this).attr("data-select-ajax-placeholder"),r={ajax:{url:ws_form_settings.url_ajax+"select2/"+e,dataType:"json",data:function(t){return t._wpnonce=ws_form_settings.x_wp_nonce,t},delay:250,cache:!0},minimumInputLength:1,allowClear:!0,placeholder:a,language:o,selectionCssClass:"wsf-select2-selection",dropdownCssClass:"wsf-select2-dropdown",dropdownParent:t(this).parent()},n=t(this).attr("data-select-ajax-id"),d=s.select_ajax_cache[i];if(void 0!==n&&!1!==d){r.data=[];var _=n.split(",");for(var l in _)if(_.hasOwnProperty(l)){var c=void 0!==d[n=_[l]]&&d[n];!1!==c&&r.data.push({id:n,text:c,selected:!0})}}"function"==typeof t(this).select2&&e&&(t(this).select2(r),t(this).on("select2:select",function(e){var a=e.params.data.id,o=e.params.data.text;t(this).attr("data-meta-key");s.select_ajax_cache[i][a]=o}),t(this).on("select2:open",function(e){t(".select2-search__field",t(this).parent()).get(0).focus()}))})},t.WS_Form.prototype.data_grid_html=function(e,a,i,s,o){if("object"!=typeof a)return"";void 0===a.columns&&this.error("error_data_grid_columns"),void 0===a.groups&&this.error("error_data_grid_groups"),void 0===a.rows_per_page&&this.error("error_data_grid_rows_per_page"),void 0===i&&(i=""),void 0===o&&(o=!1);var r=a.columns,n=a.groups,d=a.rows_per_page,_=t.WS_Form.meta_keys[e],l=_.groups_group,c=(void 0!==_.conditional&&_.conditional,void 0!==_.upload_download&&_.upload_download),f=void 0!==_.data_source&&_.data_source;"undefined"!=typeof rows_per_page_override&&(d=rows_per_page_override);r.length;var h=n.length,p="";f&&(p+='<div id="wsf-data-source-meta"></div>'),p+='<div class="wsf-field-wrapper wsf-data-grid-groups">',p+='<div class="wsf-data-grid-group-tabs-wrapper">',p+='<ul class="wsf-data-grid-group-tabs">';h=n.length;for(var u in n)if(n.hasOwnProperty(u)&&"function"!=typeof n[u]){var m=(g=n[u]).label;p+='<li class="wsf-data-grid-group-tab'+(1==h?" ui-state-active":"")+'">',p+='<a href="'+this.esc_url("#wsf-data-grid-group-"+u)+'">'+this.esc_html(m)+"</a>",!s&&h>1&&(p+='<div data-action="wsf-data-grid-group-delete"'+this.tooltip(this.language("data_grid_group_delete"),"top-center")+">"+this.svg("delete-circle")+"</div>"),p+="</li>"}!s&&l&&(p+='<li class="wsf-ui-cancel" data-action="wsf-data-grid-group-add"><div'+this.tooltip(this.language("data_grid_group_add"),"top-center")+">"+this.svg("plus-circle")+"</div></li>"),p+="</ul>\n\n";var v=[];for(var u in c&&(s||v.push('<li><div data-action="wsf-data-grid-upload"'+this.tooltip(this.language("data_grid_group_upload_csv"),"bottom-right")+">"+this.svg("upload")+'</div><input type="file" class="wsf-file-upload" id="wsf-data-grid-upload-file" accept=".csv"/></li>'),v.push('<li><div data-action="wsf-data-grid-download"'+this.tooltip(this.language("data_grid_group_download_csv"),"bottom-right")+">"+this.svg("download")+"</div></li>")),void 0!==_.compatibility_url&&t.WS_Form.settings_plugin.helper_compatibility&&v.push('<li><div class="wsf-data-grid-compatibility"'+this.tooltip(this.language("field_compatibility"),"bottom-right")+'><a class="wsf-compatibility" href="'+this.esc_url(_.compatibility_url)+'" target="_blank" tabindex="-1">'+this.svg("markup")+"</a></div></li>"),void 0!==_.variable_helper&&_.variable_helper&&v.push('<li><div data-action="wsf-variable-helper"'+this.tooltip(this.language("variable_helper"),"bottom-right")+">"+this.svg("hash")+"</div></li>"),v.length&&(p+='<ul class="wsf-data-grid-options">'+v.join("")+"</ul>"),p+="</div>\n\n",n)if(n.hasOwnProperty(u)&&"function"!=typeof n[u]){var g=n[u];if(p+=this.data_grid_html_group(g,u,r,d,e,s,o),!l)break}return c&&(p+='<div class="wsf-data-grid-upload-csv-window"><div class="wsf-data-grid-upload-csv-window-content"><h1>'+this.language("drop_zone_data_grid")+'</h1><div class="wsf-uploads"></div></div></div>'),p+="</div>"},t.WS_Form.prototype.data_grid_html_group=function(e,a,i,s,o,r,n){var d=t.WS_Form.meta_keys[o],_=parseInt(e.page,10);void 0===e.rows&&(e.rows=[]);var l=e.rows,c=l.length,f=void 0!==d.row_default&&d.row_default,h=!r&&(void 0!==d.row_disabled&&d.row_disabled),p=void 0!==d.row_required&&d.row_required,u=!r&&(void 0!==d.row_hidden&&d.row_hidden),m=void 0===d.groups_label||d.groups_label,v=void 0!==d.groups_label_label?d.groups_label_label:this.language("data_grid_groups_label"),g=void 0===d.groups_label_render||d.groups_label_render,b=void 0!==d.groups_label_render_label?d.groups_label_render_label:this.language("data_grid_groups_label_render"),w=void 0===d.groups_group||d.groups_group,y=void 0!==d.groups_group_label?d.groups_group_label:this.language("data_grid_groups_group"),S=void 0===d.groups_disabled||d.groups_disabled,W=void 0!==d.groups_auto_group&&d.groups_auto_group,F=m||W||w||S,k=(void 0!==d.rows_randomize&&d.rows_randomize,'<div id="wsf-data-grid-group-'+this.esc_attr(a)+'" class="wsf-data-grid-group" data-group-index="'+this.esc_attr(a)+'">');k+='<div class="wsf-data-grid-table-outer"><div class="wsf-data-grid-table-inner"><table class="wsf-data-grid-table"><thead>',k+=this.data_grid_html_row_header(i,a,f,h,p,u,o,r),k+="</thead><tbody>";for(var j=_*s;j<c&&(0==s||j<(_+1)*s);j++)k+=this.data_grid_html_row(l[j],a,j,f,h,p,u,o,r,n);k+="</tbody></table>",k+="</div>",r||(k+='<div data-action="wsf-data-grid-row-add"><div'+this.tooltip(this.language("data_grid_row_add"),"left")+">"+this.svg("plus-circle")+"</div></div>"),k+="</div>",k+='<ul class="wsf-data-grid-pagination"></ul>',k+='<ul class="wsf-data-grid-footer wsf-list-inline">',r||(k+="<li>",k+='<label class="wsf-label wsf-label-small">'+this.language("data_grid_row_bulk_actions")+"</label>",k+='<div class="wsf-field-inline">',k+='<select class="wsf-field wsf-field-small">',k+='<option value="">'+this.language("data_grid_row_bulk_actions_select")+"</option>",f&&(k+='<option value="default">'+this.language("data_grid_row_bulk_actions_default")+"</option>",k+='<option value="default_off">'+this.language("data_grid_row_bulk_actions_default_off")+"</option>"),p&&(k+='<option value="required">'+this.language("data_grid_row_bulk_actions_required")+"</option>",k+='<option value="required_off">'+this.language("data_grid_row_bulk_actions_required_off")+"</option>"),h&&(k+='<option value="disabled">'+this.language("data_grid_row_bulk_actions_disabled")+"</option>",k+='<option value="disabled_off">'+this.language("data_grid_row_bulk_actions_disabled_off")+"</option>"),u&&(k+='<option value="hidden">'+this.language("data_grid_row_bulk_actions_hidden")+"</option>",k+='<option value="hidden_off">'+this.language("data_grid_row_bulk_actions_hidden_off")+"</option>"),k+='<option value="delete">'+this.language("data_grid_row_bulk_actions_delete")+"</option>",k+="</select>",k+='<button class="wsf-button wsf-button-primary wsf-button-small" data-action="wsf-data-grid-bulk-action" disabled>'+this.language("data_grid_row_bulk_actions_apply")+"</button>",k+="</div>",k+="</li>"),k+="<li>",k+='<label class="wsf-label wsf-label-small">'+this.language("data_grid_rows_per_page")+"</label>",k+='<div class="wsf-field-inline">',k+='<select class="wsf-field wsf-field-small">',k+='<option value="0">'+this.language("data_grid_rows_per_page_0")+"</option>";var x=t.WS_Form.settings_form.data_grid.rows_per_page_options;for(var O in x)x.hasOwnProperty(O)&&(k+='<option value="'+this.esc_attr(O)+'"'+(O==s?" selected":"")+">"+this.esc_html(x[O])+"</option>");return k+="</select>",k+='<button class="wsf-button wsf-button-primary wsf-button-small" data-action="wsf-data-grid-rows-per-page" disabled>'+this.language("data_grid_rows_per_page_apply")+"</button>",k+="</div>",k+="</li>",!r&&F&&(k+='<li class="wsf-flex-none"><div data-action="wsf-data-grid-settings"'+this.tooltip(this.language("data_grid_settings"),"top-right")+">"+this.svg("settings")+"</div></li>"),k+="</ul>",!r&&F&&(k+='<div class="wsf-data-grid-settings-wrapper">',k+='<div class="wsf-data-grid-settings">',m&&(k+='<label for="wsf-data-grid-group-label-'+this.esc_attr(a)+'" class="wsf-label">'+this.esc_html(v)+"</label>",k+='<input type="text" id="wsf-data-grid-group-label-'+this.esc_attr(a)+'" class="wsf-field" data-text="label" value="'+this.esc_attr(e.label)+'" maxlength="1024" />'),w&&(k+='<input type="checkbox" id="wsf-data-grid-mask_group-'+this.esc_attr(a)+'" class="wsf-field" data-children="wsf-data-grid-groups-group-'+this.esc_attr(a)+'" data-checkbox="mask_group"'+(e.mask_group?" checked":"")+" />",k+='<label for="wsf-data-grid-mask_group-'+this.esc_attr(a)+'" class="wsf-label">'+this.esc_html(y)+"</label>"),k+='<div id="wsf-data-grid-groups-group-'+this.esc_attr(a)+'" class="wsf-field-indent">',m&&g&&(k+='<input type="checkbox" id="wsf-data-grid-group-label-render-'+this.esc_attr(a)+'" class="wsf-field" data-checkbox="label_render"'+(e.label_render?" checked":"")+" />",k+='<label for="wsf-data-grid-group-label-render-'+this.esc_attr(a)+'" class="wsf-label">'+this.esc_html(b)+"</label>"),S&&(k+='<input type="checkbox" id="wsf-data-grid-disabled-'+this.esc_attr(a)+'" class="wsf-field" data-checkbox="disabled"'+(e.disabled?" checked":"")+" />",k+='<label for="wsf-data-grid-disabled-'+this.esc_attr(a)+'" class="wsf-label">'+this.language("data_grid_group_disabled")+"</label>"),k+="</div>",W&&(k+='<label for="wsf-data-grid-auto-group-'+this.esc_attr(a)+'" class="wsf-label">'+this.language("data_grid_group_auto_group")+"</label>",k+='<select id="wsf-data-grid-auto-group-'+this.esc_attr(a)+'" class="wsf-field" data-action="wsf-data-grid-auto-group"></select>'),k+="</div>",k+="</div>"),k+="</div>\n\n"},t.WS_Form.prototype.data_grid_html_row_header=function(e,a,i,s,o,r,n,d){var _=t.WS_Form.meta_keys[n],l=void 0!==_.max_columns?_.max_columns:0,c=void 0!==_.type_sub&&_.type_sub,f=void 0!==_.read_only_header&&_.read_only_header,h="<tr>";if(!d){var p="wsf-data-grid-bulk-"+n+"-"+a;h+='<th data-fixed-sort class="wsf-data-grid-icon"></th>',h+='<th data-fixed-select class="wsf-data-grid-checkbox"><input id="'+this.esc_attr(p)+'" class="wsf-field" data-action="wsf-data-grid-row-select-all" type="checkbox" /><label for="'+this.esc_attr(p)+'" class="wsf-label"></label></th>'}var u=0;for(var m in e)if(e.hasOwnProperty(m)&&"function"!=typeof e[m]){var v=e[m],g=v.id,b=v.label;if(h+='<th><input type="text" class="wsf-field wsf-field-small" data-id="'+this.esc_attr(g)+'" data-column="'+this.esc_attr(m)+'" data-action="wsf-data-grid-column-label" value="'+this.esc_attr(b)+'"'+(d||f?" readonly":"")+"/>",!d&&e.length>1&&(l>1||0==l)&&(h+='<div data-action="wsf-data-grid-column-delete" data-id="'+this.esc_attr(g)+'"'+this.tooltip(this.language("data_grid_column_delete"),"bottom-center")+">"+this.svg("delete-circle")+"</div>"),h+="</th>",u++,l>0&&u==l)break}return!1!==c&&(h+="<th data-fixed-icon></th>",h+="<th data-fixed-icon></th>"),!1!==c&&(h+="<th data-fixed-icon></th>"),i&&(h+="<th data-fixed-icon></th>"),o&&(h+="<th data-fixed-icon></th>"),s&&(h+="<th data-fixed-icon></th>"),r&&(h+="<th data-fixed-icon></th>"),!d&&(0==l||e.length<l)&&(h+='<th data-fixed-icon><div data-action="wsf-data-grid-column-add"'+this.tooltip(this.language("data_grid_column_add"),"top-right")+">"+this.svg("plus-circle")+"</div></th>"),h+="</tr>"},t.WS_Form.prototype.data_grid_html_row=function(e,a,i,s,o,r,n,d,_,l){var c=t.WS_Form.meta_keys[d],f=void 0!==c.max_columns?c.max_columns:0,h=void 0!==c.type_sub&&c.type_sub,p=(void 0!==c.conditional&&c.conditional,void 0!==c.insert_image&&c.insert_image&&!_);if(null===e||"object"!=typeof e||"object"!=typeof e.data)return"";var u=e.data;if(void 0===u.length)return"";var m=u.length,v='<tr data-index="'+this.esc_attr(i)+'">';if(!_){var g="wsf-data-grid-bulk-"+d+"-"+a+"-"+i;v+='<td data-fixed-sort><div data-action="wsf-data-grid-row-sort"'+this.tooltip(this.language("data_grid_row_sort"),"top-left")+">"+this.svg("sort")+"</div></td>";var b="object"==typeof l&&-1!==l.indexOf(i);v+='<td data-fixed-select><input data-action="wsf-data-grid-row-select" id="'+this.esc_attr(g)+'" class="wsf-field" type="checkbox" tabindex="-1"'+(b?" checked":"")+' /><label for="'+this.esc_attr(g)+'" class="wsf-label"></label></td>'}for(var w=0;w<m;w++){var y=u[w];if(v+="<td"+(p?" data-insert-image":"")+'><input class="wsf-field wsf-field-small" type="text" data-column="'+this.esc_attr(w)+'" value="'+this.esc_attr(y)+'"'+(_?" readonly":"")+" />",p&&(v+='<div data-action="wsf-insert-image"'+this.tooltip(this.language("data_grid_insert_image"),"left")+">"+this.svg("file-picture")+"</div>"),v+="</td>",f>0&&w==f-1)break}return!1!==h&&(v+='<td data-fixed-icon><div data-action="wsf-data-grid-'+this.esc_attr(h)+'-edit"'+this.tooltip(this.language("data_grid_"+h+"_edit"),"top-center")+">"+this.svg("edit")+"</div></td>",v+='<td data-fixed-icon><div data-action="wsf-data-grid-'+this.esc_attr(h)+'-clone"'+this.tooltip(this.language("data_grid_"+h+"_clone"),"top-center")+">"+this.svg("clone")+"</div></td>"),s&&(v+='<td data-fixed-icon><div data-attribute="default" data-status="'+(e.default?"on":"")+'"'+(_?" data-read-only":"")+this.tooltip(this.language("data_grid_row_default"),"top-center")+">"+this.svg("check")+"</div></td>"),r&&(v+='<td data-fixed-icon><div data-attribute="required" data-status="'+(e.required?"on":"")+'"'+(_?" data-read-only":"")+this.tooltip(this.language("data_grid_row_required"),"top-center")+">"+this.svg("asterisk")+"</div></td>"),o&&(v+='<td data-fixed-icon><div data-attribute="disabled" data-status="'+(e.disabled?"on":"")+'"'+(_?" data-read-only":"")+this.tooltip(this.language("data_grid_row_disabled"),"top-center")+">"+this.svg("disabled")+"</div></td>"),n&&(v+='<td data-fixed-icon><div data-attribute="hidden" data-status="'+(e.hidden?"on":"")+'"'+(_?" data-read-only":"")+this.tooltip(this.language("data_grid_row_hidden"),"top-center")+">"+this.svg("visible")+this.svg("hidden")+"</div></td>"),_||(v+='<td data-fixed-icon><div data-action="wsf-data-grid-row-delete"'+this.tooltip(this.language("data_grid_row_delete"),"top-right")+">"+this.svg("delete-circle")+"</div></td>"),v+="</tr>\n"},t.WS_Form.prototype.sidebar_data_grids_init=function(e){t(".wsf-data-grid:not(.wsf-data-grid-initialized)",e).each(function(e,a){t.WS_Form.this.data_grid_init(t(this),a)})},t.WS_Form.prototype.data_grid_settings_children=function(e,a){var i=a.is(":checked"),s=a.attr("data-children");if(s){var o=s.split(",");for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];i?t("#"+n,e).show():t("#"+n,e).hide()}}},t.WS_Form.prototype.data_grid_init=function(e,a){a.render=function(i,s,o){void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===o&&(o=!1);var r=e.attr("data-object"),n=e.attr("data-id"),d=e.attr("data-meta-key"),_=void 0!==(p=t.WS_Form.meta_keys[d]).type_sub&&p.type_sub,l=void 0!==p.data_source&&p.data_source,c=t.WS_Form.this.get_object_data(r,n,!0);if(!1===c&&t.WS_Form.this.error("error_object_data"),""===(f=t.WS_Form.this.get_object_meta_value(c,d,"",!0))){var f=t.extend(!0,{},p.default);t.WS_Form.this.set_object_meta_value(c,d,f)}f=t.WS_Form.this.data_grid_optimize(f);var h=t.WS_Form.this.get_data_source_id(c);e.html(t.WS_Form.this.data_grid_html(d,f,h,i,o));var p,u=!1;if(l&&t.WS_Form.this.data_source_render(e,a),!i){if(!1!==s){var m=t('tr[data-index="'+t.WS_Form.this.esc_selector(s)+'"] td input[type="text"]').first();m.val()?m.trigger("select"):m.trigger("focus")}t('[data-action="wsf-data-grid-auto-group"]',e).on("change",function(){var e=t(this).val(),i=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),s=t.extend(!0,{},f.groups[i]),o=s.rows,r=[];for(var n in o)if(o.hasOwnProperty(n)){var d=o[n].data[e];void 0===d&&(d=""),void 0===r[d]&&(r[d]=t.extend(!0,{},s),r[d].label=""==d?t.WS_Form.this.language("data_grid_group_label_default"):d,r[d].rows=[],r[d].mask_group="on",r[d].page="0",r[d].disabled=""),r[d].rows.push(o[n])}for(var _ in f.groups=[],r)r.hasOwnProperty(_)&&f.groups.push(r[_]);f.groups.sort(function(t,e){return t.label===e.label||(t.label<e.label?-1:1)}),f.group_index=0,a.render()}),t(".wsf-data-grid-groups table",e).each(function(){for(var e=0,a=t("th[data-fixed-icon]",t(this)),i=0;i<a.length;i++)e+=t(a[i]).outerWidth();var s=e;ws_form_settings.rtl?t(this).css({"padding-right":"47px","padding-left":s+"px"}):t(this).css({"padding-left":"47px","padding-right":s+"px"})}),t(".wsf-data-grid-group",e).on("dragenter",function(a){a.stopPropagation(),a.preventDefault(),t.WS_Form.this.drag_is_file(a)&&t(".wsf-data-grid-upload-csv-window",e).show()}),t(".wsf-data-grid-upload-csv-window",e).on("dragover",function(t){t.stopPropagation(),t.preventDefault()}),t(".wsf-data-grid-upload-csv-window",e).on("drop",function(a){a.preventDefault();var i=a.originalEvent.dataTransfer.files;t.WS_Form.this.data_grid_upload_csv(r,n,d,i,t(this),function(){t(".wsf-data-grid-upload-csv-window",e).hide()})}),t(".wsf-data-grid-upload-csv-window",e).on("dragleave",function(a){t(".wsf-data-grid-upload-csv-window",e).hide()}),t('[data-action="wsf-data-grid-upload"]',e).on("click",function(){t('input[id="wsf-data-grid-upload-file"]',e).trigger("click")}),t('input[id="wsf-data-grid-upload-file"]',e).on("change",function(){var a=t('input[id="wsf-data-grid-upload-file"]',e).prop("files");if(a.length>0){var i=t(".wsf-data-grid-upload-csv-window",e);i.show(),t.WS_Form.this.data_grid_upload_csv(r,n,d,a,i)}}),void 0!==p.insert_image&&p.insert_image&&t('[data-action="wsf-insert-image"]',e).on("click",function(){t.WS_Form.this.file_frame_input_obj=t("input",t(this).closest("td")),t.WS_Form.this.file_frame?t.WS_Form.this.file_frame.open():(t.WS_Form.this.file_frame=wp.media.frames.file_frame=wp.media({title:"Select image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}),t.WS_Form.this.file_frame.on("select",function(){var e=t.WS_Form.this.file_frame.state().get("selection").first().toJSON(),a=e.url,i=e.alt,s=e.width,o=e.height,r="<img"+(s?' width="'+t.WS_Form.this.esc_attr(s)+'"':"")+(o?' height="'+t.WS_Form.this.esc_attr(o)+'"':"")+(i?' alt="'+t.WS_Form.this.esc_attr(i)+'"':"")+' src="'+t.WS_Form.this.esc_attr(a)+'" />';t.WS_Form.this.file_frame_input_obj.val(r).trigger("input")}),t.WS_Form.this.file_frame.open())})}if(t('[data-action="wsf-data-grid-download"]',e).on("click",function(){var a=t(t(".wsf-data-grid-group-tabs .ui-tabs-active").find("a").attr("href"),e).attr("data-group-index");t.WS_Form.this.data_grid_download_csv(r,n,d,a)}),i||(t('[data-action="wsf-data-grid-action-edit"]',e).on("click",function(){t.WS_Form.this.data_grid_row_open(t(this),"action",f)}),t('[data-action="wsf-data-grid-action-clone"]',e).on("click",function(i){t.WS_Form.this.action_save(),t.WS_Form.this.data_grid_row_clone(t(this),e,r,n,a,f,_)}),t("[data-attribute]",e).on("click",function(){var a=t(this).attr("data-attribute"),i=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),s=f.groups[i],o=s.rows,r="on"==t(this).attr("data-status"),n=1==e.closest(".wsf-sidebar").find('[data-meta-key="multiple"]:checked').length;switch(a){case"default":var d=void 0!==p.row_default_multiple&&p.row_default_multiple;n=n||d;break;case"required":var _=void 0!==p.row_required_multiple&&p.row_required_multiple;n=n||_;break;case"disabled":case"hidden":n=!0}if(!n)for(var l in t('.wsf-data-grid-group [data-attribute="'+t.WS_Form.this.esc_selector(a)+'"]',t(this).closest(".wsf-data-grid-groups")).attr("data-status",""),f.groups)if(f.groups.hasOwnProperty(l)){var c=f.groups[l].rows;for(var h in c)c.hasOwnProperty(h)&&delete c[h][a]}if(r){t(this).attr("data-status","");var u=""}else{t(this).attr("data-status","on");u="on"}var m=s.page*f.rows_per_page+t(this).closest("tr").index();""==u?delete o[m][a]:o[m][a]=u}),t('[data-action="wsf-data-grid-settings"]',e).on("click",function(){var a=t(".wsf-data-grid-settings-wrapper",e),i=t(".wsf-data-grid-settings",e);i.is(":visible")?(t(this).removeClass("wsf-editing"),a.removeClass("wsf-data-grid-settings-open"),i.slideUp()):(t(this).addClass("wsf-editing"),a.addClass("wsf-data-grid-settings-open"),i.slideDown())}),t("input[data-checkbox][data-children]",e).each(function(){t.WS_Form.this.data_grid_settings_children(e,t(this))}),t("input[data-checkbox]",e).on("change",function(){var a=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),i=f.groups[a],s=t(this).attr("data-checkbox"),o=t(this).is(":checked");i[s]=o?"on":"",t.WS_Form.this.data_grid_settings_children(e,t(this))}),t("input[data-text]",e).on("input",function(){var a=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),i=f.groups[a],s=t(this).attr("data-text"),o=""!=t(this).val()?t(this).val():t.WS_Form.this.language("data_grid_group_label_default");i[s]=o,t('.wsf-data-grid-group-tab a[href="#wsf-data-grid-group-'+t.WS_Form.this.esc_selector(a)+'"], .wsf-data-grid-group-tab span',e).html(t.WS_Form.this.esc_html(o))})),t('[data-action="wsf-data-grid-rows-per-page"]',e).on("click",function(){var e=parseInt(t(this).siblings("select").first().val(),10);t.WS_Form.this.data_grid_group_rows_per_page_set(f,e,r,n,d,function(){a.render(i)})}),t('[data-action="wsf-data-grid-rows-per-page"]',e).each(function(){t(this).siblings("select").first().on("change",function(){t('[data-action="wsf-data-grid-rows-per-page"]',e).prop("disabled",!1)})}),t(".wsf-data-grid-pagination",e).each(function(){var e=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),s=f.groups[e],o=f.rows_per_page,_=0==o?0:parseInt(s.page,10),l=s.rows,c=l.length,h=0==o?1:Math.ceil(c/o);if(_*o>=c&&c>0&&(_=h-1,t.WS_Form.this.data_grid_group_page_set(s,e,_,r,n,d,function(){u=!0})),h>1){var p=h-1,m=_>0?_-1:_,v=_<p?_+1:_,g=0==_?' class="disabled"':"",b=_==p?' class="disabled"':"",w='<li data-page="'+t.WS_Form.this.esc_attr(0)+'"'+g+"><div>"+t.WS_Form.this.svg("first")+"</div></li>";w+='<li data-page="'+t.WS_Form.this.esc_attr(m)+'"'+g+"><div>"+t.WS_Form.this.svg("previous")+"</div></li>";var y=_-4;y<0&&(y=0);var S=_+4;S>p&&(S=p);for(var W=y;W<S+1;W++)w+="<li"+(W==_?' class="active"':"")+' data-page="'+t.WS_Form.this.esc_attr(W)+'"><div>'+(W+1)+"</div></li>";w+='<li data-page="'+t.WS_Form.this.esc_attr(v)+'"'+b+"><div>"+t.WS_Form.this.svg("next")+"</div></li>",w+='<li data-page="'+t.WS_Form.this.esc_attr(p)+'"'+b+"><div>"+t.WS_Form.this.svg("last")+"</div></li>",t(this).prepend(w),t("li[data-page]",t(this)).on("click",function(){var o=t(this).attr("data-page");_!=o&&t.WS_Form.this.data_grid_group_page_set(s,e,o,r,n,d,function(){a.render(i)})})}else t(this).remove()}),u)return a.render(i),!1;if((p=t.WS_Form.meta_keys[d]).groups_group){var v=f.group_index;t(".wsf-data-grid-groups",e).tabs({active:v,activate:function(a,s){i||t("table.wsf-data-grid-table",e).sortable("refreshPositions");var o=s.newTab.index();f.group_index=o;var _=t.WS_Form.this.get_object_data(r,n);!1===_&&t.WS_Form.this.error("error_object_data");var l=t.WS_Form.this.get_object_meta_value(_,d,!1);if(!1===l&&t.WS_Form.this.error("error_object_meta_value"),void 0!==l.groups[o]){t.WS_Form.this.loader_on(),l.group_index=o;var c={form_id:t.WS_Form.this.form_id};c[r]=_,c[r].history_suppress="on",t.WS_Form.this.api_call(r+"/"+n+"/put/","POST",c,function(e){t.WS_Form.this.loader_off()})}}}),i||(t(".wsf-data-grid-group-tabs",e).sortable({cursor:"move",containment:"parent",scroll:!1,forceHelperSize:!0,placeholder:"wsf-data-grid-group-tab-placeholder",cancel:".wsf-ui-cancel",items:"li:not(.wsf-ui-cancel)",start:function(e,a){t.WS_Form.data_grid_group_tab_index_dragged_from=a.helper.index();var i=["height: "+a.helper.height()+"px","width: "+a.helper.outerWidth()+"px"].join(";");a.placeholder.attr("style",i)},stop:function(e,a){var i=t.WS_Form.this.get_object_meta_value(c,d);!1===i&&t.WS_Form.this.error("error_object_meta_value");var s=i.groups,o=t.WS_Form.data_grid_group_tab_index_dragged_from,r=a.item.index();if(r>=s.length)for(var n=r-s.length;1+n--;)s.push(void 0);s.splice(r,0,s.splice(o,1)[0])}}),t('[data-action="wsf-data-grid-group-add"]',e).on("click",function(){if(void 0!==f.groups[0]){var e=t.extend(!0,{},f.groups[0]);e.rows=[],e.label=t.WS_Form.this.language("data_grid_group_label_default"),e.disabled="",e.mask_group="",e.label_render="",f.groups.push(e),f.group_index=f.groups.length-1,a.render()}else t.WS_Form.this.error("error_data_grid_default_group")}),t('[data-action="wsf-data-grid-group-delete"]',e).on("click",function(){var e=t(this).closest("li"),i=e.index(),s=f.groups,o=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_data_grid_group_delete"),o,e,function(){delete s[i],f.groups=t.WS_Form.this.array_remove_empty(s),--i<0&&(i=0),f.group_index=i,a.render()})}))}i||(t('[data-action="wsf-data-grid-column-add"]',e).on("click",function(){var i=f.columns,s=0;for(var o in i)i.hasOwnProperty(o)&&i[o].id>s&&(s=i[o].id);var _={id:++s,label:t.WS_Form.this.language("data_grid_column_label_default")};f.columns.push(_);var l=f.groups;for(var c in l)if(l.hasOwnProperty(c)){var h=l[c].rows;for(var p in h)if(h.hasOwnProperty(p)){var u=h[p];null!==u&&u.data.push("")}}t.WS_Form.this.data_grid_update_mask_row_lookups(r,n,d);var m=t(".wsf-data-grid-table-inner",e).scrollLeft();a.render();var v=t(".wsf-data-grid-table-inner thead th:not('[data-fixed-icon]'):last",e),g=v.outerWidth();t(".wsf-data-grid-table-inner",e).scrollLeft(m).animate({scrollLeft:m+g},200),t("input",v).trigger("select")}),t('[data-action="wsf-data-grid-column-delete"]',e).on("click",function(){var i=t(this).closest("th"),s=t(this).attr("data-id"),o=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_data_grid_column_delete"),o,i,function(){var o=f.columns;for(var _ in o)if(o.hasOwnProperty(_)&&parseInt(o[_].id)==parseInt(s,10)){delete o[_],f.columns=t.WS_Form.this.array_remove_empty(f.columns);break}if(!1!==_){var l=f.groups;for(var c in l)if(l.hasOwnProperty(c)){var h=l[c].rows;for(var p in h)if(h.hasOwnProperty(p)){var u=h[p];null!==u&&(delete u.data[_],u.data=t.WS_Form.this.array_remove_empty(u.data))}}}t.WS_Form.this.data_grid_update_mask_row_lookups(r,n,d);var m=t(".wsf-data-grid-table-inner",e).scrollLeft(),v=i.outerWidth();a.render(),t(".wsf-data-grid-table-inner",e).scrollLeft(m).animate({scrollLeft:m-v},200)})}),t('[data-action="wsf-data-grid-column-label"]',e).on("keydown input",function(e){if(13===(e.keyCode||e.which))return t(this).trigger("blur"),!1;var a=t(this).attr("data-column"),i=(f.columns[a],""!=t(this).val()?t(this).val():t.WS_Form.this.language("data_grid_column_label_default"));f.columns[a].label=i,t.WS_Form.this.data_grid_update_mask_row_lookups(r,n,d)}),t('td input[type="text"]',e).on("keydown input",function(a){if(13===(a.keyCode||a.which)){var i=t('input[type="text"]',e),s=i.index(this);return void 0!==i[s+1]&&t(i[s+1]).trigger("focus"),!1}var o=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),r=f.groups[o],n=r.page*f.rows_per_page+t(this).closest("tr").index(),d=t(this).attr("data-column");r.rows[n].data[d]=t(this).val()}),t("table.wsf-data-grid-table",e).sortable({items:"tbody tr",containment:"parent",cursor:"move",tolerance:"pointer",handle:'[data-action="wsf-data-grid-row-sort"]',axis:"y",cancel:".wsf-ui-cancel, input[type=text]:not([readonly])",start:function(a,i){t("table.wsf-data-grid-table",e).sortable("refreshPositions"),t.WS_Form.data_grid_index_dragged_from=i.helper.index()},stop:function(e,a){var i=t.WS_Form.this.get_object_meta_value(c,d);!1===i&&t.WS_Form.this.error("error_object_meta_value");var s=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),o=i.groups[s],r=o.page*i.rows_per_page,n=r+t.WS_Form.data_grid_index_dragged_from,_=r+a.item.index(),l=o.rows;if(_>=l.length)for(var f=_-l.length;1+f--;)l.push(void 0);l.splice(_,0,l.splice(n,1)[0])}}),t('[data-action="wsf-data-grid-row-add"] div',e).on("click",function(){var e=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),s=f.groups[e],o=f.rows_per_page,l=0==o?0:s.page,c=f.columns.length;null!==s.rows&&"object"==typeof s.rows||(s.rows=[]);var h=s.rows;switch(_){case"conditional":var p=[t.WS_Form.this.language("conditional_label_default"),JSON.stringify(t.WS_Form.this.conditional_new())];break;case"action":p=[t.WS_Form.this.language("action_label_default"),JSON.stringify(t.WS_Form.this.action_new())];break;default:p=new Array(c).join(".").split(".")}var u={id:t.WS_Form.this.data_grid_row_next_id(f),data:p};h.push(u);var m=h.length,v=(0==o?1:Math.ceil(m/o))-1;if(l!=v?t.WS_Form.this.data_grid_group_page_set(s,e,v,r,n,d,function(){a.render(i,m-1)}):a.render(i,m-1),!1!==_){var g=t('[data-action="wsf-data-grid-'+_+'-edit"]',g).last();t.WS_Form.this.data_grid_row_open(g,_,f)}}),t('[data-action="wsf-data-grid-row-delete"]',e).on("click",function(){var e=t(this).closest("tr"),i=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}],s=function(){var i=e.closest(".wsf-data-grid-group").attr("data-group-index"),s=f.groups[i],o=0==r?0:s.page,r=f.rows_per_page,n=o*r+e.index();delete s.rows[n],s.rows=t.WS_Form.this.array_remove_empty(s.rows),a.render()};!1!==_?t.WS_Form.this.popover(t.WS_Form.this.language("confirm_"+_+"_delete"),i,e,s):s(),e.siblings("tr.wsf-ui-cancel").removeClass("wsf-ui-cancel")}),t('[data-action="wsf-data-grid-bulk-action"]',e).on("click",function(){var i=t(this).siblings("select").first().val(),s=t(this).closest(".wsf-data-grid-group").find('input[data-action="wsf-data-grid-row-select"]:checked',e).closest("tr"),o=t(this).closest(".wsf-data-grid-group").attr("data-group-index"),r=f.groups[o],n=r.page*f.rows_per_page,d=[];switch(i){case"delete":s.each(function(){var e=n+t(this).index();delete r.rows[e]}),r.rows=t.WS_Form.this.array_remove_empty(r.rows);break;case"default":case"disabled":case"required":case"hidden":s.each(function(){var e=n+t(this).index();r.rows[e][i]="on",d.push(e)});break;case"default_off":case"disabled_off":case"required_off":case"hidden_off":i=i.replace("_off",""),s.each(function(){var e=n+t(this).index();delete r.rows[e][i],d.push(e)})}a.render(!1,!1,d)}),t('[data-action="wsf-data-grid-row-select-all"]',e).on("change",function(){var a=t(this).closest("table");t(this).is(":checked")?t('input[data-action="wsf-data-grid-row-select"]',a).prop("checked",!0):t('input[data-action="wsf-data-grid-row-select"]',a).prop("checked",!1),t.WS_Form.this.data_grid_bulk_action_button(e,r,n,d)}),t('[data-action="wsf-data-grid-row-select"]',e).on("change",function(){t.WS_Form.this.data_grid_bulk_action_button(e,r,n,d)}),e.closest(".wsf-sidebar").find('[data-meta-key="multiple"]').on("change",function(){t.WS_Form.this.data_grid_bulk_action_button(e,r,n,d,!0,a)}),t.WS_Form.this.data_grid_bulk_action_button(e,r,n,d)),t.WS_Form.this.data_grid_update_mask_row_lookups(r,n,d),e.addClass("wsf-data-grid-initialized")},a.render();var i=e.attr("data-object"),s=e.attr("data-id"),o=e.attr("data-meta-key"),r=t.WS_Form.meta_keys[o];if(void 0!==r.data_source&&r.data_source){var n=t.WS_Form.this.get_object_data(i,s,!0);!1===n&&t.WS_Form.this.error("error_object_data"),""!=t.WS_Form.this.get_data_source_id(n)&&t(".wsf-data-grid-groups",e).hide()}},t.WS_Form.prototype.data_grid_optimize=function(e){if(null===e||"object"!=typeof e||"object"!=typeof e.groups)return e;var a=e.groups;for(var i in a)if(a.hasOwnProperty(i)){var s=a[i];if(null!==s&&"object"==typeof s&&"object"==typeof s.rows){var o=s.rows;for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];null!==n&&"object"==typeof n&&"object"==typeof n.data?(void 0!==n.default&&""==n.default&&delete e.groups[i].rows[r].default,void 0!==n.required&&""==n.required&&delete e.groups[i].rows[r].required,void 0!==n.hidden&&""==n.hidden&&delete e.groups[i].rows[r].hidden,void 0!==n.disabled&&""==n.disabled&&delete e.groups[i].rows[r].disabled):delete e.groups[i].rows[r]}e.groups[i].rows=t.WS_Form.this.array_remove_empty(e.groups[i].rows)}else delete e.groups[i]}return e.groups=t.WS_Form.this.array_remove_empty(e.groups),e},t.WS_Form.prototype.get_data_source_id=function(e){var a=t.WS_Form.this.get_object_meta_value(e,"data_source_id","");return void 0===t.WS_Form.data_sources[a]&&(a=""),a},t.WS_Form.prototype.data_source_render=function(e,a){var i=e.attr("data-object"),s=e.attr("data-id"),o=e.attr("data-meta-key"),r=(void 0!==(l=t.WS_Form.meta_keys[o]).data_source&&l.data_source,t.WS_Form.this.get_object_data(i,s,!0));!1===r&&t.WS_Form.this.error("error_object_data");t.WS_Form.this.get_object_meta_value(r,o,"",!0);var n=t.WS_Form.this.get_data_source_id(r),d=t.WS_Form.data_sources[n];if(void 0===d.fieldsets||void 0===d.fieldsets[n]||void 0===d.fieldsets[n].meta_keys)return t("#wsf-data-source-meta",e).html(""),void t(".wsf-data-grid-groups",e).show();for(var _ in d.fieldsets[n].meta_keys)if(d.fieldsets[n].meta_keys.hasOwnProperty(_)){o=d.fieldsets[n].meta_keys[_];if(void 0!==t.WS_Form.meta_keys[o]&&void 0===r.meta[o]){var l,c=void 0!==(l=t.WS_Form.meta_keys[o]).default?l.default:"";r.meta[o]=c}}var f=this.sidebar_html(i,s,r,d,!1,!1,!0,!1,!1);t("#wsf-data-source-meta",e).html(f.html),t('[data-meta-key="data_source_id"]',e).on("change",function(){var s=t(this).val();t.WS_Form.this.object_data_update_by_meta_key(i,r,"data_source_id"),e.removeAttr("data-sidebar-conditions-init"),t.WS_Form.this.data_source_render(e,a),""!=s?t(".wsf-data-grid-groups",e).hide():a.render(),t.WS_Form.this.data_source_last_api_error_clear(r)}),t('[data-meta-key="data_source_get"]').on("click",function(){t.WS_Form.this.data_source_get(e)}),this.sidebar_inits(f.inits,e,e,r)},t.WS_Form.prototype.data_source_last_api_error_clear=function(e){""!==t.WS_Form.this.get_object_meta_value(e,"data_source_last_api_error","")&&t.WS_Form.this.api_call("field/"+e.id+"/last-api-error/clear/","POST",!1,function(){t('.wsf-field-wrapper[data-id="'+t.WS_Form.this.esc_selector(e.id)+'"] .wsf-data-source-error').remove(),t.WS_Form.this.loader_off()})},t.WS_Form.prototype.data_source_get=function(e,a,i){void 0===a&&(a=1);var s=e.attr("data-object"),o=e.attr("data-id"),r=e.attr("data-meta-key"),n=t.WS_Form.meta_keys[r],d=(void 0!==n.data_source&&n.data_source,t.WS_Form.this.get_object_data(s,o,!0));!1===d&&t.WS_Form.this.error("error_object_data");var _=t.WS_Form.this.get_object_meta_value(d,r,"",!0),l=t.WS_Form.this.get_data_source_id(d),c=t.WS_Form.data_sources[l];if(l){var f=["meta_key_value","meta_key_label","meta_key_price","meta_key_parse_variable"];for(var h in f)if(f.hasOwnProperty(h)){var p=f[h],u=void 0!==n[p]&&n[p];!1!==u&&this.object_data_update_by_meta_key(s,d,u)}if(void 0!==(c=t.WS_Form.data_sources[l]).endpoint_get&&void 0!==c.fieldsets&&void 0!==c.fieldsets[l]&&void 0!==c.fieldsets[l].meta_keys){var m={field_id:o,meta_key:r,meta_value:_,page:a};for(var v in c.fieldsets[l].meta_keys)if(c.fieldsets[l].meta_keys.hasOwnProperty(v)){var g=c.fieldsets[l].meta_keys[v];this.object_data_update_by_meta_key(s,d,g),void 0!==d.meta[g]&&(m[g]=d.meta[g])}if(this.object_data_update_by_meta_key(s,d,r),void 0===i)(i=new this.upload_status_bar(this,e,!0,!1,!1)).populate(c.label_retrieving),i.set_progress(0),t("h1",e).hide(),t(".wsf-data-grid-upload-csv-window",e).show(),t('[data-meta-key="data_source_get"]',e).prop("disabled",!0);t(".wsf-data-grid-groups",e).show(),t.WS_Form.this.loader_on(),this.api_call(c.endpoint_get,"POST",m,function(n){"object"!=typeof n.meta_value&&t.WS_Form.this.error("data_grid_data_source_error");var _=void 0!==n.max_num_pages?n.max_num_pages:1,l=_>1?Math.round(a/(_-1)*100):100;if(i.set_progress(l),1===a)t.WS_Form.this.object_data_scratch.meta[r]=n.meta_value;else for(var c in n.meta_value.groups){if(n.meta_value.groups.hasOwnProperty(c))if(void 0!==n.meta_value.groups[c].rows)for(var f in n.meta_value.groups[c].rows)if(n.meta_value.groups[c].rows.hasOwnProperty(f)){var h=n.meta_value.groups[c].rows[f];t.WS_Form.this.object_data_scratch.meta[r].groups[c].rows.push(h)}}if(a<_)t.WS_Form.this.data_source_get(e,++a,i);else{if("object"==typeof n.meta_keys)for(var p in n.meta_keys)n.meta_keys.hasOwnProperty(p)&&(t.WS_Form.this.object_data_scratch.meta[p]=n.meta_keys[p]);t.WS_Form.this.data_grid_update_mask_row_lookups(s,o,r);var u=void 0!==n.deselect_data_source_id?n.deselect_data_source_id:"";u&&(t.WS_Form.this.object_data_scratch.meta.data_source_id=""),i.set_progress(100),setTimeout(function(){e.closest(".wsf-data-grid")[0].render(!u)},200),t.WS_Form.this.data_source_last_api_error_clear(d),t.WS_Form.this.loader_off()}},function(a){void 0!==a.error_message&&t.WS_Form.this.data_source_error(d,a),e.closest(".wsf-data-grid")[0].render(!0),t(".wsf-data-grid-groups",e).hide(),t('[data-meta-key="data_source_get"]',e).prop("disabled",!1),t.WS_Form.this.loader_off()})}}},t.WS_Form.prototype.data_source_error=function(t,e){var a=[];a.push(this.language("data_grid_data_source_error_last_field",t.label+" ("+this.language("data_grid_data_source_error_last_field_id",t.id)+")")),a.push(this.language("data_grid_data_source_error_last_source",e.data_source_label)),a.push(this.language("data_grid_data_source_error_last_date",e.date)),a.push(this.language("data_grid_data_source_error_last_error",e.error_message));var i=a.join("<br />");this.error("data_grid_data_source_error_last",i)},t.WS_Form.prototype.data_grid_clear_rows=function(e){var a=t.WS_Form.meta_keys[e];if(void 0!==a.default){var i=this.get_object_meta_value(this.object_data_scratch,e,t.extend(!0,{},a.default));if("object"==typeof i.groups&&"object"==typeof i.groups[0]&&"object"==typeof i.groups[0].rows)for(var s in i.groups)i.groups[s].rows=[];this.set_object_meta_value(this.object_data_scratch,e,i)}},t.WS_Form.prototype.data_grid_row_open=function(e,a,i){if(t(".wsf-hidden-table-row").length){switch(t('[data-action="wsf-data-grid-row-sort"]').removeClass("wsf-ui-cancel"),a){case"action":this.action_save()}t(".wsf-hidden-table-row").remove();var s=e.hasClass("wsf-data-grid-row-open");if(t(".wsf-data-grid-row-open").removeClass("wsf-data-grid-row-open"),s)return}t('[data-action="wsf-data-grid-row-sort"]').addClass("wsf-ui-cancel"),e.addClass("wsf-data-grid-row-open");var o=e.closest(".wsf-data-grid-group").attr("data-group-index"),r=i.groups[o],n=r.rows[r.page*i.rows_per_page+e.closest("tr").index()],d=e.closest("tr");t("td",d).length;switch(t('<tr id="wsf-'+a+'-tr" class="wsf-hidden-table-row"><td></td><td></td><td class="wsf-hidden-table-cell"><div></div></td><td></td><td></td><td></td></tr>').insertAfter(d).css("display","table-row"),a){case"action":this.action_data=n.data,this.action_render_from_data()}},t.WS_Form.prototype.data_grid_row_clone=function(e,a,i,s,o,r,n){for(var d in this.object_meta_cache)if(this.object_meta_cache.hasOwnProperty(d)){var _=this.object_meta_cache[d].meta_key;this.object_data_update_by_meta_key(i,this.object_data_scratch,_)}var l=e.closest("tr"),c=l.closest(".wsf-data-grid-group"),f=c.attr("data-group-index"),h=r.groups[f];t(".wsf-hidden-table-row",c).remove();var p=0==m?0:h.page,u=h.rows,m=r.rows_per_page,v=p*m+l.index(),g=t.extend(!0,{},u[v]);g.id=t.WS_Form.this.data_grid_row_next_id(r),g.data[0]=g.data[0]+" (Copy)",u.splice(v+1,0,g);var b=[];for(var w in u)b.push(u[w]);v++;var y=(u=b).length,S=(0==m?1:Math.ceil(y/m))-1;if(p!=S?this.data_grid_group_page_set(h,f,S,i,s,_,function(){o.render(!1,v)}):o.render(!1,v),!1!==n){var W=t('tr[data-index="'+this.esc_selector(v)+'"] td [data-action="wsf-data-grid-'+this.esc_selector(n)+'-edit"]',a).first();this.data_grid_row_open(W,n,r)}},t.WS_Form.prototype.data_grid_row_next_id=function(t){var e=0,a=t.groups;for(var i in a)if(a.hasOwnProperty(i)){var s=a[i].rows;for(var o in s)if(s.hasOwnProperty(o)){var r=s[o];if(null!==r){void 0===r.id&&this.error("error_data_grid_row_id");var n=parseInt(r.id,10);n>e&&(e=n)}}}return++e},t.WS_Form.prototype.data_grid_upload_csv=function(e,a,i,s,o,r){if(t("h1",o).hide(),0==s.length)return"function"==typeof r&&r(),!1;var n=new FormData;n.append("id",this.form_id),n.append("file",s[0]),n.append("meta_key",i),n.append(ws_form_settings.wsf_nonce_field_name,ws_form_settings.wsf_nonce);var d=new this.upload_status_bar(this,o);d.populate(s[0].name,s[0].size),this.data_grid_upload_csv_ajax(e,a,n,d,o,function(s){t.WS_Form.this.data_grid_upload_csv_complete(e,a,i,s.data,o)})},t.WS_Form.prototype.data_grid_upload_csv_complete=function(e,a,i,s,o){s=t.WS_Form.this.data_grid_optimize(s),t.WS_Form.this.object_data_scratch.meta[i]=s,t.WS_Form.this.data_grid_update_mask_row_lookups(e,a,i,!0),o.closest(".wsf-data-grid")[0].render()},t.WS_Form.prototype.data_grid_download_csv=function(e,a,i,s,o){if(void 0===o&&(o=!0),o){var r=t.WS_Form.this.get_object_data(e,a,!0);!1===r&&t.WS_Form.this.error("error_object_data");var n=t.WS_Form.this.get_object_meta_value(r,i,!1);!1===n&&t.WS_Form.this.error("error_object_meta_value");var d=encodeURIComponent(JSON.stringify(n))}var _='<form id="wsf-data-grid-downloader" action="'+this.esc_attr(ws_form_settings.url_ajax+e+"/"+a)+'/download/csv" method="post">';_+='<input type="hidden" name="form_id" value="'+this.esc_attr(this.form_id)+'" />',_+='<input type="hidden" name="meta_key" value="'+this.esc_attr(i)+'" />',_+='<input type="hidden" name="group_index" value="'+this.esc_attr(s)+'" />',_+='<input type="hidden" name="_wpnonce" value="'+this.esc_attr(ws_form_settings.x_wp_nonce)+'" />',_+='<input type="hidden" name="'+this.esc_attr(ws_form_settings.wsf_nonce_field_name)+'" value="'+this.esc_attr(ws_form_settings.wsf_nonce)+'" />',o&&(_+='<input type="hidden" name="meta_value" value="'+this.esc_attr(d)+'" />'),_+="</form>";t("body").append(_);t("#wsf-data-grid-downloader").trigger("submit"),t("#wsf-data-grid-downloader").remove()},t.WS_Form.prototype.object_to_csv=function(t){var e=new Array;for(var a in t){var i=t[a];-1!=i.indexOf(",")&&(i='"'+(i=this.replace_all(i,/"/g,'""'))+'"'),e.push(i)}return e.join(",")+"\r\n"},t.WS_Form.prototype.data_grid_upload_csv_ajax=function(e,a,i,s,o,r){var n=ws_form_settings.url_ajax+e+"/"+a+"/upload/csv",d=t.ajax({beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",ws_form_settings.x_wp_nonce)},xhr:function(){var e=t.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(t){var e=0,a=t.loaded||t.position,i=t.total;t.lengthComputable&&(e=Math.ceil(a/i*100)),s.set_progress(e)},!1),e},url:n,type:"POST",contentType:!1,processData:!1,cache:!1,data:i,success:function(t){s.set_progress(100),"function"==typeof r&&r(t)},error:function(e){o.hide(),t.WS_Form.this.api_call_error_handler(e,n,error_callback)}});s.set_abort(d)},t.WS_Form.prototype.upload_status_bar=function(e,a,i,s,o){void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===o&&(o=!0),this.status_bar=t('<div class="wsf-upload-status-bar"></div>'),this.progress_bar=t('<div class="wsf-upload-status-bar-progress"><div></div></div>').appendTo(this.status_bar),this.file_name=!!i&&t('<div class="wsf-upload-status-bar-file-name"></div>').appendTo(this.status_bar),this.file_size=!!s&&t('<div class="wsf-upload-status-bar-file-size"></div>').appendTo(this.status_bar),this.abort=!!o&&t('<div class="wsf-upload-status-bar-abort">Abort</div>').appendTo(this.status_bar),t(".wsf-uploads",a).append(this.status_bar),this.set_progress=function(t){var a=t*this.progress_bar.width()/100,i=t<100?t+"%":e.language("importing");this.progress_bar.find("div").animate({width:a},10).html("<span>"+i+"</span>"),!1!==this.abort&&parseInt(t,10)>=100&&this.abort.hide()},this.populate=function(t,e){if(!1!==this.file_name&&this.file_name.html(t),!1!==this.file_size){var a="",i=e/1024;if(parseInt(i,10)>1024)a=(i/1024).toFixed(2)+" MB";else a=i.toFixed(2)+" KB";this.file_size.html(a)}},this.set_abort=function(t){if(!1!==this.abort){var e=this.status_bar;this.abort.on("click",function(){t.abort(),e.hide()})}}},t.WS_Form.prototype.data_grid_update_mask_row_lookups=function(e,a,i,s){if("field"!==e)return!1;void 0===s&&(s=!1);var o=t.WS_Form.this.get_object_data(e,a,!0);!1===o&&t.WS_Form.this.error("error_object_data"),!1===(h=t.WS_Form.this.get_object_meta_value(o,i,!1))&&t.WS_Form.this.error("error_object_meta_value");var r=h.columns,n=o.type,d=t.WS_Form.field_type_cache[n];if(void 0!==d.mask_row_lookups){var _=d.mask_row_lookups;for(var l in _.push("wsf-data-grid-auto-group"),_)if(_.hasOwnProperty(l)&&"function"!=typeof _[l]){var c=_[l],f="wsf-data-grid-auto-group"==c,h=f?"":this.get_object_meta_value(o,c,0),p=t("#wsf-sidebar-"+this.esc_selector(e)+" ["+(f?"data-action":"data-meta-key")+'="'+this.esc_selector(c)+'"]');p.empty();var u=[],m=!1;for(var v in r)if(r.hasOwnProperty(v)&&"function"!=typeof r[v]){var g=r[v];parseInt(g.id)==parseInt(h,10)&&(m=!0),u.push({value:g.id,text:g.label})}if(!m||s){if(void 0!==t.WS_Form.meta_keys[c]){var b=t.WS_Form.meta_keys[c],w=void 0!==b.default?b.default:0;w>v&&(w="0")}else w="0";this.set_object_meta_value(o,c,w),h=w}u.sort(function(t,e){return t.text<e.text?-1:t.text>e.text?1:0});var y=f?'<option value="">'+this.language("data_grid_group_auto_group_select")+"</option>\n":"";for(var S in u)if(u.hasOwnProperty(S)&&"function"!=typeof u[S]){var W=u[S].value,F=f?"":parseInt(W,10)==parseInt(h,10)?" selected":"",k=u[S].text;y+='<option value="'+this.esc_attr(W)+'"'+F+">"+this.esc_html(k)+"</option>\n"}p.html(y)}}},t.WS_Form.prototype.data_grid_bulk_action_button=function(e,a,i,s,o,r){void 0===o&&(o=!1),void 0===r&&(r=!1);var n=e.closest(".wsf-sidebar").find('[data-meta-key="multiple"]').length,d=e.closest(".wsf-sidebar").find('[data-meta-key="multiple"]:checked').length;t(".wsf-data-grid-group",e).each(function(){if(!d&&o){var e=t.WS_Form.this.get_object_data(a,i,!0);!1===e&&t.WS_Form.this.error("error_object_data");var _=t.WS_Form.this.get_object_meta_value(e,s,!1);!1===_&&t.WS_Form.this.error("error_object_meta_value");var l=t(this).attr("data-group-index"),c=_.groups[l].rows,f=0;for(var h in c)if(c.hasOwnProperty(h)&&(""!=c[h].default&&f++,f>1))break;if(f>0){f=0;for(var h in c)c.hasOwnProperty(h)&&""!=c[h].default&&++f>1&&(c[h].default="");!1!==r&&r.render()}}var p=t('[data-action="wsf-data-grid-row-select"]:checked',t(this)),u=t('[data-action="wsf-data-grid-bulk-action"]',t(this)),m=u.siblings("select");u.attr("disabled",0==p.length),m.attr("disabled",0==p.length),n&&!d&&p.length>1?t('option[value="default"]',m).prop("disabled",!0):t('option[value="default"]',m).prop("disabled",!1)})},t.WS_Form.prototype.data_grid_group_page_set=function(e,a,i,s,o,r,n){e.page=i;var d=t.WS_Form.this.get_object_data(s,o);!1===d&&t.WS_Form.this.error("error_object_data");var _=t.WS_Form.this.get_object_meta_value(d,r,!1);if(!1!==_&&void 0!==_.groups&&void 0!==_.groups[a]){t.WS_Form.this.loader_on(),_.groups[a].page=i;var l={form_id:t.WS_Form.this.form_id};l[s]=d,l[s].history_suppress="on",t.WS_Form.this.api_call(s+"/"+o+"/put/","POST",l,function(e){t.WS_Form.this.loader_off()})}void 0!==n&&n()},t.WS_Form.prototype.data_grid_group_rows_per_page_set=function(e,a,i,s,o,r){e.rows_per_page=a;var n=t.WS_Form.this.get_object_data(i,s);!1===n&&t.WS_Form.this.error("error_object_data");var d=t.WS_Form.this.get_object_meta_value(n,o,!1);for(var _ in!1===d&&t.WS_Form.this.error("error_object_meta_value"),t.WS_Form.this.loader_on(),d.rows_per_page=a,e.groups)e.groups.hasOwnProperty(_)&&(e.groups[_].page=0);for(var _ in d.groups)d.groups.hasOwnProperty(_)&&(d.groups[_].page=0);var l={form_id:t.WS_Form.this.form_id};l[i]=n,l[i].history_suppress="on",void 0!==r&&r(),t.WS_Form.this.api_call(i+"/"+s+"/put/","POST",l,function(e){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.sidebar_html_editor_init=function(e){"undefined"!=typeof wp&&void 0!==wp.codeEditor?(t(".CodeMirror",e).remove(),t('.wsf-sidebar-tabs-panel:visible [data-html-editor="true"], [id^=wsf-action] [data-html-editor="true"], .wsf-html-editor [data-html-editor="true"]',e).each(function(){var e=t(this).attr("data-html-editor-mode")?t(this).attr("data-html-editor-mode"):"htmlmixed",a={mode:e};"javascript"===e&&(a.lint={options:{esversion:2021}});var i=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};i.codemirror=_.extend({},i.codemirror,a),wp.codeEditor.initialize(t(this).attr("id"),i)}),t(".CodeMirror").each(function(){t(this)[0].CodeMirror.on("keyup",function(e){var a=e.getValue(),i=e.getTextArea();t(i).val(a).trigger("input")})})):t(document).delegate('[data-html-editor="true"]',"keydown input",function(e){if(9===(e.keyCode||e.which)){e.preventDefault();var a=this.selectionStart,i=this.selectionEnd;t(this).val(t(this).val().substring(0,a)+"\t"+t(this).val().substring(i)),this.selectionStart=this.selectionEnd=a+1}})},t.WS_Form.prototype.action_render_from_data=function(){try{this.action=JSON.parse(this.action_data[1])}catch(t){this.action=this.action_new()}this.action_render()},t.WS_Form.prototype.action_new=function(){return{id:"",meta:{},events:[]}},t.WS_Form.prototype.action_render=function(){var e=t("#wsf-action-tr > td > div"),a=this.action.id;void 0===t.WS_Form.actions[a]&&(this.action=this.action_new(),a="");var i='<fieldset class="wsf-fieldset wsf-fieldset-header" data-action-header="true" data-object="action" data-id="'+this.esc_attr(a)+'">';i+='<div class="wsf-field-wrapper"><label class="wsf-label">'+this.language("data_grid_action_action")+"</label>",i+='<select data-meta-key="action_id" class="wsf-field">',i+='<option value="">'+this.language("options_select")+"</option>";var s=[],o=this.get_object_meta_value(this.object_data_scratch,"action").groups[0].rows;for(var r in o)if(o.hasOwnProperty(r)){try{var n=JSON.parse(o[r].data[1])}catch(t){continue}if(void 0!==n.id){var d=n.id;void 0!==t.WS_Form.actions[d]&&void 0!==t.WS_Form.actions[d].multiple&&(t.WS_Form.actions[d].multiple||s.push(d))}}var _=[];for(var l in t.WS_Form.actions)_.push({id:l,action:t.WS_Form.actions[l]});for(var c in _.sort(function(t,e){return t.action.label_action.toLowerCase()<e.action.label_action.toLowerCase()?-1:1}),_)if(_.hasOwnProperty(c)){d=(n=_[c]).id;if(-1===s.indexOf(d)||d==a){var f=n.action.label_action;i+='<option value="'+this.esc_attr(d)+'"'+(d==a?" selected":"")+">"+this.esc_html(f)+"</option>"}}for(var h in t.WS_Form.settings_form.sidebars.action.actions_pro)if(t.WS_Form.settings_form.sidebars.action.actions_pro.hasOwnProperty(h)){var p=t.WS_Form.settings_form.sidebars.action.actions_pro[h];i+='<option value="" disabled>'+this.esc_html(p)+"</option>"}if(i+="</select>",i+="</div>",i+='<div class="wsf-field-wrapper">',""!=a){i+='<label class="wsf-label">'+this.language("data_grid_action_event")+"</label>";var u=t.WS_Form.settings_form.sidebars.action.events;for(var m in u)if(u.hasOwnProperty(m)){var v=u[m],g=-1!=t.WS_Form.this.action.events.indexOf(m);i+='<div><input class="wsf-field" type="checkbox" id="wsf_action_event_'+this.esc_attr(m)+'" name="wsf_action_event[]"'+(g?" checked":"")+' /><label class="wsf-label" for="wsf_action_event_'+this.esc_attr(m)+'">'+this.esc_html(v.label)+"</label></div>"}}if(i+="</div>",i+="</fieldset>",e.html(i),""!=a){this.sidebar_cache_clear(e);var b=this.sidebar_html("action",a,this.action,t.WS_Form.actions[a],!1,!0,!0,!1,!1);e.append(b.html),this.sidebar_inits(b.inits,e,e,this.action)}t('[data-meta-key="action_id"]',e).on("change",function(){var e=t(this).val(),a=t('[data-column="0"]',t(this).closest("tr").prev());if(t.WS_Form.this.action_save(!0),t.WS_Form.this.action_render(),""!=e){var i=t.WS_Form.actions[e];if(void 0!==i.events)for(var s in i.events)if(i.events.hasOwnProperty(s)){var o=i.events[s];t("#wsf_action_event_"+o).prop("checked",!0)}a.val()===t.WS_Form.this.language("action_label_default")&&a.val(i.label_action)}else{var r=t.WS_Form.this.language("action_label_default");a.val(r)}a.trigger("input"),t.WS_Form.this.action_save(!0)}),t('[data-change="reload"]',e).on("change",function(){t.WS_Form.this.action_save(),t.WS_Form.this.action_render()}),e.show()},t.WS_Form.prototype.api_reload_init=function(e,a,i,s){t('[data-action="wsf-api-reload"]',e).on("click",function(){t.WS_Form.this.sidebar_lock();var e=t(this);if(e.addClass("wsf-api-method-calling"),s){var i=(d=t('[data-meta-key="'+t.WS_Form.this.esc_selector(e.attr("data-meta-key-for"))+'"]')).attr("data-object"),o=d.attr("data-object-id"),r=t.WS_Form.this.get_object_data(i,o,!0);for(var n in t.WS_Form.this.object_meta_cache)if(t.WS_Form.this.object_meta_cache.hasOwnProperty(n)){var d=t.WS_Form.this.object_meta_cache[n].meta_key;t.WS_Form.this.object_data_update_by_meta_key(i,r,d)}}var _=e.attr("data-action-id");if(null==_){var l=e.attr("data-action-id-meta-key");null!=l&&(_=t('[data-meta-key="'+t.WS_Form.this.esc_selector(l)+'"]',t("#wsf-sidebars")).val())}var c=e.attr("data-method"),f=e.attr("data-list-id-meta-key"),h=null!=f&&t('[data-meta-key="'+t.WS_Form.this.esc_selector(f)+'"]',t("#wsf-sidebars")).val(),p=e.attr("data-list-sub-id-meta-key"),u=null!=p&&t('[data-meta-key="'+t.WS_Form.this.esc_selector(p)+'"]',t("#wsf-sidebars")).val(),m=t.WS_Form.this.action_api_method_path(_,c,h,u);t.WS_Form.this.options_action_cache_clear(m),t.WS_Form.this.api_call(m,"GET",!1,function(){e.removeClass("wsf-api-method-calling"),a(e,_,c)},function(a){a.error&&t.WS_Form.this.error("error_bad_request_message",a.error_message),e.removeClass("wsf-api-method-calling")},!0)})},t.WS_Form.prototype.options_action_cache_clear=function(e){if(!1===e)return!1;e.endsWith("/fetch/")&&(e=e.substring(0,e.length-6)),t.WS_Form.this.options_action_cache[e]=void 0},t.WS_Form.prototype.action_api_method_path=function(t,e,a,i){if(void 0===t||""==t||null===t)return!1;if(void 0===e||""==e||null===e)return!1;void 0!==a&&""!=a&&null!==a||(a=!1),void 0!==i&&""!=i&&null!==i||(i=!1);var s="action/"+t+"/";switch(e){case"lists":s+="lists/";break;case"lists_fetch":s+="lists/fetch/";break;case"list":if(!1===a)return!1;s+="list/"+encodeURIComponent(a)+"/";break;case"list_fetch":if(!1===a)return!1;s+="list/"+encodeURIComponent(a)+"/fetch/";break;case"list_subs":if(!1===a)return!1;s+="list/"+encodeURIComponent(a)+"/subs/";break;case"list_subs_fetch":if(!1===a)return!1;s+="list/"+encodeURIComponent(a)+"/subs/fetch/";break;case"list_fields":if(!1===a)return!1;s+=!1===i?"list/"+encodeURIComponent(a)+"/fields/":"list/"+encodeURIComponent(a)+"/subs/"+encodeURIComponent(i)+"/fields/";break;case"list_fields_fetch":if(!1===a)return!1;s+=!1===i?"list/"+encodeURIComponent(a)+"/fields/fetch/":"list/"+encodeURIComponent(a)+"/subs/"+encodeURIComponent(i)+"/fields/fetch/";break;default:s+=e+"/"}return s},t.WS_Form.prototype.action_save=function(e){if(void 0===e&&(e=!1),this.sidebar_lock_count)return!1;if(!1===this.action)return!1;if(!t("#wsf-action-tr").length)return!1;if(this.action.id=t('[data-meta-key="action_id"]').val(),this.action.events=[],this.action.meta={},""!=this.action.id){var a=this.build_meta_data(t.WS_Form.actions[this.action.id],t.WS_Form.meta_keys);for(var i in a)if(a.hasOwnProperty(i)&&void 0!==t.WS_Form.meta_keys[i])if(e){var s=a[i];this.action.meta[i]=s}else this.object_data_update_by_meta_key("action",this.action,i);var o=t.WS_Form.settings_form.sidebars.action.events;for(var r in o){if(o.hasOwnProperty(r))t("#wsf_action_event_"+r).is(":checked")&&this.action.events.push(r)}}this.action_data[1]=JSON.stringify(this.action)},t.WS_Form.prototype.build_meta_data=function(t,e,a){for(var i in void 0===a&&(a=[]),t)if(t.hasOwnProperty(i)){var s=t[i];if("object"==typeof s)if("meta_keys"===i){for(var o in s)if(s.hasOwnProperty(o)){var r=s[o];if(void 0!==e[r]&&(e[r].dummy,!e[r].dummy)){if(void 0!==e[r].default)var n=e[r].default;else n="";n="boolean"==typeof n?n?"on":"":n,void 0!==e[r].key&&(r=e[r].key),a[r]=n}}}else a=this.build_meta_data(s,e,a)}return a},t.WS_Form.prototype.sidebar_title=function(t,e,a,i,s,o,r){if(void 0===a&&(a=""),void 0===i&&(i=""),void 0===s&&(s=""),void 0===o&&(o=!1),void 0===r&&(r=""),o){var n='<div data-action="wsf-sidebar-expand"'+this.tooltip(this.language("sidebar_expand"),"bottom-right")+">"+this.svg("expand")+"</div>";n+='<div data-action="wsf-sidebar-contract"'+this.tooltip(this.language("sidebar_contract"),"bottom-right")+">"+this.svg("contract")+"</div>"}else n="";return'<div class="wsf-sidebar-header"><div class="wsf-sidebar-icon">'+t+"</div><h2>"+this.esc_html(e)+"</h2>"+s+i+a+n+r+"</div>"},t.WS_Form.prototype.sidebar_open=function(e){var a=t("#wsf-sidebars").attr("data-current");if(this.sidebar_resize_reset(),void 0!==a&&a!=e){var i="sidebar_"+a+"_close";"function"==typeof window[i]&&window[i](t.WS_Form.this),this.sidebar_close(a)}t('[data-action-sidebar="'+this.esc_selector(e)+'"]').addClass("wsf-editing"),!1!==ws_form_settings.sidebar_tab_key&&(t('[data-wsf-tab-key="'+this.esc_selector(ws_form_settings.sidebar_tab_key)+'"]',t("#wsf-sidebar-"+e)).trigger("click"),ws_form_settings.sidebar_tab_key=!1),t("#wsf-sidebar-"+e).removeClass("wsf-sidebar-closed").addClass("wsf-sidebar-open"),t("#wsf-sidebars").attr("data-current",e),t(".wsf-sidebar-inner").scrollTop(0),window.matchMedia("(max-width: 600px)").matches&&(t("html").css({overflow:"hidden"}),t("body").css({overflow:"auto","-webkit-overflow-scrolling":"touch"})),this.variable_helper_modal_close()},t.WS_Form.prototype.sidebar_close=function(e){t('[data-action-sidebar="'+this.esc_selector(e)+'"]').removeClass("wsf-editing").trigger("blur"),t(".wsf-sidebar").addClass("wsf-sidebar-closed").removeClass("wsf-sidebar-open"),t("#wsf-sidebars").removeAttr("data-current"),window.matchMedia("(max-width: 600px)").matches&&(t("html").css({overflow:""}),t("body").css({overflow:"","-webkit-overflow-scrolling":""})),this.variable_helper_modal_close()},t.WS_Form.prototype.sidebar_reset=function(){if(window.matchMedia("(min-width: "+t.WS_Form.this.mobile_min_width+")").matches){var e=ws_form_settings.sidebar_reset_id;ws_form_settings.sidebar_reset_id="toolbox";var a="sidebar_"+e+"_open";if("function"==typeof window[a]){var i=t("#wsf-sidebar-"+e);t(".wsf-sidebar-inner",i);window[a](this,null,null)}else this.sidebar_open(e)}else{var s=t("#wsf-sidebars").attr("data-current");this.sidebar_close(s)}},t.WS_Form.prototype.sidebar_reset_mobile=function(){if(!window.matchMedia("(min-width: "+t.WS_Form.this.mobile_min_width+")").matches){var e=t("#wsf-sidebars").attr("data-current");this.sidebar_close(e)}},t.WS_Form.prototype.sidebars_render=function(){var e=t.WS_Form.settings_form.sidebars;for(var a in e)e.hasOwnProperty(a)&&this.sidebar_render(a);this.sidebar_expand_contract_init()},t.WS_Form.prototype.sidebar_expand_contract_init=function(){t('[data-action="wsf-sidebar-expand"]',t("#wsf-sidebars")).on("click",function(){t.WS_Form.this.sidebar_expanded_obj=t(this).closest(".wsf-sidebar"),t.WS_Form.this.sidebar_expanded_obj.addClass("wsf-sidebar-expanded")}),t('[data-action="wsf-sidebar-contract"]',t("#wsf-sidebars")).on("click",function(){t.WS_Form.this.sidebar_resize_reset()})},t.WS_Form.prototype.sidebar_render=function(e){this.sidebar_wrapper_add(e);var a=t.WS_Form.settings_form.sidebars[e],i=void 0!==a.static&&a.static,s=void 0!==a.buttons&&a.buttons,o=void 0!==a.nav&&a.nav,r=void 0!==a.expand&&a.expand,n=void 0!==a.url&&a.url,d=void 0!==a.label?a.label:"Title",_=void 0!==a.icon?a.icon:"default";if(o){if(n)var l='<li data-action-sidebar="'+this.esc_attr(e)+'"'+this.tooltip(d,"bottom-center")+' class="wsf-pro-required"><a href="'+this.esc_url(this.get_plugin_website_url(n,"nav"))+'" target="_blank" title="'+this.esc_attr(d)+'">'+this.svg(_)+"</a></li>";else l='<li data-action-sidebar="'+this.esc_attr(e)+'"'+this.tooltip(d,"form"===e?"bottom-right":"bottom-center")+">"+this.svg(_)+"</li>";t("#wsf-header .wsf-settings").prepend(l)}if(!n){var c=t("#wsf-sidebar-"+e);if(void 0!==a.kb_url)var f=this.get_plugin_website_url(a.kb_url,"sidebar"),h='<a class="wsf-kb-url" href="'+this.esc_url(f)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"bottom-right")+' tabindex="-1">'+this.svg("question-circle")+"</a>";var p=void 0!==a.logo?a.logo:"";if(c.html(this.sidebar_title(this.svg(_),d,"",h,"",r,p)),i&&void 0!==a.meta){this.sidebar_cache_clear(c);var u=this.sidebar_html("form",this.form_id,this.form,a.meta,!1,!0,!0,!1,s),m=u.html_tabs,v=u.html,g=u.html_buttons,b=u.inits;c.append(m),c.append('<div class="wsf-sidebar-inner">'+v+"</div>"),c.append(g);var w=t(".wsf-sidebar-inner",c);this.sidebar_inits(b,c,w)}t('[data-action-sidebar="'+this.esc_selector(e)+'"]').on("click",function(){t.WS_Form.this.object_save_changes();var e=t(this).attr("data-action-sidebar");if(e!=t("[data-action-sidebar].wsf-editing").first().attr("data-action-sidebar")){var a="sidebar_"+e+"_open";if("function"==typeof window[a]){var i=t("#wsf-sidebar-"+e),s=t(".wsf-sidebar-inner",i);window[a](t.WS_Form.this,s,t(this))}else t.WS_Form.this.sidebar_open(e)}else{var o="sidebar_"+e+"_toggle";if("function"==typeof window[o]){i=t("#wsf-sidebar-"+e),s=t(".wsf-sidebar-inner",i);window[o](t.WS_Form.this,s,t(this))}else t.WS_Form.this.sidebar_reset()}})}},t.WS_Form.prototype.sidebar_resize_reset=function(e){!1!==t.WS_Form.this.sidebar_expanded_obj&&t.WS_Form.this.sidebar_expanded_obj.removeClass("wsf-sidebar-expanded"),t.WS_Form.this.sidebar_expanded_obj=!1},t.WS_Form.prototype.sidebar_wrapper_add=function(e){var a='<div id="wsf-sidebar-'+e+'" class="wsf-sidebar wsf-sidebar-closed"></div>\n\n';t("#wsf-sidebars").append(a)},t.WS_Form.prototype.sidebar_form_history=function(){var e=t(".wsf-form-history ul");e.empty();for(var a=this.form_history.length-1;a>=0;a--){var i=this.form_history[a].history,s="";if(0==a)s=t.WS_Form.settings_form.history.initial;else{var o=t.WS_Form.settings_form.history.method[i.method],r="";if(void 0!==i.id){i.id;void 0!==i.label&&(r=' <span class="wsf-history-highlight">'+this.esc_html(i.label)+"</span>")}s=o+r}var n='<li data-id="'+this.esc_attr(a)+'"'+(this.history_index==a?' class="wsf-history-current"':"")+'><div class="date">'+i.time+'</div><div class="description">'+s+"</div></li>";e.append(n);var d=e.find('li[data-id="'+this.esc_selector(a)+'"]').first();this.touch_device||d.on("mouseenter",function(){var e=t(this).attr("data-id");t.WS_Form.this.history_pull(e),t.WS_Form.this.sidebar_form_history_classes(e)}),d.on("click",function(){t.WS_Form.this.history_index=parseInt(t(this).attr("data-id"),10),t.WS_Form.this.history_pull(t.WS_Form.this.history_index,!0,!0),t.WS_Form.this.sidebar_form_history_classes(t.WS_Form.this.history_index)})}this.sidebar_form_history_classes()},t.WS_Form.prototype.sidebar_form_history_classes=function(e){void 0===e&&(e=this.history_index),t(".wsf-form-history ul li").each(function(){t(this).removeClass("wsf-history-current").removeClass("wsf-history-undo").removeClass("wsf-history-redo");var a=parseInt(t(this).attr("data-id"),10);a==e&&t(this).addClass("wsf-history-current"),a>e&&t(this).addClass("wsf-history-redo"),a<e&&t(this).addClass("wsf-history-undo")})},t.WS_Form.prototype.history_push=function(e){if(this.form_preview_update(),this.form_history=this.form_history.slice(0,this.history_index+1),void 0!==(e=t.extend(!0,{},e)).history&&!1!==e.history){var a={form:e.form,history:e.history};this.form_history.push(a)}this.history_index=this.form_history.length-1,this.sidebar_form_history(),this.undo_redo_update(),this.breakpoint_buttons()},t.WS_Form.prototype.history_pull=function(e,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1),this.loader_on(),this.sidebar_reset(),this.form=t.extend(!0,{},this.form_history[e].form),this.data_cache_build(),a?this.form_put(!0,!0,!0,i):(this.form_build(),this.loader_off())},t.WS_Form.prototype.undo=function(){return 0!=this.history_index&&(!(this.form_history.length<=1)&&(this.history_index--,this.history_pull(this.history_index,!0,!0),this.sidebar_form_history(),void this.undo_redo_update()))},t.WS_Form.prototype.redo=function(){var t=this.form_history.length;if(this.history_index==t-1)return!1;this.history_index++,this.history_pull(this.history_index,!0,!0),this.sidebar_form_history(),this.undo_redo_update()},t.WS_Form.prototype.undo_redo_update=function(){var e=this.form_history.length;if(this.history_index>0){var a=this.history_index>99?"":this.history_index;t('[data-action="wsf-undo"]').removeClass("wsf-undo-inactive").find(".count").html(a)}else t('[data-action="wsf-undo"]').addClass("wsf-undo-inactive").find(".count").html("");if(this.history_index<e-1){a=this.history_index>99?"":e-1-this.history_index;t('[data-action="wsf-redo"]').removeClass("wsf-redo-inactive").find(".count").html(a)}else t('[data-action="wsf-redo"]').addClass("wsf-redo-inactive").find(".count").html("")},t.WS_Form.prototype.popover=function(e,a,i,s){this.popover_reset(),t("body").addClass("wsf-scroll-lock"),t(".wsf-group.wsf-ui-cancel").removeClass("wsf-ui-cancel"),t(".wsf-section.wsf-ui-cancel").removeClass("wsf-ui-cancel"),t(".wsf-field-wrapper.wsf-ui-cancel").removeClass("wsf-ui-cancel"),t(".wsf-data-grid-group-tab.wsf-ui-cancel").removeClass("wsf-ui-cancel");var o=t("#wsf-popover"),r="<p>"+e+"</p>";i.addClass("wsf-ui-cancel");var n=this.get_object_type(i),d=i.attr("data-id");switch(n){case"group":t('.wsf-group-tab[data-id="'+this.esc_selector(d)+'"]').addClass("wsf-ui-cancel");break;case"data-grid-group-tab":t(t("a",i).attr("href")).addClass("wsf-ui-cancel")}for(var _ in a)if(a.hasOwnProperty(_)){var l=a[_],c=l.label,f=l.action,h="";void 0!==l.class&&(h=l.class),r+='<button class="wsf-button wsf-button-small',""!=h&&(r+=" "+h),r+='" data-action="'+this.esc_attr(f)+'">'+this.esc_html(c)+"</button>"}o.html(r),o.css({opacity:0}),o.show();var p=i.offset(),u=o.innerWidth(),m=o.innerHeight();m+=6;var v=i.width(),g=t(window).width(),b=p.left+v/2-u/2,w=p.top-m,y=t("#wpcontent").offset();b<y.left&&(b=y.left),w<y.top&&(w=y.top),b+u>g&&(b=g-u),o.offset({left:b,top:w}),o.find("button[data-action]").each(function(){t(this).on("click",function(e){switch(e.preventDefault(),t(this).attr("data-action")){case"wsf-confirm":"function"==typeof s&&s()}t.WS_Form.this.popover_reset(),i.removeClass("wsf-ui-cancel");var a=t.WS_Form.this.get_object_type(i),o=i.attr("data-id");switch(a){case"group":t('.wsf-group-tab[data-id="'+t.WS_Form.this.esc_selector(o)+'"]').removeClass("wsf-ui-cancel");break;case"data-grid-group-tab":t(t("a",i).attr("href")).removeClass("wsf-ui-cancel")}})}),o.css({opacity:1})},t.WS_Form.prototype.popover_reset=function(e,a,i,s,o){t("body").removeClass("wsf-scroll-lock"),t("#wsf-popover").hide(),t("#wsf-popover").html("")},t.WS_Form.prototype.settings_html=function(e,a,i,s){void 0===s&&(s=!1);var o='<ul class="wsf-settings wsf-settings-'+e+(s?" wsf-settings-no-resize":"")+' wsf-ui-cancel">',r=t.WS_Form.settings_form[e].buttons;for(var n in r)if(r.hasOwnProperty(n)){var d=r[n],_=d.name,l=d.icon,c=d.method;(i||"clone"!=c)&&(o+='<li data-id="'+this.esc_attr(a)+'" data-action="'+this.esc_attr(c)+'"'+this.tooltip(_,"top-center")+">"+l+"</li>")}return o+="</ul>"},t.WS_Form.prototype.settings_events=function(e,a){t(".wsf-settings-"+a+" li",e).each(function(){t(this).on("click",function(){var e="wsf_"+a+"_"+t(this).attr("data-action");if("undefined"!=(window[e],"string")){var i=t(".wsf-"+a+("field"==a?"-wrapper":"")+'[data-id="'+t.WS_Form.this.esc_selector(t(this).attr("data-id"))+'"]').first();window[e](t.WS_Form.this,i,t(this))}})})},t.WS_Form.prototype.column_size_change_html=function(){return'<div class="wsf-column-size wsf-ui-cancel" title="'+this.language("column_size_change")+'"></div>'},t.WS_Form.prototype.column_size_change_init=function(e){e.find(".wsf-column-size").last().on("mousedown",function(){t.WS_Form.this.mouseup_mode="column_size",t("body").addClass("wsf-column-size-change-body"),e.addClass("wsf-column-size-change"),t.WS_Form.this.column_size_change_obj=e;var a=e.parent().innerWidth(),i=e.attr("data-id");if(e.hasClass("wsf-section")){"resize"==t.WS_Form.settings_plugin.helper_columns&&e.closest(".wsf-group").addClass("wsf-column-helper");var s=t.WS_Form.this.section_data_cache[i]}if(e.hasClass("wsf-field-wrapper")){"resize"==t.WS_Form.settings_plugin.helper_columns&&e.closest(".wsf-section").addClass("wsf-column-helper");s=t.WS_Form.this.field_data_cache[i]}!1!==t.WS_Form.this.object_data_scratch&&t.WS_Form.this.object_data_scratch.id==i&&(s=t.WS_Form.this.object_data_scratch);var o=t.WS_Form.settings_plugin.framework,r=(o=t.WS_Form.frameworks.types[o],parseInt(t.WS_Form.settings_plugin.framework_column_count,10)),n=o.breakpoints,d=t.WS_Form.this.get_object_meta_value(t.WS_Form.this.form,"breakpoint");t.WS_Form.this.column_size=r;var _=0;for(var l in n)if(n.hasOwnProperty(l)){n[l];var c="breakpoint_size_"+l;""!=(f=t.WS_Form.this.get_object_meta_value(s,c,"",!1))&&(t.WS_Form.this.column_size=parseInt(f,10));var f;c="breakpoint_offset_"+l;if(""!=(f=t.WS_Form.this.get_object_meta_value(s,c,"",!1))&&(_=parseInt(f,10)),l==d)break}t.WS_Form.this.column_size_old=t.WS_Form.this.column_size;var h=e.offset().left,p=e.width(),u=r-_;t(document).on("mousemove",function(i){i.preventDefault(),t.WS_Form.this.column_size_change(i,e,h,p,a,s,u)})})},t.WS_Form.prototype.column_size_change=function(e,a,i,s,o,r,n){if(!1!==this.column_size_change_obj){if(ws_form_settings.rtl)var d=i+s-e.pageX;else d=e.pageX-i;d<0&&(d=0);var _=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),l=Math.round(d/o*_+.5);if(l<1&&(l=1),l>n&&(l=n),l!=this.column_size){this.column_classes_render(a,r,!1);var c=this.get_object_meta_value(this.form,"breakpoint");this.column_size_set(r,c,l),this.column_classes_render(a,r);var f=a.attr("data-id"),h=this.get_object_type(a);!1!==t.WS_Form.this.object_data_scratch&&t("#wsf-sidebar-"+h+" .wsf-breakpoint-sizes").length&&t.WS_Form.this.object_data_scratch.id==f&&t("#wsf-sidebar-"+h+" .wsf-breakpoint-sizes").get(0).render(),this.column_size=l}}},t.WS_Form.prototype.column_size_change_release=function(){var e=this.column_size_change_obj;if(!1!==this.column_size_change_obj){if(this.column_size!=this.column_size_old){this.loader_on();var a=e.attr("data-id"),i=!1,s={},o=this.get_object_meta_value(this.form,"breakpoint");if(e.hasClass("wsf-section")){this.column_size_set(this.section_data_cache[a],o,this.column_size);var r=this.section_data_cache[a];i="section",s={section:this.section_data_cache[a]}}if(e.hasClass("wsf-field-wrapper"))switch(this.column_size_set(this.field_data_cache[a],o,this.column_size),i="field",s={field:r=this.field_data_cache[a]},void 0!==r.type&&r.type){case"checkbox":case"radio":this.orientation_breakpoint_optimize(r)}if(!1===i)return!1;this.breakpoint_optimize(r),s.history_method="put_resize",this.api_call(i+"/"+a+"/put/","POST",s,function(e){t.WS_Form.this.loader_off()})}e.removeClass("wsf-column-size-change"),"resize"==t.WS_Form.settings_plugin.helper_columns&&t(".wsf-column-helper").removeClass("wsf-column-helper"),t("body").removeClass("wsf-column-size-change-body"),this.column_size_change_obj=!1,this.column_size=0,this.mouseup_mode=!1,t(document).off("mousemove")}},t.WS_Form.prototype.column_size_set=function(t,e,a){this.set_object_meta_value(t,"breakpoint_size_"+e,a)},t.WS_Form.prototype.offset_change_html=function(){return'<div class="wsf-offset wsf-ui-cancel" title="'+this.language("offset_change")+'"></div>'},t.WS_Form.prototype.offset_change_init=function(e){e.find(".wsf-offset").last().on("mousedown",function(){t.WS_Form.this.mouseup_mode="offset",t("body").addClass("wsf-offset-change-body"),e.addClass("wsf-offset-change"),t.WS_Form.this.offset_change_obj=e;var a=e.parent().innerWidth(),i=parseInt(e.attr("data-id"),10);if(e.hasClass("wsf-section")){"resize"==t.WS_Form.settings_plugin.helper_columns&&e.closest(".wsf-group").addClass("wsf-column-helper");var s=t.WS_Form.this.section_data_cache[i]}if(e.hasClass("wsf-field-wrapper")){"resize"==t.WS_Form.settings_plugin.helper_columns&&e.closest(".wsf-section").addClass("wsf-column-helper");s=t.WS_Form.this.field_data_cache[i]}!1!==t.WS_Form.this.object_data_scratch&&t.WS_Form.this.object_data_scratch.id==i&&(s=t.WS_Form.this.object_data_scratch);var o=t.WS_Form.settings_plugin.framework,r=(o=t.WS_Form.frameworks.types[o],parseInt(t.WS_Form.settings_plugin.framework_column_count,10)),n=o.breakpoints,d=t.WS_Form.this.get_object_meta_value(t.WS_Form.this.form,"breakpoint");t.WS_Form.this.offset=0;var _=0;for(var l in n)if(n.hasOwnProperty(l)){var c=n[l];if(0==_)var f=void 0!==c.column_size_default?"column_count"==c.column_size_default?r:c.column_size_default:column_size_default;var h="breakpoint_offset_"+l;""!=(p=t.WS_Form.this.get_object_meta_value(s,h,"",!1))&&(t.WS_Form.this.offset=parseInt(p,10));var p;h="breakpoint_size_"+l;if(""!=(p=t.WS_Form.this.get_object_meta_value(s,h,"",!1))&&(f=parseInt(p,10)),l==d)break;_++}t.WS_Form.this.offset_old=t.WS_Form.this.offset;var u=e.offset().left,m=e.width(),v=r-f;t(document).on("mousemove",function(i){i.preventDefault(),t.WS_Form.this.offset_change(i,e,u,m,a,s,v)})})},t.WS_Form.prototype.offset_change=function(e,a,i,s,o,r,n){if(!1!==this.offset_change_obj){if(ws_form_settings.rtl)var d=i+s-e.pageX;else d=e.pageX-i;var _=parseInt(t.WS_Form.settings_plugin.framework_column_count,10),l=t.WS_Form.this.offset_old+Math.round(d/o*_+.5)-1;if(l<0&&(l=0),l>n&&(l=n),l!=this.offset){this.column_classes_render(a,r,!1);var c=this.get_object_meta_value(this.form,"breakpoint");this.offset_set(r,c,l),this.column_classes_render(a,r);var f=parseInt(a.attr("data-id"),10),h=this.get_object_type(a);!1!==t.WS_Form.this.object_data_scratch&&t("#wsf-sidebar-"+h+" .wsf-breakpoint-sizes").length&&t.WS_Form.this.object_data_scratch.id==f&&t("#wsf-sidebar-"+h+" .wsf-breakpoint-sizes").get(0).render(),this.offset=l}}},t.WS_Form.prototype.offset_change_release=function(){var e=this.offset_change_obj;if(!1!==this.offset_change_obj){if(this.offset!=this.offset_old){this.loader_on();var a=parseInt(e.attr("data-id"),10),i=!1,s={},o=this.get_object_meta_value(this.form,"breakpoint");if(e.hasClass("wsf-section")&&(this.offset_set(this.section_data_cache[a],o,this.offset),i="section",s={section:this.section_data_cache[a]}),e.hasClass("wsf-field-wrapper")&&(this.offset_set(this.field_data_cache[a],o,this.offset),i="field",s={field:this.field_data_cache[a]}),!1===i)return!1;s.history_method="put_offset",this.api_call(i+"/"+a+"/put/","POST",s,function(e){t.WS_Form.this.loader_off()})}e.removeClass("wsf-offset-change"),"resize"==t.WS_Form.settings_plugin.helper_columns&&t(".wsf-column-helper").removeClass("wsf-column-helper"),t("body").removeClass("wsf-offset-change-body"),this.offset_change_obj=!1,this.offset=0,this.mouseup_mode=!1,t(document).off("mousemove")}},t.WS_Form.prototype.offset_set=function(t,e,a){this.set_object_meta_value(t,"breakpoint_offset_"+e,a.toString())},t.WS_Form.prototype.init_ui=function(){this.groups_sortable(),this.sections_sortable(),this.fields_sortable(),this.group_tabs_droppable(),this.object_blank_update()},t.WS_Form.prototype.groups_sortable=function(){t(".wsf-group-tabs").sortable({cursor:"move",scroll:!1,forceHelperSize:!0,placeholder:"wsf-group-tab-placeholder",cancel:".wsf-ui-cancel, .wsf-disabled, input[type=text]:not([readonly]), li:not([data-id])",items:"> li:not(.wsf-ui-cancel)",start:function(e,a){var i=a.placeholder,s=["height: "+a.helper.height()+"px","width: "+a.helper.outerWidth()+"px"].join(";");i.attr("style",s),t.WS_Form.this.next_sibling_id_old=void 0!==i.next().attr("data-id")?i.next().attr("data-id"):0,t.WS_Form.this.dragging=!0},stop:function(e,a){t.WS_Form.this.group_put_sort_index(a.item),t.WS_Form.this.dragging=!1}}).disableSelection()},t.WS_Form.prototype.sections_sortable=function(){t(".wsf-sections").sortable({tolerance:"pointer",forceHelperSize:!0,placeholder:"wsf-section-placeholder",items:"> li",cancel:".wsf-section-blank, .wsf-ui-cancel, input[type=text]:not([readonly]), li:not([data-id])",connectWith:".wsf-sections",start:function(e,a){var i=a.placeholder;a.helper.css("height","auto");var s=a.helper.height(),o=a.helper.css("background-size"),r=a.helper.css("max-width"),n=["height: "+s+"px","-webkit-box-flex: 0","-ms-flex: 0 0 "+r,"flex: 0 0 "+r,"margin-left: "+o,"max-width: "+r].join(";");i.attr("style",n),t(".wsf-sections").sortable("refreshPositions"),t.WS_Form.this.next_sibling_id_old=void 0!==i.next().attr("data-id")?i.next().attr("data-id"):0,t.WS_Form.this.group_id_old=i.closest(".wsf-group").attr("data-id"),t.WS_Form.this.dragging=!0},over:function(e,a){t.WS_Form.this.object_blank_update(),a.helper.css("height","auto");var i=a.helper.height();a.placeholder.height(i),t.WS_Form.this.dragged_section&&(t.WS_Form.this.dragged_section_in_group=!0)},out:function(e,a){t.WS_Form.this.object_blank_update(),t.WS_Form.this.dragged_section&&(t.WS_Form.this.dragged_section_in_group=!1)},stop:function(e,a){if(t.WS_Form.this.object_blank_update(),t.WS_Form.this.dragged_section){var i=t(".wsf-section-inner",t.WS_Form.this.dragged_section).height(),s=t(".wsf-template-title tspan",t.WS_Form.this.dragged_section).html();t.WS_Form.this.dragged_section.html('<div class="wsf-section-inner"><div class="wsf-section-label"><input type="text" value="'+t.WS_Form.this.esc_attr(s)+'" readonly></div><div class="wsf-section-type">'+t.WS_Form.this.language("section")+"</div></div>").removeAttr("style"),t(".wsf-section-inner",t.WS_Form.this.dragged_section).attr("style","height:"+i+"px"),t.WS_Form.this.template_section_post(t.WS_Form.this.dragged_section),t.WS_Form.this.init_ui()}else t.WS_Form.this.section_put_sort_index(a.item);t.WS_Form.this.dragging=!1,t.WS_Form.this.dragged_section=null,t.WS_Form.this.dragged_section_in_group=!1}}).disableSelection()},t.WS_Form.prototype.fields_sortable=function(){t(".wsf-fields").sortable({tolerance:"pointer",forceHelperSize:!0,placeholder:"wsf-field-placeholder",items:"> li",cancel:".wsf-field-blank, .wsf-ui-cancel, input[type=text]:not([readonly]), li:not([data-id])",connectWith:".wsf-fields",start:function(e,a){if(!t.WS_Form.this.dragged_field){var i=a.placeholder,s=a.helper.height(),o=a.helper.css("background-size"),r=a.helper.css("max-width"),n=["height: "+s+"px","-webkit-box-flex: 0","-ms-flex: 0 0 "+r,"flex: 0 0 "+r,"margin-left: "+o,"max-width: "+r].join(";");i.attr("style",n),t(".wsf-fields").sortable("refreshPositions"),t.WS_Form.this.next_sibling_id_old=void 0!==i.next().attr("data-id")?i.next().attr("data-id"):0,t.WS_Form.this.section_id_old=i.closest(".wsf-section").attr("data-id"),t.WS_Form.this.dragging=!0}},over:function(e,a){t.WS_Form.this.object_blank_update(),a.helper.css("height","auto");var i=a.helper.height();a.placeholder.height(i),t.WS_Form.this.dragged_field?(t.WS_Form.this.dragged_field_in_section=!0,t.WS_Form.this.dragged_field.width(t(a.placeholder).width())):a.helper.width(t(a.placeholder).width())},out:function(e,a){t.WS_Form.this.object_blank_update(),t.WS_Form.this.dragged_field&&(t.WS_Form.this.dragged_field_in_section=!1)},stop:function(e,a){t.WS_Form.this.object_blank_update(),t.WS_Form.this.dragged_field?(t.WS_Form.this.dragged_field.removeAttr("style"),t.WS_Form.this.field_post(t.WS_Form.this.dragged_field),t.WS_Form.this.init_ui()):t.WS_Form.this.field_put_sort_index(a.item),t.WS_Form.this.dragging=!1,t.WS_Form.this.dragged_field=null,t.WS_Form.this.dragged_field_in_section=!1}}).disableSelection()},t.WS_Form.prototype.group_tabs_droppable=function(){t(".wsf-group-tab").droppable({accept:".wsf-sections li.wsf-section[data-id], .wsf-fields li.wsf-field-wrapper[data-id]",hoverClass:"wsf-group-tab-hover",tolerance:"pointer",over:function(e,a){if(t("a",e.target).trigger("click"),a.helper.hasClass("wsf-section"))var i=".wsf-sections";if(a.helper.hasClass("wsf-field-wrapper"))i=".wsf-fields";if(void 0!==i){var s=t(t(this).find("a").attr("href")).find(i).first();a.draggable.appendTo(s).show(),t(".wsf-sections").sortable("refreshPositions"),t(".wsf-fields").sortable("refreshPositions")}}})},t.WS_Form.prototype.svg=function(e){return void 0!==t.WS_Form.settings_form.icons[e]?t.WS_Form.settings_form.icons[e]:t.WS_Form.settings_form.icons.default},t.WS_Form.prototype.api_test=function(t,e){this.api_call("helper/test/","GET",!1,function(a){void 0===a.error||a.error?e(void 0!==a.error_message&&a.error_message):t()},function(t){e(!1)})},t.WS_Form.prototype.framework_detect=function(t,e){this.api_call("helper/framework-detect/","POST",!1,function(e){var a={type:e.data.type,name:e.data.framework.name};t(a)},e)},t.WS_Form.prototype.setup_push=function(t,e,a){this.api_call("helper/setup-push/","POST",t,e,a)},t.WS_Form.prototype.template_form=function(){t("#wsf-template-add").tabs({activate:function(e,a){if("true"!==a.newPanel.attr("data-populated")){var i=a.newPanel.attr("data-action-id");void 0!==i&&t.WS_Form.this.template_form_populate(i)}}}),t('[data-action="wsf-add-blank"]').on("click",function(e){e.preventDefault(),t(window).scrollTop(0),t.WS_Form.this.template_form_loading_on(),t("#ws-form-action").val("wsf-add-blank"),t("#ws-form-action-do").trigger("submit")}),t('li:not(.wsf-pro-required) [data-action="wsf-add-template"]').on("click",function(){t(window).scrollTop(0),t.WS_Form.this.template_form_loading_on();var e=t(this).attr("data-id");t("#ws-form-action").val("wsf-add-template"),t("#ws-form-id").val(e),t("#ws-form-action-do").trigger("submit")}),t('[data-action="wsf-close"]',t("#wsf-template-add-modal")).on("click",function(){t.WS_Form.this.template_form_add_modal_close()}),t('[data-action="wsf-template-add-modal-submit"]',t("#wsf-template-add-modal")).on("click",function(){t(window).scrollTop(0),t.WS_Form.this.loader_on(),t("#wsf-template-add-modal").hide(),t("#wsf-template-add-modal-backdrop").hide(),t(document).off("keydown"),t.WS_Form.this.template_form_loading_on(),t("#ws-form-id").val(t(this).attr("data-id")),t("#ws-form-action").val(t(this).attr("data-action")),t("#ws-form-action-id").val(t(this).attr("data-action-id")),t("#ws-form-list-id").val(t(this).attr("data-list-id")),t("#ws-form-action-do [data-form-add-modal-pass-through]").remove(),t("input, select, textarea","#wsf-template-add-modal-form").each(function(){t("#ws-form-action-do").append('<input type="hidden" data-form-add-modal-pass-through name="'+t(this).attr("name")+'" value="'+t(this).val()+'" />')}),t("#ws-form-action-do").trigger("submit")}),t(document).on("click",'[data-action="wsf-modal-form"]',function(e){e.preventDefault();var a=t(this).attr("data-modal-form");if(void 0===a){var i=t(this).closest("[data-action-form-add-modal-label]");a={label:i?i.attr("data-action-form-add-modal-label"):t(this).attr("data-label"),action:"wsf-add-action",fields:[{id:"wsf-list-sub-id",name:"list_sub_id",type:"select",required:!0}],get_list_subs:!0}}else a=JSON.parse(a);t("#wsf-modal-buttons-create button").attr("data-id",t(this).attr("data-id")),t("#wsf-modal-buttons-create button").attr("data-action",a.action),t("#wsf-modal-buttons-create button").attr("data-action-id",t(this).attr("data-action-id")),t("#wsf-modal-buttons-create button").attr("data-list-id",t(this).attr("data-list-id")),t("#wsf-modal-buttons-create button").prop("disabled",!0);var s=a.fields,o="";for(var r in s)if(s.hasOwnProperty(r)){var n=s[r];o+='<div class="wsf-template-add-modal-field-wrapper">',n.label&&(o+='<label for="'+t.WS_Form.this.esc_attr(n.id)+'">'+n.label+"</label>");var d=' id="'+t.WS_Form.this.esc_attr(n.id)+'" name="'+t.WS_Form.this.esc_attr(n.name)+'"';switch(n.required&&(d+=" required"),n.placeholder&&(d+=' placeholder="'+t.WS_Form.this.esc_attr(n.placeholder)+'"'),n.type){case"select":o+="<select"+d+"></select>";break;case"textarea":o+="<textarea"+d+"></textarea>"}o+="</div>"}t("#wsf-template-add-modal .wsf-modal-title h2").html(a.label),t("#wsf-template-add-modal-form").html(o),t("#wsf-template-add-modal-backdrop").show(),t("#wsf-template-add-modal").show(),t(document).on("keydown",function(e){27===(e.keyCode||e.which)&&t.WS_Form.this.template_form_add_modal_close()});var _=t("input, select, textarea","#wsf-template-add-modal-form");if(_.on("change input paste",function(){t("#wsf-modal-buttons-create button").attr("disabled",!t(this).closest("form")[0].checkValidity()&&"")}),_.first().trigger("focus"),a.get_list_subs){var l=t(this).attr("data-action-id"),c=t(this).attr("data-list-id"),f=t.WS_Form.this.action_api_method_path(l,"list_subs_fetch",c);t("#wsf-list-sub-id").empty().append(t("<option />").val("").text(t.WS_Form.this.language("list_subs_call"))),t.WS_Form.this.api_call(f,"GET",!1,function(e){if(e.error)return t.WS_Form.this.loader_off(),t.WS_Form.this.template_form_add_modal_close(),void t.WS_Form.this.error("error_action_list_sub_get");t("#wsf-list-sub-id").empty().append(t("<option />").val("").text(t.WS_Form.this.language("list_subs_select")));var a=e.data;for(var i in a)if(a.hasOwnProperty(i)){var s=a[i];t("#wsf-list-sub-id").append(t("<option />").val(s.id).text(s.label))}t.WS_Form.this.loader_off()})}}),t(document).on("click","#wsf-template-add-modal-backdrop",function(e){t.WS_Form.this.template_form_add_modal_close()});var e=t("#wsf-template-add");this.api_reload_init(e,function(e,a,i){switch(i){case"lists_fetch":t.WS_Form.this.template_form_populate(a)}},null,!1),this.get_configuration(function(){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.template_form_add_modal_close=function(){t("#wsf-template-add-modal").hide(),t("#wsf-template-add-modal-backdrop").hide(),t(document).keydown=null},t.WS_Form.prototype.template_form_loading_on=function(e){t("#wsf-template-add-loading").show()},t.WS_Form.prototype.template_form_populate=function(e){t.WS_Form.this.loader_on();var a=t("#wsf_template_category_"+e+" ul.wsf-templates");t.WS_Form.this.api_call("template/action/"+e,"GET",[],function(i){if(i.error)t.WS_Form.this.loader_off();else{var s=i.data,o="",r=0;for(var n in s)if(s.hasOwnProperty(n)){var d=s[n],_=d.id,l=d.label,c=d.svg,f=void 0!==d.list_sub&&d.list_sub?"wsf-modal-form":"wsf-add-template-action";o+='<li><div class="wsf-template" data-action-id="'+t.WS_Form.this.esc_attr(e)+'" data-list-id="'+t.WS_Form.this.esc_attr(_)+'" title="'+t.WS_Form.this.esc_attr(l)+'">',o+=c,o+='<div class="wsf-template-actions">',o+='<button class="wsf-button wsf-button-primary wsf-button-full" data-action="'+t.WS_Form.this.esc_attr(f)+'" data-action-id="'+t.WS_Form.this.esc_attr(e)+'" data-list-id="'+t.WS_Form.this.esc_attr(_)+'">'+ws_form_settings_language_form_add_create+"</button>",o+="</div>",o+="</div>",o+="</li>",r++}r>0&&(t("li:not(:first-child)",a).remove(),a.append(o)),t("#wsf_template_category_"+e).attr("data-populated","true"),t('[data-action="wsf-add-template-action"]',a).on("click",function(){t.WS_Form.this.template_form_loading_on();var e=t(this).attr("data-action-id"),a=t(this).attr("data-list-id");t("#ws-form-action").val("wsf-add-action"),t("#ws-form-action-id").val(e),t("#ws-form-list-id").val(a),t("#ws-form-action-do").trigger("submit")}),t.WS_Form.this.loader_off()}})},t.WS_Form.prototype.template_api_response=function(e){void 0!==e.data&&(t.WS_Form.templates_section=e.data,t.WS_Form.this.sidebar_section_select_init())},t.WS_Form.prototype.template_style=function(){t("#wsf-template-add").tabs({activate:function(t,e){if("true"!==e.newPanel.attr("data-populated"))e.newPanel.attr("data-action-id")}}),t('li:not(.wsf-pro-required) [data-action="wsf-add-template"]').on("click",function(){t(window).scrollTop(0),t.WS_Form.this.template_style_loading_on();var e=t(this).attr("data-id");t("#ws-style-action").val("wsf-add-template"),t("#ws-style-id").val(e),t("#ws-style-action-do").trigger("submit")}),this.get_configuration(function(){t.WS_Form.this.loader_off()})},t.WS_Form.prototype.template_style_loading_on=function(e){t("#wsf-template-add-loading").show()},t.WS_Form.prototype.wp_list_table_form=function(){this.form_id=0;var e=t("#wsf-form-list-table");t('[data-action]:not([data-action="wsf-clipboard"])',e).on("click",function(){t("#wsf-action").val(t(this).attr("data-action")),t("#wsf-id").val(t(this).attr("data-id")),t("#wsf-action-do").trigger("submit")}),t("table.wp-list-table",e).wrap('<div id="wsf-form-table"></div>');var a=t("#wsf-form-table");a.append('<div class="wsf-object-upload-json-window"><div class="wsf-object-upload-json-window-content"><h1></h1><div class="wsf-uploads"></div></div></div>'),a.on("dragenter",function(e){e.stopPropagation(),e.preventDefault(),t.WS_Form.this.drag_is_file(e)&&t(".wsf-object-upload-json-window",t(this)).show()}),t(".wsf-object-upload-json-window",a).on("dragover",function(t){t.stopPropagation(),t.preventDefault()}),t(".wsf-object-upload-json-window",a).on("drop",function(e){e.preventDefault();var i=e.originalEvent.dataTransfer.files;t.WS_Form.this.object_upload_json(i,t(this),null,function(){location.reload()},function(){t(".wsf-object-upload-json-window",a).hide()})}),t(".wsf-object-upload-json-window",a).on("dragleave",function(e){t(".wsf-object-upload-json-window",a).hide()}),t('[data-action-button="wsf-form-upload"]').on("click",function(e){t("#wsf-object-upload-file").val("").trigger("click")}),t("#wsf-object-upload-file").on("change",function(){var e=t("#wsf-object-upload-file").prop("files");if(e.length>0){var a=t("> .wsf-object-upload-json-window",t.WS_Form.this.upload_obj);a.show(),t.WS_Form.this.object_upload_json(e,a,null,function(){location.reload()},function(){t("> .wsf-object-upload-json-window",t.WS_Form.this.upload_obj).hide()})}}),t('[data-action-ajax="wsf-form-status"]',a).on("click",function(){var e=t(this).attr("data-id"),a=t(this).is(":checked");t.WS_Form.this.loader_on();var i=t("#wsf-status-"+e+"-label");a?(i.attr("title",t.WS_Form.this.language("publish")),t.WS_Form.this.api_call("form/"+e+"/publish/","POST",!1,function(e){t.WS_Form.this.loader_off()})):(i.attr("title",t.WS_Form.this.language("draft")),t.WS_Form.this.api_call("form/"+e+"/draft/","POST",!1,function(e){t.WS_Form.this.loader_off()}))}),t('[data-action="wsf-clone"], [data-action="wsf-delete"], [data-action="wsf-export"]',a).on("click",function(t){t.preventDefault()}),t('[data-action-ajax="wsf-form-locate"]',a).on("click",function(e){e.preventDefault();var a=t(this);a.trigger("blur");var i=t(this).attr("data-id");t.WS_Form.this.loader_on(),t.WS_Form.this.api_call("form/"+i+"/locations/","GET",!1,function(e){t.WS_Form.this.loader_off();var s=[];if(void 0!==e[i])for(var o in e[i])if(e[i].hasOwnProperty(o)){var r=e[i][o],n=(o=r.id,r.type),d=r.type_name,_=r.title;switch(r.type){case"widget":s.push(t.WS_Form.this.esc_html(d)+': <a href="widgets.php">'+t.WS_Form.this.esc_html(_)+"</a>");break;default:s.push(t.WS_Form.this.esc_html(d)+': <a href="post.php?post='+o+"&post_type="+n+'&action=edit">'+t.WS_Form.this.esc_html(_)+"</a>")}}if(0==s.length)var l='<div class="wsf-helper">'+t.WS_Form.this.language("form_location_not_found")+"</div>";else l='<div class="wsf-helper">'+t.WS_Form.this.language("form_location_found",'<span class="ws-form-location">'+s.join(', </span><span class="wsf-form-location">'),!1)+"</div>";var c=a.closest(".row-actions"),f=a.closest("td"),h=t(".wsf-form-locations",f);h.length?h.html(l):c.before('<div class="wsf-form-locations">'+l+"</div>")})}),this.clipboard(a,"shortcode_copied","table")},t.WS_Form.prototype.wp_list_table_style=function(){this.style_id=0;var e=t("#wsf-style-list-table");t('[data-action="wsf-clone"], [data-action="wsf-delete"], [data-action="wsf-export"], [data-action="wsf-restore"]',e).on("click",function(){t("#wsf-action").val(t(this).attr("data-action")),t("#wsf-id").val(t(this).attr("data-id")),t("#wsf-action-do").trigger("submit")}),t('[data-action="wsf-default"]',e).on("click",function(){confirm(t.WS_Form.this.language("styler_default_confirm"))&&(t("#wsf-action").val(t(this).attr("data-action")),t("#wsf-id").val(t(this).attr("data-id")),t("#wsf-action-do").trigger("submit"))}),t('[data-action="wsf-default-conv"]',e).on("click",function(){confirm(t.WS_Form.this.language("styler_default_conv_confirm"))&&(t("#wsf-action").val(t(this).attr("data-action")),t("#wsf-id").val(t(this).attr("data-id")),t("#wsf-action-do").trigger("submit"))}),t('[data-action="wsf-reset"]',e).on("click",function(){confirm(t.WS_Form.this.language("styler_reset_confirm"))&&(t("#wsf-action").val(t(this).attr("data-action")),t("#wsf-id").val(t(this).attr("data-id")),t("#wsf-action-do").trigger("submit"))}),t("table.wp-list-table",e).wrap('<div id="wsf-style-table"></div>');var a=t("#wsf-style-table");a.append('<div class="wsf-object-upload-json-window"><div class="wsf-object-upload-json-window-content"><h1></h1><div class="wsf-uploads"></div></div></div>'),a.on("dragenter",function(e){e.stopPropagation(),e.preventDefault(),t.WS_Form.this.drag_is_file(e)&&t(".wsf-object-upload-json-window",t(this)).show()}),t(".wsf-object-upload-json-window",a).on("dragover",function(t){t.stopPropagation(),t.preventDefault()}),t(".wsf-object-upload-json-window",a).on("drop",function(e){e.preventDefault();var i=e.originalEvent.dataTransfer.files;t.WS_Form.this.object_upload_json(i,t(this),"style",function(){location.reload()},function(){t(".wsf-object-upload-json-window",a).hide()})}),t(".wsf-object-upload-json-window",a).on("dragleave",function(e){t(".wsf-object-upload-json-window",a).hide()}),t('[data-action-button="wsf-style-upload"]').on("click",function(e){t("#wsf-object-upload-file").val("").trigger("click")}),t("#wsf-object-upload-file").on("change",function(){var e=t("#wsf-object-upload-file").prop("files");if(e.length>0){var a=t("> .wsf-object-upload-json-window",t.WS_Form.this.upload_obj);a.show(),t.WS_Form.this.object_upload_json(e,a,"style",function(){location.reload()},function(){t("> .wsf-object-upload-json-window",t.WS_Form.this.upload_obj).hide()})}}),t('[data-action-ajax="wsf-style-status"]',a).on("click",function(){var e=t(this).attr("data-id"),a=t(this).is(":checked");t.WS_Form.this.loader_on();var i=t("#wsf-status-"+e+"-label");a?(i.attr("title",t.WS_Form.this.language("publish")),t.WS_Form.this.api_call("style/"+e+"/publish/","POST",!1,function(e){t.WS_Form.this.loader_off()})):(i.attr("title",t.WS_Form.this.language("draft")),t.WS_Form.this.api_call("style/"+e+"/draft/","POST",!1,function(e){t.WS_Form.this.loader_off()}))}),t('[data-action="wsf-clone"], [data-action="wsf-delete"], [data-action="wsf-export"], [data-action="wsf-default"], [data-action="wsf-default-conv"], [data-action="wsf-reset"], [data-action="wsf-restore"]',a).on("click",function(t){t.preventDefault()}),t('[data-action-ajax="wsf-style-locate"]',a).on("click",function(e){e.preventDefault();var a=t(this);a.trigger("blur");var i=t(this).attr("data-id");t.WS_Form.this.loader_on(),t.WS_Form.this.api_call("style/"+i+"/locations/","GET",!1,function(e){t.WS_Form.this.loader_off();var s=[];if(void 0!==e[i])for(var o in e[i])if(e[i].hasOwnProperty(o)){var r=e[i][o],n=(o=r.id,r.type),d=r.type_name,_=r.title;s.push(t.WS_Form.this.esc_html(d)+': <a href="post.php?post='+o+"&post_type="+n+'&action=edit">'+t.WS_Form.this.esc_html(_)+"</a>")}if(0==s.length)var l='<div class="wsf-helper">'+t.WS_Form.this.language("style_location_not_found")+"</div>";else l='<div class="wsf-helper">'+t.WS_Form.this.language("style_location_found",'<span class="ws-style-location">'+s.join(', </span><span class="wsf-style-location">'),!1)+"</div>";var c=a.closest(".row-actions"),f=a.closest("td"),h=t(".wsf-style-locations",f);h.length?h.html(l):c.before('<div class="wsf-style-locations">'+l+"</div>")})})},t.WS_Form.prototype.clipboard=function(e,a,i){t('[data-action="wsf-clipboard"]',e).on("click",function(e){var s;if((e.preventDefault(),void 0===(s=t(this).attr("data-copy-text")))&&void 0===(s=t(this).html()))return;var o=t("<input>");if(t("body").append(o),o.val(s).trigger("select"),document.execCommand("copy"),o.remove(),void 0!==a)switch(i){case"table":var r=t(this).closest("td");r&&r.length&&(r.append('<div class="wsf-helper">'+t.WS_Form.this.language(a)+"</div>"),setTimeout(function(){t(".wsf-helper",r).remove()},2e3))}})},t.WS_Form.prototype.wp_list_table_submit=function(e){var a=t("#wsf-submissions");t("#id-hide").parent().remove(),t("#wsf_filter_id",a).on("change",function(){t.WS_Form.this.wp_list_table_filter_do()}),t("#doaction",a).on("click",function(e){switch(t("#bulk-action-selector-top",a).val()){case"wsf-bulk-export":e.preventDefault();var i=[];t('input:checkbox[name="bulk-ids[]"]:checked').each(function(){i.push(t(this).val())}),i.length&&t.WS_Form.this.submit_export(i)}}),this.form_id=e,0!=this.form_id&&(t(document).on("click","#screen-options-wrap .hide-column-tog",function(){var e={hidden:columns.hidden()};t.WS_Form.this.api_call("helper/user_meta_hidden_column/","POST",e,null,null,!1,!0,!0)}),t('[data-action-ajax="wsf-submit-starred"]',a).on("click",function(e){e.preventDefault();var a=t(this).attr("data-id"),i=t(this).hasClass("wsf-starred-on");t(this);t.WS_Form.this.loader_on(),i?(t(this).removeClass("wsf-starred-on"),t.WS_Form.this.api_call("submit/"+a+"/starred/off/","POST",!1,function(e){t.WS_Form.this.loader_off()})):(t(this).addClass("wsf-starred-on"),t.WS_Form.this.api_call("submit/"+a+"/starred/on/","POST",!1,function(e){t.WS_Form.this.loader_off()}))}),t('[data-action-ajax="wsf-submit-viewed"]',a).on("click",function(e){e.preventDefault();var a=t(this).attr("data-id"),i=!t(this).closest("tr").hasClass("wsf-submit-not-viewed"),s=t(this);t.WS_Form.this.loader_on(),i?(s.closest("tr").addClass("wsf-submit-not-viewed"),s.html(t.WS_Form.this.language("viewed_off")),t.WS_Form.this.api_call("submit/"+a+"/viewed/off/","POST",!1,function(e){"function"==typeof window.wsf_admin_wp_count_submit_unread_ajax&&window.wsf_admin_wp_count_submit_unread_ajax(t.WS_Form.this.form_id),t.WS_Form.this.loader_off()})):(s.closest("tr").removeClass("wsf-submit-not-viewed"),s.html(t.WS_Form.this.language("viewed_on")),t.WS_Form.this.api_call("submit/"+a+"/viewed/on/","POST",!1,function(e){"function"==typeof window.wsf_admin_wp_count_submit_unread_ajax&&window.wsf_admin_wp_count_submit_unread_ajax(t.WS_Form.this.form_id),t.WS_Form.this.loader_off()}))}),t('[data-action="wsf-delete"], [data-action="wsf-export"]',a).on("click",function(t){t.preventDefault()}),this.tooltips(),this.get_configuration(function(){t.WS_Form.this.get_form(function(){t.WS_Form.this.wp_list_table_submit_init(),t.WS_Form.this.keydown_events_init(),t.WS_Form.this.loader_off()})}))},t.WS_Form.prototype.wp_list_table_submit_init=function(){if(t("#wpcontent").addClass("wsf-sidebar-closed"),this.set_globals("ws-form","public"),this.data_cache_build(),this.field_type_cache_build(),window.location.hash){var e=Number(window.location.hash.substring(1));isNaN(e)||t.WS_Form.this.submit_action("wsf-view",e)}t('[data-action]:not([data-action="wsf-clipboard"])').on("click",function(){var e=t(this).attr("data-id"),a=t(this).attr("data-action");switch(a){case"wsf-view":case"wsf-edit":t.WS_Form.this.submit_action(a,e);break;case"wsf-export-all":t.WS_Form.this.submit_export();break;case"wsf-export":var i=t(this).attr("data-id");t.WS_Form.this.submit_export([i]);break;default:t("#ws-form-action").val(a),t("#ws-form-submit-id").val(e),t("#ws-form-action-do").trigger("submit")}}),t("#wsf_filter_do").on("click",function(e){t.WS_Form.this.wp_list_table_filter_do()}),t("#wsf_filter_reset").on("click",function(e){t("#wsf_filter_date_from").val(""),t("#wsf_filter_date_to").val(""),t("#wsf_filter_keyword").val(""),t.WS_Form.this.wp_list_table_filter_do()}),t("#wsf_filter_date_from,#wsf_filter_date_to").datepicker()},t.WS_Form.prototype.submit_export=function(e){t.WS_Form.this.submit_export_popup_show();var a={id:this.form_id};void 0!==e?a.submit_ids=e:(a.date_from=t("#wsf_filter_date_from").val(),a.date_to=t("#wsf_filter_date_to").val(),a.keyword=t("#wsf_filter_keyword").val()),a[ws_form_settings.wsf_nonce_field_name]=ws_form_settings.wsf_nonce,this.submit_export_do(a)},t.WS_Form.prototype.submit_export_do=function(e,a,i,s){void 0===a&&(a=0),e.page=a,void 0!==i&&(e.hash=i);var o=ws_form_settings.url_ajax+"submit/export/";t.ajax({url:o,type:"POST",data:e,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",ws_form_settings.x_wp_nonce)},success:function(i){if(i.error)return t.WS_Form.this.submit_export_popup_hide(),void t.WS_Form.this.error("error_submit_export",i.error_message);if(void 0!==i.complete){var o=i.complete,r=i.hash,n=t("#wsf-submit-export-popup");if(o)t(".wsf-popup-progress-bar progress",n).val(100),setTimeout(function(){t.WS_Form.this.submit_export_popup_hide()},1e3),location.href=i.url;else{!1!==i.records_total&&(s=i.records_total);var d=Math.round(100*(s?i.records_processed/s:0),0);t(".wsf-popup-progress-inner p",n).hide(),t(".wsf-popup-progress-bar",n).show(),t(".wsf-popup-progress-bar progress",n).val(d),t.WS_Form.this.submit_export_do(e,a+1,r,s)}}else t.WS_Form.this.submit_export_popup_hide()},error:function(e){t.WS_Form.this.submit_export_popup_hide(),t.WS_Form.this.api_call_error_handler(e,o)}})},t.WS_Form.prototype.submit_export_popup_show=function(){var e=t("#wsf-submit-export-popup");t(".wsf-popup-progress-inner p",e).show(),t(".wsf-popup-progress-bar",e).hide(),e.show()},t.WS_Form.prototype.submit_export_popup_hide=function(){t("#wsf-submit-export-popup").hide()},t.WS_Form.prototype.wp_list_table_filter_do=function(){t('#wsf-submissions form [name="_wp_http_referer"]').remove(),t('#wsf-submissions form [name="_wpnonce"]').remove(),t('#wsf-submissions form [name="action"]').attr("disabled","disabled"),t('#wsf-submissions form [name="action2"]').attr("disabled","disabled"),t("#current-page-selector").val("1"),t("#wsf-submissions form").trigger("submit")},t.WS_Form.prototype.submit_action=function(t,e){switch(t){case"wsf-view":this.submit_render(e,!0);break;case"wsf-edit":this.submit_render(e,!1)}},t.WS_Form.prototype.submit_render=function(e,a){var i=t('[data-action-ajax="wsf-submit-viewed"][data-id="'+this.esc_selector(e)+'"]');i.closest("tr").removeClass("wsf-submit-not-viewed"),i.html(t.WS_Form.this.language("viewed_on"));var s=t("#wsf-sidebar-submit");t("h2 span",s).html(""),this.api_call("submit/"+e,"GET",!1,function(e){if(void 0!==e.data){var i=e.data;!(void 0!==i.preview&&i.preview)&&t.WS_Form.this.form.published_checksum?t.WS_Form.this.submit_render_do(i,t.WS_Form.this.form,a):!1===t.WS_Form.this.form_draft?t.WS_Form.this.api_call("form/"+t.WS_Form.this.form_id+"/full/","GET",!1,function(e){t.WS_Form.this.form_draft=e.form,t.WS_Form.this.submit_render_do(i,t.WS_Form.this.form_draft,a)},!1,!1,!1,!1,!0):t.WS_Form.this.submit_render_do(i,t.WS_Form.this.form_draft,a),"function"==typeof window.wsf_admin_wp_count_submit_unread_ajax&&window.wsf_admin_wp_count_submit_unread_ajax(t.WS_Form.this.form_id)}})},t.WS_Form.prototype.submit_render_do=function(e,a,i){var s=t.extend(!0,{},e),o=t("#wsf-sidebar-submit");if(void 0!==a&&void 0!==a.groups&&parseInt(e.form_id)===parseInt(this.form_id,10)){var r=this.get_object_value(t.WS_Form.settings_plugin,"submit_edit_ecommerce"),n=a.groups.length>1,d=void 0!==e.meta,_=e.encrypted?'<div class="wsf-encrypted"'+this.tooltip(this.language("submit_encrypted"),"top-center")+">"+this.svg("readonly")+"</div>":"",l=void 0!==e.section_repeatable&&e.section_repeatable,c='<div data-action="wsf-sidebar-expand"'+this.tooltip(this.language("sidebar_expand"),"bottom-right")+">"+this.svg("expand")+"</div>";c+='<div data-action="wsf-sidebar-contract"'+this.tooltip(this.language("sidebar_contract"),"bottom-right")+">"+this.svg("contract")+"</div>";var f='<div class="wsf-sidebar-header"><div class="wsf-sidebar-icon">'+this.svg("table")+"</div><h2>"+this.language("submission")+"</h2>"+_+"<code></code>"+c+"</div>",h='<table id="wsf-sidebar-info">';h+=this.submit_row_render(e,"status_full",this.language("submit_status"),"status"),h+=this.submit_row_render(e,"date_added_wp",this.language("submit_date_added")),h+=this.submit_row_render(e,"date_updated_wp",this.language("submit_date_updated")),h+=this.submit_row_render(e,"user_id",this.language("submit_user"),"user"),h+=this.submit_row_render(e,"duration",this.language("submit_duration"),"duration"),h+="</table>";var p='<form class="wsf-sidebar-inner" id="ws-form-submit" data-id="'+this.esc_attr(e.id)+'">';if(!d)return p;for(var u in a.groups)if(a.groups.hasOwnProperty(u)){var m=a.groups[u];if(void 0!==m.sections&&0!=m.sections.length){var v=!1;for(var g in m.sections)if(m.sections.hasOwnProperty(g)){var b=m.sections[g],w=b.id,y="section_"+w,S=!1!==l&&void 0!==l[y]&&void 0!==l[y].index?l[y].index:[!1];for(var W in b.fields)if(b.fields.hasOwnProperty(W)){var F=b.fields[W];if(void 0!==t.WS_Form.field_type_cache[F.type])void 0!==(z=t.WS_Form.field_type_cache[F.type]).submit_save&&z.submit_save||delete b.fields[W]}if(b.fields=this.array_remove_empty(b.fields),void 0!==b.fields&&0!=b.fields.length){var k="";for(var j in n&&!v&&(k+="<h3>"+this.esc_html(m.label)+"</h3>\n",v=!0),b.meta.label_render&&(k+="<legend>"+this.esc_html(b.label)+"</legend>\n"),S)if(S.hasOwnProperty(j)){var x=S[j],O="";if(!1!==x){if((x=parseInt(x,10))<=0)continue;k+='<fieldset class="wsf-fieldset wsf-fieldset-repeatable" data-repeatable data-repeatable-index="'+this.esc_attr(x)+'" data-id="'+this.esc_attr(w)+'"><legend>#'+(parseInt(j,10)+1)+"</legend>";O="_"+x}for(var W in b.fields)if(b.fields.hasOwnProperty(W)){F=b.fields[W];var C=this.field_name_prefix+F.id+O,P=void 0!==e.meta[C]?e.meta[C].value:"";k+='<div class="wsf-field-wrapper" data-id="'+this.esc_attr(F.id)+'" data-type="'+this.esc_attr(F.type)+'"'+(x?' data-repeatable-index="'+this.esc_attr(x)+'"':"")+">";var z=F.type;if(void 0!==t.WS_Form.field_type_cache[z]){var q=t.WS_Form.field_type_cache[z];t.WS_Form.this.wpautop_parse_variable(F,q)&&i&&(P=t.WS_Form.this.wpautop(P));var T=void 0!==q.submit_edit&&q.submit_edit,I=void 0!==q.submit_edit_ecommerce&&q.submit_edit_ecommerce;r&&I&&(T=!0);var E=void 0!==q.submit_edit_type?q.submit_edit_type:z;E!==F.type&&(F.type=E);var D=i||!T;if(T?void 0===e.meta[C]&&(s.meta[C]={id:F.id,value:"",type:F.type}):delete s.meta[C],D)var A="<div><strong>"+this.esc_html(F.label)+"</strong><br />#field</div>";else A="#field";var M=!1;if(D&&!1===M&&""!=P)switch(E){case"url":M=this.get_url(P)?'<a href="'+this.esc_url(P)+'" target="_blank">'+this.esc_html(P)+"</a>":this.esc_html(P);break;case"tel":var L=this.get_tel(P);M=L?'<a href="'+this.esc_url("tel:"+L)+'">'+this.esc_html(P)+"</a>":this.esc_html(P);break;case"email":M=this.get_email(P)?'<a href="'+this.esc_url("mailto:"+P)+'">'+this.esc_html(P)+"</a>":this.esc_html(P);break;case"textarea":if("string"==typeof P)P=this.replace_all(P,"</p>","\n"),M=this.html_strip(P),this.wpautop_parse_variable(F,q)&&(M=this.wpautop(M))}if("object"==typeof P)for(var N in P)P.hasOwnProperty(N)&&"string"==typeof P[N]&&(P[N]=this.esc_html(P[N]));if("string"==typeof P&&(P=this.esc_html(P)),D){if("object"==typeof P){var R="",J=0;for(var N in P)P.hasOwnProperty(N)&&("string"==typeof P[N]&&(R+=(J>0?"<br />":"")+P[N]),J++);P=R}!1===M&&(M=""==P?"-":P)}else A="#field",M=this.get_field_html_single(F,P,!0,x);var U={field:M};k+=this.mask_parse(A,U),k+="</div>","object"==typeof e.meta[C]&&(e.meta[C].processed=!0),"undefined"!=typeof field_type_old&&(F.type=field_type_old)}}!1!==O&&(k+="</fieldset>")}""!=k&&(p+='<fieldset class="wsf-fieldset">'+k+"</fieldset>")}}}}if(i){var H=this.sidebar_render_actions(e);!1!==H&&(p+=H)}p+="</form>";var X=t("#wsf-submissions .wp-list-table tbody"),G=t('[data-id="'+this.esc_selector(e.id)+'"]',X).first().closest("tr"),K=G.prev(),B=K.length?t('[data-action="wsf-view"]',K).attr("data-id"):void 0,V=G.next(),Y=V.length?t('[data-action="wsf-view"]',V).attr("data-id"):void 0,Z=[{class:"wsf-button-primary",action:"wsf-sidebar-edit",label:this.language("edit")},{action:"wsf-sidebar-print",label:this.language("print")},{action:"wsf-sidebar-close",label:this.language("close")},{action:"wsf-sidebar-view",right:!0,id:B,label:this.language("previous"),disabled:void 0===B},{action:"wsf-sidebar-view",id:Y,label:this.language("next"),disabled:void 0===Y}],Q=[{class:"wsf-button-primary",action:"wsf-sidebar-save",label:this.language("save")},{class:"",action:"wsf-sidebar-cancel",label:this.language("cancel")},{class:"wsf-button-danger",right:!0,action:"wsf-sidebar-delete",label:this.language("trash")}],$=this.sidebar_buttons_html(i?Z:Q);o.html(f),o.append(h),o.append(p),o.append($),t("#wsf-sidebar-submit .wsf-sidebar-header code").html(this.language("id")+": "+e.id);t(".wsf-sidebar-inner",o);i?(t('[data-action="wsf-sidebar-view"]',o).on("click",function(){var e=t(this).attr("data-id");void 0!==e&&t.WS_Form.this.submit_render(e,!0),t.WS_Form.this.popover_reset()}),t('[data-action="wsf-sidebar-edit"]',o).on("click",function(){t.WS_Form.this.submit_render(e.id,!1),t.WS_Form.this.popover_reset()}),t('[data-action="wsf-sidebar-print"]',o).on("click",function(){window.print()}),t('[data-action="wsf-sidebar-close"]',o).on("click",function(){t("#wsf-sidebar-submit").removeClass("wsf-sidebar-open").addClass("wsf-sidebar-closed"),t("#wpcontent").removeClass("wsf-sidebar-open").addClass("wsf-sidebar-closed"),window.matchMedia("(max-width: 600px)").matches&&(t("html").css({overflow:""}),t("body").css({overflow:"","-webkit-overflow-scrolling":""})),t.WS_Form.this.popover_reset()}),t('[data-action="wsf-submit-action-repost"]',o).on("click",function(){var a=t(this),i=t(this).closest("tr"),s=[{label:t.WS_Form.this.language("cancel"),action:"wsf-cancel"},{label:t.WS_Form.this.language("repost"),action:"wsf-confirm",class:"wsf-button-danger"}];t.WS_Form.this.popover(t.WS_Form.this.language("confirm_action_repost"),s,i,function(){a.addClass("wsf-api-method-calling");var i={id:t.WS_Form.this.form_id,action_index:a.attr("data-submit-action-index")};t.WS_Form.this.api_call("submit/"+e.id+"/action/","POST",i,function(e){if(a.removeClass("wsf-api-method-calling"),void 0===e.data)return!1;if(void 0!==e.data.logs&&e.data.logs.length){var i=e.data.logs.join("<br />");t.WS_Form.this.message(i,!0,"notice-success")}if(void 0!==e.data.errors&&e.data.errors.length){var s=e.data.errors.join("<br />");t.WS_Form.this.message(s,!0,"notice-error")}},function(){a.removeClass("wsf-api-method-calling")},!1,!0)}),i.siblings("tr.wsf-ui-cancel").removeClass("wsf-ui-cancel")}),t("[data-toggle]",o).on("click",function(){t(this).attr("data-status","on"==t(this).attr("data-status")?"":"on");var e=t(this).attr("data-toggle");t("#"+e).toggle()})):(t('[data-action="wsf-sidebar-save"]',o).on("click",function(){t.WS_Form.this.submit_button_save(s)}),t('[data-action="wsf-sidebar-delete"]',o).on("click",function(){t("#ws-form-action").val("wsf-delete"),t("#ws-form-submit-id").val(s.id),t("#ws-form-action-do").trigger("submit")}),t('[data-action="wsf-sidebar-cancel"]',o).on("click",function(){t.WS_Form.this.submit_button_cancel(s)}),t.WS_Form.this.keydown[27]={function:function(){t.WS_Form.this.submit_button_cancel(s)},ctrl_key:!1},t.WS_Form.this.keydown[83]={function:function(){t.WS_Form.this.submit_button_save(s)},ctrl_key:!0}),this.loader_off(),t("#wsf-sidebar-submit").removeClass("wsf-sidebar-closed").addClass("wsf-sidebar-open"),t("#wpcontent").removeClass("wsf-sidebar-closed").addClass("wsf-sidebar-open"),window.matchMedia("(max-width: 600px)").matches&&(t("html").css({overflow:"hidden"}),t("body").css({overflow:"auto","-webkit-overflow-scrolling":"touch"})),this.sidebar_expand_contract_init()}else this.loader_off()},t.WS_Form.prototype.submit_button_save=function(e){var a=t("#ws-form-submit"),i=new FormData(a[0]);for(var s in e.meta)if(e.meta.hasOwnProperty(s)&&-1!=s.indexOf(this.field_name_prefix)&&void 0!==e.meta[s].value){var o=e.meta[s].repeatable_index,r=e.meta[s].id,n=this.field_name_prefix+r+(o?"["+o+"]":""),d=null!==i.get(n)?i.get(n):i.getAll(n+"[]")?i.getAll(n+"[]"):"";e.meta[s].value=d,delete e.meta[s].processed}var _={id:this.form_id,submit_id:e.id,submit:e};this.api_call("submit/"+e.id+"/put/","POST",_,function(t){location.reload()})},t.WS_Form.prototype.submit_button_cancel=function(e){t.WS_Form.this.keydown=[],t.WS_Form.this.submit_render(e.id,!0)},t.WS_Form.prototype.sidebar_render_actions=function(e){if(void 0===e.actions)return!1;var a=e.actions;if(!1===a)return!1;if(0==a.length)return!1;var i='<fieldset id="wsf-submit-sctions" class="wsf-fieldset">\n';for(var s in i+="<h3>"+this.language("submit_actions")+"</h3>\n",i+='<div class="wsf-field-wrapper">',i+='<div class="wsf-table-outer">',i+="<table>\n",i+="<thead><tr>",i+='<th width="16" style="text-align: center;">'+this.language("submit_actions_column_index")+"</th>",i+="<th>"+this.language("submit_actions_column_action")+"</th>",i+="<th></th>",i+="<th></th>",i+="<th></th>",i+="<th></th>",i+="</tr></thead>\n<tbody>\n",a)if(a.hasOwnProperty(s)){var o=a[s=parseInt(s,10)],r=o.id,n=o.label,d=(o.meta,!!(void 0!==t.WS_Form.actions[r])&&t.WS_Form.actions[r]),_=void 0!==d.can_repost&&d.can_repost,l=this.sidebar_render_action_meta_html(d,o),c=this.sidebar_render_action_logs_html(o,"logs"),f=this.sidebar_render_action_logs_html(o,"errors");i+="<tr>",i+='<td style="text-align: center;">'+(s+1)+"</td>",i+="<td>"+this.esc_html(n)+"</td>",i+="<td data-icon>",!1!==l&&(i+='<div data-toggle="wsf-action-meta-'+this.esc_attr(s)+'"'+this.tooltip(this.language("submit_actions_meta"),"top-center")+">"+this.svg("edit")+"</div>"),i+="</td><td data-icon>",!1!==c&&(i+='<div data-toggle="wsf-action-logs-'+this.esc_attr(s)+'"'+this.tooltip(this.language("submit_actions_logs"),"top-center")+">"+this.svg("info-circle")+"</div>"),i+="</td><td data-icon>",!1!==f&&(i+='<div data-toggle="wsf-action-errors-'+this.esc_attr(s)+'"'+this.tooltip(this.language("submit_actions_errors"),"top-right")+">"+this.svg("warning")+"</div>"),i+="</td><td data-icon>",_&&(i+='<div data-action="wsf-submit-action-repost" data-submit-action-index="'+this.esc_attr(s)+'"'+this.tooltip(this.language("submit_actions_repost"),"top-right")+">"+this.svg("redo")+"</div>"),i+="</td></tr>\n",!1!==l&&(i+='<tr id="wsf-action-meta-'+this.esc_attr(s)+'" class="wsf-hidden-table-row"><td colspan="6" class="wsf-hidden-table-cell"><div>',i+=l,i+="</div></td></tr>"),!1!==c&&(i+='<tr id="wsf-action-logs-'+this.esc_attr(s)+'" class="wsf-hidden-table-row"><td colspan="6" class="wsf-hidden-table-cell"><div>',i+=c,i+="</div></td></tr>"),!1!==f&&(i+='<tr id="wsf-action-errors-'+this.esc_attr(s)+'" class="wsf-hidden-table-row"><td colspan="6" class="wsf-hidden-table-cell"><div>',i+=f,i+="</div></td></tr>")}return i+="</tbody>\n</table>\n</div>\n</div>",i+="</fieldset>"},t.WS_Form.prototype.sidebar_render_action_meta_html=function(e,a){var i=a.id,s=this.get_action_meta_key_cache(e,i);if(void 0===a.meta)return!1;var o=a.meta;if(0==o.length)return!1;var r="<table>";for(var n in r+="<thead><tr>",r+="<th>"+this.language("submit_actions_column_meta_label")+"</th>",r+="<th>"+this.language("submit_actions_column_meta_value")+"</th>",r+="</tr></thead>\n<tbody>\n",o)if(o.hasOwnProperty(n)){var d=void 0!==s[n]?s[n].label:n,_=o[n];if("object"==typeof _){if(void 0===t.WS_Form.meta_keys[n])continue;var l=t.WS_Form.meta_keys[n];if(void 0===l.type)continue;switch(l.type){case"repeater":var c="<table>";for(var f in _)if(_.hasOwnProperty(f)){var h=_[f];for(var p in c+="<tr>",h)if(h.hasOwnProperty(p)){var u=h[p];c+="<td>"+this.esc_html(u)+"</td>"}c+="</tr>"}_=c+="</table>";break;default:_=JSON.stringify(_)}}else _=this.esc_html(_);r+="<tr><td>"+this.esc_html(d)+"</td><td>"+(""!=_?_:"-")+"</td></tr>"}return r+="</tbody>\n</table>"},t.WS_Form.prototype.sidebar_render_action_logs_html=function(t,e){if(void 0===t[e])return!1;var a=t[e];if(0==a.length)return!1;var i="<table>";for(var s in i+="<thead><tr>",i+="<th>"+this.language("submit_actions_column_"+e)+"</th>",i+="</tr></thead>\n<tbody>\n",a)if(a.hasOwnProperty(s)){var o=a[s];i+="<tr><td>"+this.esc_html(o)+"</td></tr>"}return i+="</tbody>\n</table>"},t.WS_Form.prototype.get_action_meta_key_cache=function(e,a){var i=[];if(void 0===e.fieldsets)return[];if(void 0===e.fieldsets[a])return[];if(void 0===e.fieldsets[a].meta_keys)return[];for(var s in e.fieldsets[a].meta_keys)if(e.fieldsets[a].meta_keys.hasOwnProperty(s)){var o=e.fieldsets[a].meta_keys[s];if(void 0!==t.WS_Form.meta_keys[o])void 0!==t.WS_Form.meta_keys[o].label&&(i[o]={label:t.WS_Form.meta_keys[o].label})}return i},t.WS_Form.prototype.submit_row_render=function(t,e,a,i){if(void 0!==t[e]){void 0===i&&(i="default");var s=void 0!==t.preview&&t.preview,o='<tr><th width="80">'+a+"</th><td>";switch(i){case"status":o+=t[e]+(s?" ("+this.language("submit_preview")+")":"");break;case"duration":if(0===parseInt(t[e],10))return"";o+=this.get_nice_duration(t[e]);break;case"user":var r=parseInt(t[e]);if(0===r||void 0===t.user)o+="-";else{var n=t.user.display_name;o+='<a href="user-edit.php?user_id='+r+'">'+this.esc_html(n)+"</a>"}break;default:o+=t[e]}return o+="</td></tr>"}},t.WS_Form.prototype.key_generate=function(t){void 0===t&&(t=64);for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+-=[]\\{}|;':\",./<>?",a="",i=0;i<64;i++){var s=Math.round(Math.random()*e.length);s<0&&(s=0),s>e.length-1&&(s=e.length-1),a+=e[s]}return a},t.WS_Form.prototype.api_call=function(t,e,a,i,s,o,r,n,d){this.api_call_queue.push({ajax_path:t,method:e,params:a,success_callback:i,error_callback:s,checksum_request:o,bypass_loader:r,bypass_form_processing:n,form_parse:d}),this.api_call_queue_running||this.api_call_process_next()},t.WS_Form.prototype.api_call_process_next=function(){if(0==this.api_call_queue.length)return this.api_call_queue_running=!1,!1;this.api_call_queue_running=!0;var t=this.api_call_queue.shift();this.api_call_process(t.ajax_path,t.method,t.params,t.success_callback,t.error_callback,t.checksum_request,t.bypass_loader,t.bypass_form_processing,t.form_parse)},t.WS_Form.prototype.api_call_process=function(e,a,i,s,o,r,n,d,_){void 0===a&&(a="POST"),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===d&&(d=!1),void 0===_&&(_=!1),r||n||this.loader_on();var l={};this.form_id>0?(!1!==i&&(l.data=JSON.stringify(i),l.data=this.mod_security_fix(l.data)),l.id=this.form_id,l.wsf_fti=this.get_object_meta_value(this.form,"tab_index",0)):!1!==i&&(l=i),l.wsf_fia=!0,_&&(l.wsf_fp=!0),l[ws_form_settings.wsf_nonce_field_name]=ws_form_settings.wsf_nonce;var c=ws_form_settings.url_ajax+e,f={method:a,url:c,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",ws_form_settings.x_wp_nonce)},success:function(e){r||(t.WS_Form.checksum=!1),d||void 0===e.form||t.WS_Form.this.api_call_process_checksum(e),0==t.WS_Form.this.api_call_queue.length&&(void 0!==e.form_full&&e.form_full&&(t.WS_Form.this.form=e.form),t.WS_Form.this.data_cache_build()),"function"==typeof s?s(e):t.WS_Form.this.loader_off(),d||void 0===e.history||t.WS_Form.this.history_push(e),t.WS_Form.this.api_call_process_next()},error:function(e){t.WS_Form.this.loader_off(),t.WS_Form.this.api_call_error_handler(e,c,o),t.WS_Form.this.api_call_process_next()}};return!1!==l&&(f.data=l),t.ajax(f),this},t.WS_Form.prototype.api_call_process_checksum=function(t){void 0!==t.form.checksum&&void 0!==t.form.published_checksum&&(this.published_checksum=t.form.published_checksum,this.publish_render(t.form.checksum))},t.WS_Form.prototype.api_call_error_handler=function(t,e,a){var i=void 0!==t.responseJSON&&t.responseJSON,s=t.status;i&&void 0!==i&&void 0!==i.code&&"rest_cookie_invalid_nonce"===i.code&&location.reload(),i&&i.error&&i.error_message?this.error("error_api_call_"+s+"_message",i.error_message):this.error("error_api_call_"+s,e),"function"==typeof a&&a(i)},t.WS_Form.prototype.publish_render=function(e){if(""==e)return!1;e!=this.published_checksum?t('[data-action="wsf-publish"]').prop("disabled",!1):t('[data-action="wsf-publish"]').prop("disabled",!0)},t.WS_Form.prototype.log=function(t){},t.WS_Form.prototype.error=function(t,e){void 0===e&&(e="");var a=this.language(t,e,!1,!0).replace(/%s/g,e);this.message(a,!0,"notice-error")},t.WS_Form.prototype.message=function(e,a,i,s){void 0===a&&(a=!0),void 0===i&&(i="notice-success"),void 0===s&&(s=!0);var o='<div class="notice '+i+'"><p>'+e+"</p>"+(a?'<button type="button" class="notice-dismiss"><span class="screen-reader-text">'+this.language("dismiss",!1,!0,!0)+"</span></button>":"")+"</div>";if(o.replace("\n","<br />\n"),!s)return o;var r=t(o).insertAfter(t(".wp-header-end"));a&&t("button",r).on("click",function(){t(this).closest("div").remove()})},window.sidebar_form_open=function(e,a,i){t("#wsf-sidebar-form");e.object_edit(t("#wsf-form"))},window.sidebar_form_toggle=function(e,a,i){t("#wsf-form").removeClass("wsf-editing"),e.sidebar_reset()},window.sidebar_form_close=function(e,a,i){t(".wsf-form").removeClass("wsf-editing")},window.sidebar_action_open=function(e,a,i){var s=t("#wsf-sidebar-action"),o=t.WS_Form.settings_form.sidebars.action;if(void 0!==o.kb_url)var r=e.get_plugin_website_url(o.kb_url,"sidebar"),n='<a class="wsf-kb-url" href="'+e.esc_url(r)+'" target="_blank"'+e.tooltip(e.language("field_kb_url"),"bottom-right")+' tabindex="-1">'+e.svg("question-circle")+"</a>";s.html(e.sidebar_title(e.svg(o.icon),o.label,"",n,"",!0)),s.append('<div class="wsf-sidebar-inner"><fieldset class="wsf-fieldset"><div class="wsf-data-grid" data-object="form" data-id="'+e.esc_attr(e.form_id)+'" data-meta-key="action"></div></fieldset></div>'),s.append('<div class="wsf-sidebar-upgrade">'+e.language("action_upgrade","",!1)+"</div>"),s.append(e.sidebar_buttons_html());var d=e.get_object_data("form",e.form_id);e.object_data_scratch=t.extend(!0,{},d),e.sidebar_data_grids_init(t("#wsf-sidebar-action")),t('[data-action="wsf-sidebar-save"]',s).on("click",function(){e.sidebar_action_save(!1)}),t('[data-action="wsf-sidebar-save-close"]',s).on("click",function(){e.sidebar_action_save(!0)}),t('[data-action="wsf-sidebar-cancel"]',s).on("click",function(){e.sidebar_reset()}),t.WS_Form.this.keydown[27]={function:function(){e.sidebar_reset()},ctrl_key:!1},t.WS_Form.this.keydown[83]={function:function(){e.sidebar_action_save(!0)},ctrl_key:!0},e.sidebar_expand_contract_init(),e.sidebar_open("action")},t.WS_Form.prototype.sidebar_action_save=function(e){this.action_save(),this.form.meta.action=this.object_data_scratch.meta.action;var a={form_id:this.form_id,form:this.object_data_scratch};t.WS_Form.this.keydown=[],t.WS_Form.this.saving_notification(),this.api_call("form/"+this.form_id+"/put/","POST",a,function(e){t.WS_Form.this.loader_off()}),e&&this.sidebar_reset()},t.WS_Form.prototype.score=function(t,e,a){if(t===e)return 1;if(""===e)return 0;var i,s,o,r,n,d=0,_=t,l=_.toLowerCase(),c=_.length,f=e.toLowerCase(),h=e.length,p=0,u=1;if(a&&(r=1-a),a)for(n=0;n<h;n+=1)-1===(o=l.indexOf(f[n],p))?u+=r:(p===o?i=.7:(i=.1," "===_[o-1]&&(i+=.8)),_[o]===e[n]&&(i+=.1),d+=i,p=o+1);else for(n=0;n<h;n+=1){if(-1===(o=l.indexOf(f[n],p)))return 0;p===o?i=.7:(i=.1," "===_[o-1]&&(i+=.8)),_[o]===e[n]&&(i+=.1),d+=i,p=o+1}return s=.5*(d/c+d/h)/u,f[0]===l[0]&&s<.85&&(s+=.15),s},t.WS_Form.prototype.get_file_size=function(t){return t>=1048576?t=Math.round(t/1048576,2)+" MB":t>=1024?t=Math.round(t/1024,2)+" KB":t>1?t+=" bytes":1==t?t+=" byte":t="0 bytes",t},t.WS_Form.prototype.get_url=function(t){return/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3})|localhost)(:\d{1,5})?(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(#[a-z\d_-]*)?$/i.test(t)?t:""},t.WS_Form.prototype.get_tel=function(t){return t.replace(/[^+\d]+/g,"")},t.WS_Form.prototype.get_email=function(t){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)?t:""},t.WS_Form.prototype.input_insert_text=function(e,a){switch(e.attr("data-meta-key-type")){case"text_editor":tinymce.activeEditor.execCommand("mceInsertContent",!1,a);break;case"html_editor":var i=t(".CodeMirror")[0].CodeMirror,s=i.getDoc(),o=s.getCursor();s.replaceRange(a,o);var r=i.getValue(),n=i.getTextArea();t(n).val(r).trigger("keyup");break;default:var d=e[0].selectionStart,_=e[0].selectionEnd,l=e.val();e.val(l.substring(0,d)+a+l.substring(_)),e.trigger("focus").trigger("change");var c=d+a.length;null!==e.prop("selectionStart")&&e.prop("selectionStart",c),null!==e.prop("selectionEnd")&&e.prop("selectionEnd",c)}},t.WS_Form.prototype.input_insert_function=function(e,a,i,s){void 0===i&&(i=!1);var o=e.val(),r=""==o,n=e.attr("data-meta-key-type");if(!i||r){if(-1===(w=a.indexOf("(")))d=0,s=!1;else{y=a.substring(w);var d=(b=w+this.get_bracket_finish_index(y))-w-1}switch(n){case"text_editor":if(tinymce.activeEditor.execCommand("mceInsertContent",!1,a),r){var _=tinymce.activeEditor.selection.getNode();tinymce.activeEditor.selection.setCursorLocation(_.firstChild,a.length-1)}break;case"html_editor":var l=t(".CodeMirror")[0].CodeMirror,c=l.getDoc(),f=c.getCursor();c.replaceRange(a,f);var h=l.getValue(),p=l.getTextArea();t(p).val(h).trigger("keyup"),(f=c.getCursor()).ch--,l.focus(),c.setCursor(f);break;default:var u=e[0].selectionStart,m=e[0].selectionEnd,v=e.val();e.val(v.substring(0,u)+a+v.substring(m)),e.trigger("focus").trigger("change");S=u+a.length-(s?1:0);null!==e.prop("selectionStart")&&e.prop("selectionStart",S-(s?d:0)),null!==e.prop("selectionEnd")&&e.prop("selectionEnd",S)}}else{var g=o.indexOf(a.slice(0,-1));if(-1!==g){var b,w=g+a.length-2,y=o.substring(w);if(-1!==(b=this.get_bracket_finish_index(y))){var S=w+b;switch(n){case"text_editor":case"html_editor":break;default:e.focus(),null!==e.prop("selectionStart")&&e.prop("selectionStart",S),null!==e.prop("selectionEnd")&&e.prop("selectionEnd",S)}}}}},t.WS_Form.prototype.input_delete=function(e){switch(e.attr("data-meta-key-type")){case"text_editor":var a=tinymce.activeEditor.selection.getRng();if(0==a.endOffset)break;var i=a.commonAncestorContainer,s=document.createRange();s.selectNodeContents(i),s.setStart(i,a.endOffset-1),s.setEnd(i,a.endOffset),s.deleteContents(),tinymce.activeEditor.focus();break;case"html_editor":var o=t(".CodeMirror")[0].CodeMirror,r=o.getDoc(),n=t.extend(!0,{},r.getCursor()),d=t.extend(!0,{},r.getCursor());n.ch=n.ch-1,d.ch=d.ch,r.replaceRange("",n,d),o.focus(),r.setCursor(n);break;default:var _=e[0].selectionStart,l=e.val();e.val(l.substring(0,_-1)+l.substring(_-0)),e.focus();var c=_-1;null!==e.prop("selectionStart")&&e.prop("selectionStart",c),null!==e.prop("selectionEnd")&&e.prop("selectionEnd",c)}},t.WS_Form.prototype.input_clear=function(e){switch(e.attr("data-meta-key-type")){case"text_editor":tinymce.activeEditor.setContent(""),tinymce.activeEditor.focus();break;case"html_editor":var a=t(".CodeMirror")[0].CodeMirror;a.setValue(""),a.focus();a.getValue();var i=a.getTextArea();t(i).val("").trigger("keyup");break;default:e.val(""),e.focus()}},t.WS_Form.prototype.menu_highlight=function(e){void 0===e&&(e="ws-form"),t("#toplevel_page_"+e).removeClass("wp-not-current-submenu").addClass("wp-has-current-submenu current").addClass("selected"),t('[href="admin.php?page='+e+'"]',t("#toplevel_page_"+e)).closest("li").addClass("wp-menu-open current")},t.WS_Form.prototype.get_plugin_website_url=function(t,e){return void 0===t&&(t=""),"https://wsform.com"+t+"?utm_source=ws_form"+(void 0===e?"":"&utm_medium="+e)},t.WS_Form.prototype.mod_security_fix=function(t){var e=this.replace_all(t,"#","~WSF%23~");return e=this.replace_all(e,"<","~WSF%60~"),e=this.replace_all(e,">","~WSF%62~"),e=this.replace_all(e,"SELECT","~WSFTCELES~"),e=this.replace_all(e,"select","~WSFtceles~"),e=this.replace_all(e,"Select","~WSFtceleS~"),e=this.replace_all(e,"style","~WSFelyts~"),e=this.replace_all(e,"STYLE","~WSFELYTS~"),e=this.replace_all(e,"src","~WSFcrs~"),e=this.replace_all(e,"SRC","~WSFCRS~"),e=this.replace_all(e,"xmlns","~WSFsnlmx~"),e=this.replace_all(e,"XMLNS","~WSFSNLMX~"),e=this.replace_all(e,"object_id","~WSFid_tcejbo~")},t.WS_Form.prototype.drag_is_file=function(t){return void 0===t.originalEvent||void 0===t.originalEvent.dataTransfer||void 0===t.originalEvent.dataTransfer.types||t.originalEvent.dataTransfer.types.includes("Files")},t.WS_Form.prototype.tooltip=function(e,a){return void 0===a&&(a="bottom-center"),t.WS_Form.settings_plugin.helper_icon_tooltip?' data-wsf-tooltip="'+this.esc_attr(a)+'" title="'+this.esc_attr(e)+'"':' title="'+this.esc_attr(e)+'"'},t.WS_Form.prototype.tooltips=function(){t("#wpbody").on("mouseenter","[data-wsf-tooltip]",function(){t(this).attr("data-wsf-tooltip-title",t(this).attr("title")).removeAttr("title")}),t("#wpbody").on("mouseleave","[data-wsf-tooltip-title]",function(){t(this).attr("title",t(this).attr("data-wsf-tooltip-title")).removeAttr("data-wsf-tooltip-title")})},t.WS_Form.prototype.variable_helper_modal=function(){var e=t("#wsf-variable-helper-modal");t("#wpbody").append(e.detach());var a="",i="",s=!1;for(var o in a+='<li data-wsf-vh-group-id="hash-field" class="wsf-vh-tab wsf-vh-tab-active">#field</li>',i+='<div id="wsf-vh-group-hash-field" class="wsf-vh-group wsf-vh-group-active"></div>',t.WS_Form.parse_variable_help)if(t.WS_Form.parse_variable_help.hasOwnProperty(o)){var r=t.WS_Form.parse_variable_help[o];r.group_id!=s&&(a+='<li data-wsf-vh-group-id="'+r.group_id+'" class="wsf-vh-tab">'+this.esc_html(r.group_label)+"</li>",!1!==s&&(i+="</div></div>"),s=r.group_id,i+='<div id="wsf-vh-group-'+this.esc_attr(r.group_id)+'" class="wsf-vh-group">',i+="<h3>"+this.esc_html(r.group_label)+'</h3><div class="wsf-vh-group-inner">'),i+=this.variable_helper_modal_var_html(r)}i+="</div></div>",t("#wsf-variable-helper-variables").append('<ul id="wsf-variable-helper-tabs">'+a+'</ul><div id="wsf-variable-helper-tab-content">'+i+"</div>"),t(".wsf-vh-tab",e).on("click",function(e){e.preventDefault(),t.WS_Form.this.variable_helper_modal_tab_show(t(this).attr("data-wsf-vh-group-id"))}),t('[data-action="wsf-close"]',e).on("click",function(){t.WS_Form.this.variable_helper_modal_close()}),t(window).on("resize",function(){t.WS_Form.this.variable_helper_modal_size()}),this.variable_helper_modal_draggable(),t("#wsf-sidebars").on("focus",'input[type="text"],textarea',function(){t.WS_Form.this.variable_helper_modal_insert_obj=t(this)})},t.WS_Form.prototype.variable_helper_modal_open=function(e){this.variable_helper_modal_insert_obj=e||!1,this.variable_helper_modal_field_group(),t("#wsf-variable-helper-modal").show(),this.variable_helper_modal_center(),this.variable_helper_modal_size(),this.variable_helper_modal_search(),this.variable_helper_modal_insert(),this.variable_helper_modal_copy(),t("#wsf-variable-helper-search-input").focus()},t.WS_Form.prototype.variable_helper_modal_close=function(){t("#wsf-variable-helper-modal").hide()},t.WS_Form.prototype.variable_helper_modal_insert=function(){var e=t("#wsf-variable-helper-modal");t(".wsf-vh-var-code code",e).off().on("click",function(e){e.preventDefault(),t.WS_Form.this.variable_helper_modal_insert_obj&&t.WS_Form.this.input_insert_text(t.WS_Form.this.variable_helper_modal_insert_obj,t(this).html())})},t.WS_Form.prototype.variable_helper_modal_copy=function(){var e=t("#wsf-variable-helper-modal");t(".wsf-vh-var-copy",e).off().on("click",function(e){e.preventDefault();var a=t("code",t(this).closest(".wsf-vh-var-code")).html();if(void 0!==a){var i=t("<input>");t("body").append(i),i.val(a).trigger("select"),document.execCommand("copy"),i.remove()}})},t.WS_Form.prototype.variable_helper_modal_center=function(){var e=t("#wsf-variable-helper-modal"),a=e.outerWidth(),i=e.outerHeight(),s=t(window).width(),o=t(window).height()/2-i/2,r=s/2-a/2;e.css("top",o+"px"),e.css("left",r+"px")},t.WS_Form.prototype.variable_helper_modal_draggable=function(){var e=t("#wsf-variable-helper-modal"),a=t("#wsf-variable-helper-header");a.on("mousedown",function(i){(i=i||window.event).preventDefault();var s=e.offset(),o=s.top,r=s.left,n=i.clientX,d=i.clientY,_=t(window).width(),l=t(window).height(),c=a.outerHeight(),f=e.outerWidth();t(document).on("mouseup",function(){t(document).off("mouseup").off("mousemove")}),t(document).on("mousemove",function(t){(t=t||window.event).preventDefault();var a=t.clientX-n,i=t.clientY-d,s=o+i,h=r+a,p=l-c,u=_-f;s<0&&(s=0),s>p&&(s=p),h<0&&(h=0),h>u&&(h=u),e.css("top",s+"px"),e.css("left",h+"px")})})},t.WS_Form.prototype.variable_helper_modal_tab_show=function(e){var a=t("#wsf-variable-helper-modal");t(".wsf-vh-tab-active",a).removeClass("wsf-vh-tab-active"),t('.wsf-vh-tab[data-wsf-vh-group-id="'+e+'"]').addClass("wsf-vh-tab-active"),t(".wsf-vh-group-active",a).removeClass("wsf-vh-group-active"),t("#wsf-vh-group-"+e).addClass("wsf-vh-group-active")},t.WS_Form.prototype.variable_helper_modal_size=function(){var e=t("#wsf-variable-helper-modal"),a=e.outerHeight()-(t(".wsf-modal-title",e).outerHeight()+10+t("#wsf-variable-helper-search").outerHeight()+10+t("#wsf-variable-helper-tabs").outerHeight()+10+t("h3",t("#wsf-variable-helper-tab-content")).outerHeight())-16;t(".wsf-vh-group-inner",t("#wsf-variable-helper-tab-content")).css("height",a+"px")},t.WS_Form.prototype.variable_helper_modal_search=function(){var e=[];for(var a in t.WS_Form.this.form.groups)if(t.WS_Form.this.form.groups.hasOwnProperty(a)){var i=t.WS_Form.this.form.groups[a];for(var s in i.sections)if(i.sections.hasOwnProperty(s)){var o=i.sections[s];for(var r in o.fields)if(o.fields.hasOwnProperty(r)){var n=o.fields[r],d=t.WS_Form.field_type_cache[n.type];if(d.value_out,d.value_out){var _="#field("+n.id+") #field("+n.id+", "+n.label.toLowerCase(),l="field_"+n.id;e.push({keyword:_,key:l,group_id:"hash-field"})}}}}for(var c in t.WS_Form.parse_variable_help)if(t.WS_Form.parse_variable_help.hasOwnProperty(c)){var f=t.WS_Form.parse_variable_help[c];_=f.value.substring(1).toLowerCase();_+=" #"+_,void 0!==f.keyword&&(_+=" "+f.keyword.toLowerCase()),_+=" "+f.group_label.toLowerCase(),e.push({keyword:_,key:f.key,group_id:f.group_id})}t("#wsf-variable-helper-search-input").off().on("input change paste",function(){var a=t(this).val();if((a=a.toLowerCase().trim()).length<=2&&isNaN(a))return t("#wsf-variable-helper-tabs li.wsf-vh-tab").show(),t("#wsf-variable-helper-tab-content .wsf-vh-var").show().removeAttr("data-hidden"),t("#wsf-variable-helper-tab-content").show(),t("#wsf-variable-helper-search-no-results").hide(),void t.WS_Form.this.variable_helper_modal_size();var i=a.split(" "),s=[],o=0,r=[];for(var n in i)if(i.hasOwnProperty(n)){var d=i[n];d=d.trim(),e.find(function(t){var e=0,a=t.keyword.indexOf(d);if(0===a&&(e+=2),a>0&&(e+=1),e>0){void 0===s[t.key]?s[t.key]=e:s[t.key]+=e;var i=t.group_id;-1===r.indexOf(i)&&r.push(i),o++}})}if(t("#wsf-variable-helper-tabs li.wsf-vh-tab").hide(),t("#wsf-variable-helper-tab-content").show(),t("#wsf-variable-helper-tab-content .wsf-vh-var").hide(),t("#wsf-variable-helper-search-no-results").hide(),o){for(var _ in r)if(r.hasOwnProperty(_)){var l=r[_];t('#wsf-variable-helper-tabs li.wsf-vh-tab[data-wsf-vh-group-id="'+l+'"]').show()}for(var c in s)s.hasOwnProperty(c)&&t('#wsf-variable-helper-tab-content .wsf-vh-var[data-wsf-vh-key="'+t.WS_Form.this.esc_selector(c)+'"]').show();l=t("#wsf-variable-helper-tabs li.wsf-vh-tab:visible").first().attr("data-wsf-vh-group-id");t.WS_Form.this.variable_helper_modal_tab_show(l)}else t("#wsf-variable-helper-tab-content").hide(),t("#wsf-variable-helper-search-no-results").show();t.WS_Form.this.variable_helper_modal_size()})},t.WS_Form.prototype.variable_helper_modal_field_group=function(){t("#wsf-variable-helper-modal");var e=t.WS_Form.this.form.groups.length,a=(this.language("id"),this.language("field")),i="";for(var s in t.WS_Form.this.form.groups)if(t.WS_Form.this.form.groups.hasOwnProperty(s)){var o=t.WS_Form.this.form.groups[s];if(0!==o.sections.length){var r="";for(var n in o.sections)if(o.sections.hasOwnProperty(n)){var d=o.sections[n];if(0!==d.fields.length){var _="";for(var l in d.fields)if(d.fields.hasOwnProperty(l)){var c=d.fields[l],f=t.WS_Form.field_type_cache[c.type];f.value_out,f.value_out&&(_+=this.variable_helper_modal_var_html({key:"field_"+c.id,group_id:"field",group_label:a,preamble:this.language("field")+": <strong>"+this.esc_html(c.label)+"</strong>",value:"#field("+c.id+")",usage:["client","action"]}))}_&&(r+='<div class="wsf-vh-var-section"><h5>'+this.language("section")+": <strong>"+this.esc_html(d.label)+"</strong> ("+d.id+")</h5>"+_+"</div>")}}r&&(e>0&&(i+='<div class="wsf-vh-var-group"><h4>'+this.language("group")+": <strong>"+this.esc_html(o.label)+"</strong> ("+o.id+")</h4>"),i+=r,e>0&&(i+="</div>"))}}i=i?'<h3>#field</h3><div class="wsf-vh-group-inner">'+i+"</div>":"Empty form",t("#wsf-vh-group-hash-field").html(i)},t.WS_Form.prototype.variable_helper_modal_var_html=function(t){var e='<div class="wsf-vh-var" data-wsf-vh-key="'+this.esc_attr(t.key)+'" data-wsf-vh-group-id="'+this.esc_attr(t.group_id)+'">';if(t.kb_slug){var a=this.get_plugin_website_url("/knowledgebase/"+t.kb_slug+"/","variable_helper");e+='<a class="wsf-vh-var-kb-url" href="'+this.esc_url(a)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"left")+' tabindex="-1">'+this.svg("question-circle")+"</a>"}if(t.kb_category_slug){var i=this.get_plugin_website_url("/knowledgebase_category/"+t.kb_category_slug+"/","variable_helper");e+='<a class="wsf-vh-var-kb-url" href="'+this.esc_url(i)+'" target="_blank"'+this.tooltip(this.language("field_kb_url"),"left")+' tabindex="-1">'+this.svg("question-circle")+"</a>"}for(var s in t.usage||(t.usage=["action"]),e+='<ul class="wsf-vh-var-usage">',t.usage)if(t.usage.hasOwnProperty(s)){var o=t.usage[s];e+='<li class="wsf-vh-var-usage-'+this.esc_attr(o)+'">'+this.language("usage_"+o)+"</li>"}return e+="</ul>",t.preamble&&(e+='<p class="wsf-vh-var-preamble">'+t.preamble+"</p>"),e+='<div class="wsf-vh-var-code"><code'+this.tooltip(this.language("variable_insert"),"right")+">"+this.esc_html(t.value)+'</code> <div class="wsf-vh-var-copy"'+this.tooltip(this.language("clipboard"),"right")+">"+this.svg("clone")+"</div></div>",t.description&&(e+='<p class="wsf-vh-var-description">'+t.description+"</p>"),e+="</div>"},t.WS_Form.prototype.input_auto_size=function(e,a){this.input_auto_size_process(e,a),e.on("change input paste",function(){t.WS_Form.this.input_auto_size_process(t(this),a)})},t.WS_Form.prototype.input_auto_size_process=function(e,a){var i=e.val(),s=t("<span"+(void 0!==a?' class="'+this.esc_attr(a)+'"':"")+">"+this.esc_html(i)+"</span>");s.hide().appendTo(document.body);var o=s.width();s.remove(),e.width(o)},t.WS_Form.prototype.field_type_meta_keys=function(e,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1);var s=[],o=e.fieldsets;for(var r in o)if(o.hasOwnProperty(r)){var n=o[r];if(void 0!==n.meta_keys)for(var r in n.meta_keys)if(n.meta_keys.hasOwnProperty(r)){var d=n.meta_keys[r];if(a){if(void 0===t.WS_Form.meta_keys[d])continue;var _=t.WS_Form.meta_keys[d];if(void 0!==_[a]&&_[a]){var l=!0,c=void 0!==_[i]&&_[i];c&&void 0!==t.WS_Form.settings_plugin[c]&&""!==t.WS_Form.settings_plugin[c]&&!1!==t.WS_Form.settings_plugin[c]&&(l=!1),l&&s.push(d)}}else s.push(d)}if(void 0!==n.fieldsets){var f=this.field_type_meta_keys(n,a,i);f.length>0&&(s=s.concat(f))}}return s},t.WS_Form.prototype.set_preview_url_styler=function(){var e=this.get_object_meta_value(this.form,"style_id",0);0==e&&(e=ws_form_settings.style_id_default),t('[data-action="wsf-style"]').attr("href",this.get_preview_url(this.form.id,!1,e,!1,!1))},t.WS_Form.prototype.get_preview_url=function(t,e,a,i,s){void 0===t&&(t=0),void 0===e&&(e="styler"),void 0===i&&(i=!1),void 0===s&&(s=!1);var o=ws_form_settings.url_site,r=[];r.push("wsf_preview"+(i?"_conversational":"")+"_form_id="+parseInt(t,10)),e&&r.push("wsf_preview_template_id="+e),r.push("wsf_preview_styler=true"),s&&r.push("wsf_submit_hash="+s);for(var n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",d="",_=0;_<12;++_)d+=n.charAt(Math.floor(Math.random()*n.length));return r.push("wsf_rand="+d),o+"?"+r.join("&")},window.sidebar_support_open=function(e,a,i){var s=t("#wsf-sidebar-support");t('[data-action="wsf-sidebar-cancel"]',s).on("click",function(){e.sidebar_reset()}),t.WS_Form.this.keydown[27]={function:function(){e.sidebar_reset()},ctrl_key:!1};e.sidebar_inits(["knowledgebase"],s),e.sidebar_open("support")},window.wsf_group_edit=function(t,e,a){t.object_edit(e)},window.wsf_group_clone=function(t,e,a){t.object_cancel(e),t.group_put_clone(e),t.sidebar_reset()},window.wsf_group_delete=function(t,e,a){var i=[{label:t.language("cancel"),action:"wsf-cancel"},{label:t.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}];t.popover(t.language("confirm_group_delete"),i,e,function(){t.object_cancel(e),t.object_delete(e),t.sidebar_reset()})},window.wsf_group_download=function(t,e,a){t.object_download(e)},window.wsf_group_upload=function(t,e,a){t.object_upload(e)},window.wsf_group_template_add=function(t,e,a){t.object_template_add(e)},window.wsf_section_edit=function(t,e,a){t.object_edit(e)},window.wsf_section_clone=function(t,e,a){t.object_cancel(e),t.section_put_clone(e),t.sidebar_reset()},window.wsf_section_delete=function(t,e,a){var i=[{label:t.language("cancel"),action:"wsf-cancel"},{label:t.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}];t.popover(t.language("confirm_section_delete"),i,e,function(){t.object_cancel(e),t.object_delete(e),t.sidebar_reset()})},window.wsf_section_download=function(t,e,a){t.object_download(e)},window.wsf_section_upload=function(t,e,a){t.object_upload(e)},window.wsf_section_template_add=function(t,e,a){t.object_template_add(e)},window.wsf_field_edit=function(t,e,a){t.object_edit(e)},window.wsf_field_clone=function(t,e,a){t.object_save_changes(),t.field_put_clone(e),t.sidebar_reset()},window.wsf_field_delete=function(t,e,a){var i=[{label:t.language("cancel"),action:"wsf-cancel"},{label:t.language("delete"),action:"wsf-confirm",class:"wsf-button-danger"}];t.popover(t.language("confirm_field_delete"),i,e,function(){t.object_cancel(e),t.object_delete(e),t.sidebar_reset()})}}(jQuery);